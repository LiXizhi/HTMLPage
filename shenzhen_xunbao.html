
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鹏城民间艺术小传人：非遗寻宝记</title>
    <script src="https://cdn.keepwork.com/keepwork/cdn/tailwindcss@3.4.16.js"></script>    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        }
        
        .pengzi-chat {
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .game-card {
            transition: all 0.3s ease;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .treasure-box {
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            to { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); }
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .modal {
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 via-purple-50 to-pink-100 min-h-screen">
    
    <!-- 游戏容器 -->
    <div id="gameContainer" class="max-w-4xl mx-auto p-4">
        
        <!-- 开场场景 -->
        <div id="introScene" class="scene">
            <div class="bg-white rounded-xl shadow-xl p-8 text-center">
                <div class="mb-6">
                    <div class="w-32 h-32 mx-auto bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center mb-4">
                        <div class="text-4xl">🦀</div>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-2">鹏城民间艺术小传人</h1>
                    <h2 class="text-xl text-purple-600 mb-4">非遗寻宝记</h2>
                </div>
                
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-6 mb-6">
                    <div class="pengzi-chat inline-block mb-4">
                        <div class="bg-white text-gray-800 rounded-full w-16 h-16 flex items-center justify-center text-2xl mb-2">🦀</div>
                        <p class="text-sm font-medium">鹏仔</p>
                    </div>
                    <div class="bg-white/20 rounded-lg p-4 text-left">
                        <p class="mb-3">你好，未来的文化守护者！</p>
                        <p class="mb-3">我是你的智能助手鹏仔，一只来自深圳湾红树林的招潮蟹。</p>
                        <p>让我们一起乘坐时光机，寻找并传承即将失落的"鹏城七艺"吧！</p>
                    </div>
                </div>
                
                <div class="skyline mb-6">
                    <div class="flex justify-center items-end space-x-2">
                        <div class="w-8 h-16 bg-gray-600 rounded-t"></div>
                        <div class="w-12 h-24 bg-blue-600 rounded-t"></div>
                        <div class="w-10 h-20 bg-purple-600 rounded-t"></div>
                        <div class="w-14 h-28 bg-gray-700 rounded-t"></div>
                        <div class="w-8 h-16 bg-green-600 rounded-t"></div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">深圳天际线</p>
                </div>
                
                <button onclick="startGame()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-3 rounded-full font-medium hover:from-purple-600 hover:to-pink-600 transition-all transform hover:scale-105">
                    开始非遗寻宝之旅
                </button>
            </div>
        </div>
        
        <!-- 课前测试场景 -->
        <div id="preTestScene" class="scene hidden">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">鹏城非遗知多少？</h2>
                    <div class="pengzi-chat inline-block">
                        <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2">🦀</div>
                    </div>
                    <p class="text-gray-600">小传人，让我们先来测试一下你对鹏城非遗的初始记忆吧！</p>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-4">以下哪些是深圳的民间艺术？（可多选）</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="preTestOptions">
                        <!-- 选项会通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="submitPreTest()" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        提交答案
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 体验场景 -->
        <div id="experienceScene" class="scene hidden">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">鹏城非遗工坊</h2>
                    <div class="pengzi-chat inline-block mb-4">
                        <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2">🦀</div>
                    </div>
                    <p class="text-gray-600">欢迎来到非遗工坊！这里有七个神奇的体验区，让我们一起唤醒七艺之魂吧！</p>
                </div>
                
                <!-- 进度条 -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm text-gray-600">体验进度</span>
                        <span class="text-sm text-gray-600" id="progressText">0/7</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-gradient-to-r from-green-400 to-blue-500 h-3 rounded-full progress-bar" style="width: 0%" id="progressBar"></div>
                    </div>
                </div>
                
                <!-- 七艺体验区 -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="artExperiences">
                    <!-- 体验卡片会通过JavaScript动态生成 -->
                </div>
                
                <div class="text-center mt-8">
                    <button id="nextToTreasure" onclick="showTreasureScene()" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-8 py-3 rounded-full font-medium hover:from-yellow-500 hover:to-orange-600 transition-all transform hover:scale-105 hidden">
                        前往宝箱选择
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 宝箱选择场景 -->
        <div id="treasureScene" class="scene hidden">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">秘境宝箱</h2>
                    <div class="pengzi-chat inline-block mb-4">
                        <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2">🦀</div>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-4 mb-4">
                        <p class="text-gray-700" id="treasureRecommendation">根据你的体验表现，我推荐你选择...</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="treasureBoxes">
                    <!-- 宝箱会通过JavaScript动态生成 -->
                </div>
                
                <div class="text-center mt-6">
                    <button onclick="openSelectedBoxes()" class="bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-colors">
                        打开选中的宝箱
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 课后探宝场景 -->
        <div id="afterScene" class="scene hidden">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">非遗秘境探宝</h2>
                    <div class="pengzi-chat inline-block mb-4">
                        <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2">🦀</div>
                    </div>
                    <p class="text-gray-600">恭喜你获得了秘境之钥！快去实地探访真正的非遗传承地吧！</p>
                </div>
                
                <div id="secretKeys" class="space-y-4 mb-6">
                    <!-- 秘境钥匙会通过JavaScript动态生成 -->
                </div>
                
                <div class="text-center">
                    <button onclick="showEasterEgg()" class="bg-gradient-to-r from-pink-400 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-pink-500 hover:to-purple-600 transition-all">
                        🎁 发现更多彩蛋
                    </button>
                    <button onclick="restartGame()" class="ml-4 bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        重新开始游戏
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 游戏模态框 -->
    <div id="gameModal" class="fixed inset-0 bg-black/50 modal hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl max-w-md w-full p-6" id="modalContent">
            <!-- 模态框内容会动态更新 -->
        </div>
    </div>
    
    <!-- 彩蛋模态框 -->
    <div id="easterEggModal" class="fixed inset-0 bg-black/50 modal hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl max-w-2xl w-full max-h-96 overflow-y-auto p-6">
            <h3 class="text-xl font-bold mb-4">🎊 深圳·中国非遗万花筒</h3>
            <div class="pengzi-chat text-center mb-4">
                <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2 mx-auto">🦀</div>
                <p class="text-sm text-gray-600">小传人，鹏城的非遗宝藏可不止这七项哦！看看更广阔的非遗世界吧！</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-blue-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">🎭</div>
                    <p class="text-sm font-medium">粤剧</p>
                    <p class="text-xs text-gray-600">南国红豆</p>
                </div>
                <div class="bg-green-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">🏮</div>
                    <p class="text-sm font-medium">沙头角鱼灯舞</p>
                    <p class="text-xs text-gray-600">海上明珠</p>
                </div>
                <div class="bg-yellow-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">🍲</div>
                    <p class="text-sm font-medium">下沙大盆菜</p>
                    <p class="text-xs text-gray-600">围村盛宴</p>
                </div>
                <div class="bg-purple-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">🎨</div>
                    <p class="text-sm font-medium">满堂红瓷艺</p>
                    <p class="text-xs text-gray-600">红釉彩瓷</p>
                </div>
                <div class="bg-pink-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">💊</div>
                    <p class="text-sm font-medium">平乐郭氏正骨</p>
                    <p class="text-xs text-gray-600">悬壶济世</p>
                </div>
                <div class="bg-indigo-50 p-3 rounded-lg text-center">
                    <div class="text-2xl mb-2">🏺</div>
                    <p class="text-sm font-medium">更多非遗...</p>
                    <p class="text-xs text-gray-600">等你探索</p>
                </div>
            </div>
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg text-center">
                <p class="mb-2">🌟 暑期非遗探险家邀请</p>
                <p class="text-sm">选择一个心动的项目，去图书馆、博物馆或实地探访，成为小小非遗探险家吧！</p>
            </div>
            <div class="text-center mt-4">
                <button onclick="closeEasterEgg()" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                    关闭
                </button>
            </div>
        </div>
    </div>

    <script>
        // 游戏数据
        let gameData = {
            preTestAnswers: [],
            artScores: {},
            selectedBoxes: [],
            currentProgress: 0
        };
        
        // 七艺数据
        const arts = [
            {
                id: 'paper-cutting',
                name: '田氏剪纸',
                icon: '✂️',
                color: 'bg-red-500',
                description: '巧手剪乾坤',
                location: '罗湖区',
                venue: '罗湖区文化馆非遗展示中心',
                address: '深圳市罗湖区桂园街道',
                activity: '每周三下午有剪纸体验课程'
            },
            {
                id: 'qilin-dance',
                name: '麒麟舞',
                icon: '🦄',
                color: 'bg-yellow-500',
                description: '祥瑞踏鼓点',
                location: '龙岗区',
                venue: '龙岗区坂田麒麟舞传习所',
                address: '深圳市龙岗区坂田街道',
                activity: '每周六上午有麒麟舞表演和教学'
            },
            {
                id: 'fish-lantern',
                name: '鱼灯舞',
                icon: '🐠',
                color: 'bg-blue-500',
                description: '鱼跃龙门阵',
                location: '盐田区',
                venue: '盐田区沙头角鱼灯舞传承基地',
                address: '深圳市盐田区沙头角街道',
                activity: '节庆期间有鱼灯舞巡游表演'
            },
            {
                id: 'mantis-boxing',
                name: '螳螂拳',
                icon: '🥋',
                color: 'bg-green-500',
                description: '仿生武之道',
                location: '宝安区',
                venue: '宝安区传统武术馆',
                address: '深圳市宝安区新安街道',
                activity: '周末有螳螂拳教学课程'
            },
            {
                id: 'hakka-hat',
                name: '客家凉帽',
                icon: '👒',
                color: 'bg-purple-500',
                description: '经纬织清凉',
                location: '龙岗区',
                venue: '龙岗客家民俗博物馆',
                address: '深圳市龙岗区龙城街道',
                activity: '可预约体验凉帽制作工艺'
            },
            {
                id: 'sea-urchin-zongzi',
                name: '海胆粽',
                icon: '🍙',
                color: 'bg-orange-500',
                description: '山海滋味藏',
                location: '大鹏新区',
                venue: '大鹏所城非遗美食体验馆',
                address: '深圳市大鹏新区大鹏所城',
                activity: '端午节期间有海胆粽制作体验'
            },
            {
                id: 'woodblock-print',
                name: '版画艺术',
                icon: '🖼️',
                color: 'bg-indigo-500',
                description: '刻印新篇章',
                location: '龙岗区',
                venue: '观澜版画原创产业基地',
                address: '深圳市龙岗区观澜街道',
                activity: '版画工坊常年开放体验'
            }
        ];
        
        // 课前测试选项（包含干扰项）
        const preTestOptions = [
            { name: '田氏剪纸', correct: true, icon: '✂️' },
            { name: '麒麟舞', correct: true, icon: '🦄' },
            { name: '鱼灯舞', correct: true, icon: '🐠' },
            { name: '螳螂拳', correct: true, icon: '🥋' },
            { name: '客家凉帽', correct: true, icon: '👒' },
            { name: '海胆粽', correct: true, icon: '🍙' },
            { name: '版画艺术', correct: true, icon: '🖼️' },
            { name: '粤剧', correct: false, icon: '🎭' },
            { name: '佛山醒狮', correct: false, icon: '🦁' },
            { name: '潮汕英歌舞', correct: false, icon: '🥁' }
        ];
        
        // 开始游戏
        function startGame() {
            hideAllScenes();
            document.getElementById('preTestScene').classList.remove('hidden');
            initPreTest();
        }
        
        // 初始化课前测试
        function initPreTest() {
            const container = document.getElementById('preTestOptions');
            container.innerHTML = '';
            
            preTestOptions.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'game-card bg-gray-50 border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400 transition-all';
                optionDiv.onclick = () => togglePreTestOption(index, optionDiv);
                
                optionDiv.innerHTML = `
                    <div class="text-3xl mb-2">${option.icon}</div>
                    <p class="text-sm font-medium">${option.name}</p>
                `;
                
                container.appendChild(optionDiv);
            });
        }
        
        // 切换课前测试选项
        function togglePreTestOption(index, element) {
            if (gameData.preTestAnswers.includes(index)) {
                gameData.preTestAnswers = gameData.preTestAnswers.filter(i => i !== index);
                element.classList.remove('border-blue-500', 'bg-blue-50');
                element.classList.add('border-gray-200', 'bg-gray-50');
            } else {
                gameData.preTestAnswers.push(index);
                element.classList.remove('border-gray-200', 'bg-gray-50');
                element.classList.add('border-blue-500', 'bg-blue-50');
            }
        }
        
        // 提交课前测试
        function submitPreTest() {
            let feedback = '';
            const correctCount = gameData.preTestAnswers.filter(i => preTestOptions[i].correct).length;
            
            if (correctCount >= 5) {
                feedback = '哇！你连这么多都知道，不愧是未来守护者！';
            } else if (correctCount >= 3) {
                feedback = '不错不错！看来你对鹏城非遗有一定了解呢！';
            } else {
                feedback = '哦？看来有很多神秘的艺术等着我们一起探索呢！';
            }
            
            showModal('课前测试结果', `
                <div class="text-center">
                    <div class="bg-orange-400 text-white rounded-full w-16 h-16 flex items-center justify-center text-2xl mb-4 mx-auto">🦀</div>
                    <p class="mb-4">${feedback}</p>
                    <p class="text-sm text-gray-600 mb-4">你答对了 ${correctCount}/7 个深圳非遗项目</p>
                    <button onclick="closeModal(); startExperience();" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        开始非遗体验
                    </button>
                </div>
            `);
        }
        
        // 开始体验阶段
        function startExperience() {
            hideAllScenes();
            document.getElementById('experienceScene').classList.remove('hidden');
            initArtExperiences();
        }
        
        // 初始化艺术体验
        function initArtExperiences() {
            const container = document.getElementById('artExperiences');
            container.innerHTML = '';
            
            arts.forEach(art => {
                const artDiv = document.createElement('div');
                artDiv.className = `game-card ${art.color} text-white rounded-lg p-6 cursor-pointer hover:shadow-lg transition-all`;
                artDiv.onclick = () => startArtGame(art);
                
                artDiv.innerHTML = `
                    <div class="text-4xl mb-3 text-center">${art.icon}</div>
                    <h3 class="text-lg font-bold mb-2">${art.name}</h3>
                    <p class="text-sm opacity-90 mb-2">${art.description}</p>
                    <p class="text-xs opacity-75">${art.location}</p>
                    <div class="mt-4 text-center">
                        <span class="text-xs bg-white/20 px-3 py-1 rounded-full">
                            ${gameData.artScores[art.id] ? '已完成' : '点击体验'}
                        </span>
                    </div>
                `;
                
                if (gameData.artScores[art.id]) {
                    artDiv.style.opacity = '0.7';
                    artDiv.onclick = null;
                }
                
                container.appendChild(artDiv);
            });
        }
        
        // 开始艺术游戏
        function startArtGame(art) {
            let gameContent = '';
            
            switch(art.id) {
                case 'paper-cutting':
                    gameContent = createPaperCuttingGame(art);
                    break;
                case 'qilin-dance':
                    gameContent = createQilinDanceGame(art);
                    break;
                case 'fish-lantern':
                    gameContent = createFishLanternGame(art);
                    break;
                case 'mantis-boxing':
                    gameContent = createMantisBoxingGame(art);
                    break;
                case 'hakka-hat':
                    gameContent = createHakkaHatGame(art);
                    break;
                case 'sea-urchin-zongzi':
                    gameContent = createSeaUrchinZongziGame(art);
                    break;
                case 'woodblock-print':
                    gameContent = createWoodblockPrintGame(art);
                    break;
            }
            
            showModal(art.name + ' - ' + art.description, gameContent);
        }
        
        // 剪纸游戏
        function createPaperCuttingGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">将碎片拼成完整的剪纸图案！</p>
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <div class="bg-red-100 h-16 rounded flex items-center justify-center cursor-pointer border-2 border-dashed border-red-300" onclick="selectPiece(this, 1)">片1</div>
                        <div class="bg-red-100 h-16 rounded flex items-center justify-center cursor-pointer border-2 border-dashed border-red-300" onclick="selectPiece(this, 2)">片2</div>
                        <div class="bg-red-100 h-16 rounded flex items-center justify-center cursor-pointer border-2 border-dashed border-red-300" onclick="selectPiece(this, 3)">片3</div>
                        <div class="bg-red-100 h-16 rounded flex items-center justify-center cursor-pointer border-2 border-dashed border-red-300" onclick="selectPiece(this, 4)">片4</div>
                        <div class="bg-red-200 h-16 rounded flex items-center justify-center text-red-800">❀</div>
                        <div class="bg-red-100 h-16 rounded flex items-center justify-center cursor-pointer border-2 border-dashed border-red-300" onclick="selectPiece(this, 5)">片5</div>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">点击顺序：1 → 2 → 3 → 4 → 5</p>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 80)" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                        完成拼图
                    </button>
                </div>
            `;
        }
        
        // 麒麟舞游戏
        function createQilinDanceGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">跟着鼓点节拍舞动麒麟！</p>
                    <div class="mb-4">
                        <div class="flex justify-center space-x-2 mb-4">
                            <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center border-4 border-yellow-300 cursor-pointer hover:bg-yellow-200" onclick="beatDrum(this)">鼓</div>
                            <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center border-4 border-yellow-300 cursor-pointer hover:bg-yellow-200" onclick="beatDrum(this)">鼓</div>
                        </div>
                        <p class="text-sm text-gray-600">按节拍敲击！咚-咚-呛-咚！</p>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg mb-4">
                        <p class="text-sm">🎵 麒麟出洞、麒麟采青、麒麟戏珠...</p>
                    </div>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 85)" class="bg-yellow-500 text-white px-6 py-2 rounded-lg hover:bg-yellow-600 transition-colors">
                        完成表演
                    </button>
                </div>
            `;
        }
        
        // 鱼灯舞游戏
        function createFishLanternGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">控制鱼灯穿越巷道，点亮祈福灯笼！</p>
                    <div class="relative bg-blue-50 p-4 rounded-lg mb-4 h-32">
                        <div class="absolute top-2 left-2 w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white cursor-pointer" id="fishLantern">🐠</div>
                        <div class="absolute top-2 right-2 w-8 h-8 bg-yellow-300 rounded-full flex items-center justify-center">🏮</div>
                        <div class="absolute bottom-2 left-1/2 w-8 h-8 bg-yellow-300 rounded-full flex items-center justify-center">🏮</div>
                        <div class="absolute top-1/2 right-8 w-8 h-8 bg-yellow-300 rounded-full flex items-center justify-center">🏮</div>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">使用方向键或点击控制鱼灯移动</p>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 82)" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        完成游戏
                    </button>
                </div>
            `;
        }
        
        // 螳螂拳游戏
        function createMantisBoxingGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">学习螳螂拳的经典招式！</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                            <div class="text-2xl mb-2">🦂</div>
                            <p class="text-sm font-medium">螳螂捕蝉</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                            <div class="text-2xl mb-2">🤲</div>
                            <p class="text-sm font-medium">勾搂采手</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                            <div class="text-2xl mb-2">⚡</div>
                            <p class="text-sm font-medium">闪身靠打</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                            <div class="text-2xl mb-2">🔄</div>
                            <p class="text-sm font-medium">进退身法</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">观察招式，体会象形取意的精髓</p>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 79)" class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors">
                        完成练习
                    </button>
                </div>
            `;
        }
        
        // 客家凉帽游戏
        function createHakkaHatGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">选择正确的材料制作客家凉帽！</p>
                    <div class="mb-4">
                        <h4 class="text-sm font-medium mb-2">选择材料：</h4>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="bg-yellow-100 p-3 rounded cursor-pointer border-2 border-yellow-200 hover:border-yellow-400" onclick="selectMaterial(this, true)">
                                <div class="text-lg mb-1">🎋</div>
                                <p class="text-xs">竹篾</p>
                            </div>
                            <div class="bg-blue-100 p-3 rounded cursor-pointer border-2 border-blue-200 hover:border-blue-400" onclick="selectMaterial(this, true)">
                                <div class="text-lg mb-1">🧵</div>
                                <p class="text-xs">彩线</p>
                            </div>
                            <div class="bg-purple-100 p-3 rounded cursor-pointer border-2 border-purple-200 hover:border-purple-400" onclick="selectMaterial(this, true)">
                                <div class="text-lg mb-1">🧶</div>
                                <p class="text-xs">布料</p>
                            </div>
                            <div class="bg-gray-100 p-3 rounded cursor-pointer border-2 border-gray-200 hover:border-gray-400" onclick="selectMaterial(this, false)">
                                <div class="text-lg mb-1">🪨</div>
                                <p class="text-xs">石头</p>
                            </div>
                            <div class="bg-red-100 p-3 rounded cursor-pointer border-2 border-red-200 hover:border-red-400" onclick="selectMaterial(this, false)">
                                <div class="text-lg mb-1">🧱</div>
                                <p class="text-xs">砖块</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded cursor-pointer border-2 border-green-200 hover:border-green-400" onclick="selectMaterial(this, false)">
                                <div class="text-lg mb-1">🥬</div>
                                <p class="text-xs">蔬菜</p>
                            </div>
                        </div>
                    </div>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 83)" class="bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 transition-colors">
                        完成制作
                    </button>
                </div>
            `;
        }
        
        // 海胆粽游戏
        function createSeaUrchinZongziGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">按正确顺序制作海胆粽！</p>
                    <div class="space-y-2 mb-4">
                        <div class="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-400 text-left">
                            <span class="text-sm font-medium">1. 清洗新鲜海胆</span>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-400 text-left">
                            <span class="text-sm font-medium">2. 炒制糯米</span>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-400 text-left">
                            <span class="text-sm font-medium">3. 粽叶包馅</span>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-400 text-left">
                            <span class="text-sm font-medium">4. 绳子捆扎</span>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg border-l-4 border-orange-400 text-left">
                            <span class="text-sm font-medium">5. 下锅蒸煮</span>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">体验独特的海鲜风味粽子制作工艺</p>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 81)" class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors">
                        完成制作
                    </button>
                </div>
            `;
        }
        
        // 版画游戏
        function createWoodblockPrintGame(art) {
            return `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <p class="mb-4">体验版画的刻印过程！</p>
                    <div class="mb-4">
                        <div class="bg-indigo-50 p-4 rounded-lg mb-4">
                            <div class="grid grid-cols-4 gap-1 mb-2">
                                <div class="h-6 bg-indigo-200 rounded"></div>
                                <div class="h-6 bg-indigo-100 rounded"></div>
                                <div class="h-6 bg-indigo-200 rounded"></div>
                                <div class="h-6 bg-indigo-100 rounded"></div>
                                <div class="h-6 bg-indigo-100 rounded"></div>
                                <div class="h-6 bg-indigo-300 rounded"></div>
                                <div class="h-6 bg-indigo-300 rounded"></div>
                                <div class="h-6 bg-indigo-200 rounded"></div>
                            </div>
                            <p class="text-xs text-gray-600">大鹏所城版画效果</p>
                        </div>
                        <div class="flex justify-center space-x-4">
                            <button class="bg-indigo-200 px-3 py-1 rounded text-sm hover:bg-indigo-300 transition-colors" onclick="selectTool('刻刀')">🔪 刻刀</button>
                            <button class="bg-indigo-200 px-3 py-1 rounded text-sm hover:bg-indigo-300 transition-colors" onclick="selectTool('油墨')">🎨 油墨</button>
                            <button class="bg-indigo-200 px-3 py-1 rounded text-sm hover:bg-indigo-300 transition-colors" onclick="selectTool('拓包')">⚫ 拓包</button>
                        </div>
                    </div>
                    <button onclick="completeArtGame('${art.id}', Math.floor(Math.random() * 20) + 84)" class="bg-indigo-500 text-white px-6 py-2 rounded-lg hover:bg-indigo-600 transition-colors">
                        完成版画
                    </button>
                </div>
            `;
        }
        
        // 完成艺术游戏
        function completeArtGame(artId, score) {
            gameData.artScores[artId] = score;
            gameData.currentProgress++;
            
            updateProgress();
            
            const art = arts.find(a => a.id === artId);
            
            showModal('游戏完成！', `
                <div class="text-center">
                    <div class="text-4xl mb-4">${art.icon}</div>
                    <h3 class="text-lg font-bold mb-2">${art.name}</h3>
                    <div class="bg-green-100 border border-green-400 rounded-lg p-4 mb-4">
                        <p class="text-green-800 font-medium mb-2">恭喜完成体验！</p>
                        <p class="text-green-700">你的得分：${score}/100</p>
                    </div>
                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4">
                        <div class="bg-orange-400 text-white rounded-full w-12 h-12 flex items-center justify-center text-xl mb-2 mx-auto">🦀</div>
                        <p class="text-sm text-gray-700">鹏仔：太棒了！你已经初步掌握了${art.name}的精髓！</p>
                    </div>
                    <button onclick="closeModal(); initArtExperiences();" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        继续探索
                    </button>
                </div>
            `);
        }
        
        // 更新进度
        function updateProgress() {
            const progress = (gameData.currentProgress / 7) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${gameData.currentProgress}/7`;
            
            if (gameData.currentProgress === 7) {
                document.getElementById('nextToTreasure').classList.remove('hidden');
            }
        }
        
        // 显示宝箱选择场景
        function showTreasureScene() {
            hideAllScenes();
            document.getElementById('treasureScene').classList.remove('hidden');
            initTreasureScene();
        }
        
        // 初始化宝箱场景
        function initTreasureScene() {
            // 找出得分最高的艺术
            let bestArt = null;
            let bestScore = 0;
            
            Object.entries(gameData.artScores).forEach(([artId, score]) => {
                if (score > bestScore) {
                    bestScore = score;
                    bestArt = arts.find(a => a.id === artId);
                }
            });
            
            // 设置推荐文本
            const recommendationEl = document.getElementById('treasureRecommendation');
            if (bestArt) {
                recommendationEl.textContent = `根据你的体验表现，你在【${bestArt.name}】上展现了非凡的天赋！得分：${bestScore}/100。我推荐你选择它的宝箱，或者跟随内心选择你最感兴趣的艺术！`;
            }
            
            // 生成宝箱
            const container = document.getElementById('treasureBoxes');
            container.innerHTML = '';
            
            arts.forEach(art => {
                const boxDiv = document.createElement('div');
                boxDiv.className = `treasure-box cursor-pointer p-4 rounded-lg border-4 transition-all ${
                    art.id === bestArt?.id ? 'border-yellow-400 bg-yellow-50' : 'border-gray-300 bg-white'
                }`;
                boxDiv.onclick = () => toggleTreasureBox(art.id, boxDiv);
                
                boxDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-3xl mb-2">📦</div>
                        <div class="text-2xl mb-2">${art.icon}</div>
                        <p class="text-sm font-medium">${art.name}</p>
                        ${art.id === bestArt?.id ? '<p class="text-xs text-yellow-600 mt-1">推荐</p>' : ''}
                    </div>
                `;
                
                container.appendChild(boxDiv);
            });
        }
        
        // 切换宝箱选择
        function toggleTreasureBox(artId, element) {
            if (gameData.selectedBoxes.includes(artId)) {
                gameData.selectedBoxes = gameData.selectedBoxes.filter(id => id !== artId);
                element.classList.remove('border-purple-500', 'bg-purple-50');
                element.classList.add('border-gray-300', 'bg-white');
            } else {
                gameData.selectedBoxes.push(artId);
                element.classList.remove('border-gray-300', 'bg-white');
                element.classList.add('border-purple-500', 'bg-purple-50');
            }
        }
        
        // 打开选中的宝箱
        function openSelectedBoxes() {
            if (gameData.selectedBoxes.length === 0) {
                alert('请先选择至少一个宝箱！');
                return;
            }
            
            hideAllScenes();
            document.getElementById('afterScene').classList.remove('hidden');
            generateSecretKeys();
        }
        
        // 生成秘境钥匙
        function generateSecretKeys() {
            const container = document.getElementById('secretKeys');
            container.innerHTML = '';
            
            gameData.selectedBoxes.forEach(artId => {
                const art = arts.find(a => a.id === artId);
                
                const keyDiv = document.createElement('div');
                keyDiv.className = 'bg-gradient-to-r from-yellow-100 to-orange-100 border border-yellow-300 rounded-lg p-6';
                
                keyDiv.innerHTML = `
                    <div class="flex items-start space-x-4">
                        <div class="text-4xl">${art.icon}</div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800 mb-2">${art.name} 秘境之钥 🗝️</h3>
                            <div class="space-y-2 text-sm">
                                <p><span class="font-medium">传承基地：</span>${art.venue}</p>
                                <p><span class="font-medium">地址：</span>${art.address}</p>
                                <p><span class="font-medium">推荐活动：</span>${art.activity}</p>
                            </div>
                            <div class="mt-3 bg-yellow-200 rounded-lg p-3">
                                <p class="text-xs text-yellow-800">💡 快带着这把钥匙，在课后或假期去实地探访吧！那里有真正的传承人在等着你！</p>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(keyDiv);
            });
        }
        
        // 显示彩蛋
        function showEasterEgg() {
            document.getElementById('easterEggModal').classList.remove('hidden');
        }
        
        // 关闭彩蛋
        function closeEasterEgg() {
            document.getElementById('easterEggModal').classList.add('hidden');
        }
        
        // 重新开始游戏
        function restartGame() {
            gameData = {
                preTestAnswers: [],
                artScores: {},
                selectedBoxes: [],
                currentProgress: 0
            };
            
            hideAllScenes();
            document.getElementById('introScene').classList.remove('hidden');
            
            // 重置进度条
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressText').textContent = '0/7';
            document.getElementById('nextToTreasure').classList.add('hidden');
        }
        
        // 工具函数
        function hideAllScenes() {
            document.querySelectorAll('.scene').forEach(scene => {
                scene.classList.add('hidden');
            });
        }
        
        function showModal(title, content) {
            document.getElementById('modalContent').innerHTML = `
                <h3 class="text-xl font-bold mb-4">${title}</h3>
                ${content}
            `;
            document.getElementById('gameModal').classList.remove('hidden');
        }
        
        function closeModal() {
            document.getElementById('gameModal').classList.add('hidden');
        }
        
        // 游戏辅助函数
        function selectPiece(element, number) {
            element.style.backgroundColor = '#fef2f2';
            element.style.borderColor = '#f87171';
            element.innerHTML = '✓';
        }
        
        function beatDrum(element) {
            element.style.animation = 'pulse 0.3s';
            setTimeout(() => {
                element.style.animation = '';
            }, 300);
        }
        
        function selectMaterial(element, isCorrect) {
            if (isCorrect) {
                element.style.borderColor = '#10b981';
                element.style.backgroundColor = '#d1fae5';
            } else {
                element.style.borderColor = '#ef4444';
                element.style.backgroundColor = '#fee2e2';
            }
        }
        
        function selectTool(tool) {
            console.log('选择工具：', tool);
        }
        
        
    </script>
</body>
</html>
