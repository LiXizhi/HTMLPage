<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’å°‘å¹´ç”¨æˆ·ç”»åƒ</title>
    <script src="https://cdn.keepwork.com/keepwork/cdn/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            width: 100%;
            height: 100vh;
            overflow: hidden;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .profile-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin: 10px;
            width: calc(100% - 20px);
            height: calc(100% - 20px);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        .profile-container.loaded {
            opacity: 1;
        }
        
        .header {
            background: linear-gradient(135deg, #6fa8dc 0%, #9fc5e8 100%);
            color: white;
            padding: 12px 25px;
            border-radius: 12px 12px 0 0;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header-title {
            display: inline-block;
        }
        
        .content {
            flex: 1;
            display: flex;
            padding: 15px;
            gap: 15px;
        }
        
        .left-panel {
            width: 280px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .personal-info {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: box-shadow 0.3s ease;
        }
        
        .personal-info:hover {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        
        .avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
        }
        
        .nickName {
            font-size: 20px;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 8px;
        }
        
        .userName {
            color: #636e72;
            font-size: 13px;
            margin-bottom: 12px;
        }
        
        .radar-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            border: 2px solid #e9ecef;
            flex: 1;
            transition: box-shadow 0.3s ease;
        }
        
        .radar-container:hover {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        
        .radar-title {
            text-align: center;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .radar-chart-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 0;
            position: relative;
        }
        
        .radar-chart {
            width: 100% !important;
            height: 100% !important;
            max-width: min(100%, 300px);
            max-height: min(100%, 300px);
        }
        
        /* Canvasé«˜DPIä¼˜åŒ– */
        #radarChart {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            image-rendering: pixelated;
            -ms-interpolation-mode: nearest-neighbor;
            image-rendering: optimizeQuality;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }
        
        .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .ability-section {
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            overflow: hidden;
            margin-bottom: 1vh;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .section-header {
            background: #a8d8ea;
            color: #2d3436;
            padding: 1vh 2vw;
            font-weight: bold;
            font-size: clamp(12px, 2vw, 16px);
            text-align: center;
        }
        
        .section-header:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        }
        
        .section-content {
            flex: 1;
            display: flex;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 2px;
            background: #e9ecef;
            height: 100%;
        }
        
        .ability-item {
            background: white;
            padding: 8px;
            text-align: center;
            font-size: 11px;
            transition: all 0.2s ease;
            cursor: pointer;
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-left: -1px;
        }
        
        .ability-item:hover {
            background-color: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }
        
        .ability-item:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .ability-label {
            color: #636e72;
            margin-bottom: 2px;
        }
        
        .ability-value {
            font-weight: bold;
            color: #2d3436;
            font-size: 13px;
        }
        
        .ability-score-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        
        .ability-emoji {
            font-size: 16px;
            line-height: 1;
        }
        
        .ability-value.empty {
            color: #ddd;
        }
        
        .cognitive-section .section-header {
            background: #a8d8ea;
        }
        
        .strategy-section .section-header {
            background: #a8d8ea;
        }
        
        .motivation-section .section-header {
            background: #a8d8ea;
        }
        
        .emotion-section .section-header {
            background: #a8d8ea;
        }
        
        .quality-section .section-header {
            background: #a8d8ea;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: clamp(14px, 3vw, 20px);
            color: #636e72;
        }
        
        /* Modalæ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            animation: slideIn 0.3s ease;
            position: relative;
        }
        
        .modal-header {
            background: linear-gradient(135deg, #6fa8dc 0%, #9fc5e8 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 40px;
            font-weight: bold;
        }
        
        .close {
            color: white;
            font-size: 4rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            transition: color 0.2s ease;
        }
        
        .close:hover {
            color: #f0f0f0;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .ability-info {
            text-align: left;
        }
        
        .ability-name {
            font-size: 40px;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .ability-description {
            font-size: 30px;
            line-height: 1.6;
            color: #636e72;
            text-align: justify;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
    </style>
</head>
<body>
    <div class="profile-container" id="profileContainer">
        <div class="header">
            <span class="header-title">ä¸ªäººä¿¡æ¯</span>
        </div>
        
        <div class="content">
            <div class="left-panel">
                <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
                <div class="personal-info">
                    <div class="avatar">ğŸ‘¤</div>
                    <div class="nickName">ç”¨æˆ·æ˜µç§°ï¼š</div>
                    <div class="userName">è´¦å·ï¼š</div>
                    <div class="user-info-extra" style="display: none;"></div>
                </div>
                <!-- é›·è¾¾å›¾ -->
                <div class="radar-container">
                    <div class="radar-title">ç»¼åˆèƒ½åŠ›</div>
                    <div class="radar-chart-container">
                        <canvas id="radarChart" class="radar-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="right-panel">
                <!-- è®¤çŸ¥èƒ½åŠ› -->
                <div class="ability-section cognitive-section">
                    <div class="section-header">è®¤çŸ¥èƒ½åŠ›</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">é›†ä¸­æ€§æ³¨æ„åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="focusedAttention">-</div>
                                <div class="ability-emoji" id="focusedAttention-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">é€‰æ‹©æ€§æ³¨æ„åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="selectiveAttention">-</div>
                                <div class="ability-emoji" id="selectiveAttention-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è½¬ç§»æ€§æ³¨æ„åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="shiftingAttention">-</div>
                                <div class="ability-emoji" id="shiftingAttention-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">åˆ†é…æ€§æ³¨æ„åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="distributedAttention">-</div>
                                <div class="ability-emoji" id="distributedAttention-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è§†è§‰è®°å¿†</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="visualMemory">-</div>
                                <div class="ability-emoji" id="visualMemory-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å¬è§‰è®°å¿†</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="auditoryMemory">-</div>
                                <div class="ability-emoji" id="auditoryMemory-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å·¥ä½œè®°å¿†</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="workingMemory">-</div>
                                <div class="ability-emoji" id="workingMemory-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ€ç»´èƒ½åŠ› -->
                <div class="ability-section cognitive-section">
                    <div class="section-header">æ€ç»´èƒ½åŠ›</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">å½’çº³æ¨ç†èƒ½åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="inductiveReasoning">-</div>
                                <div class="ability-emoji" id="inductiveReasoning-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">æ¼”ç»æ¨ç†èƒ½åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="deductiveReasoning">-</div>
                                <div class="ability-emoji" id="deductiveReasoning-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ç±»æ¯”æ¨ç†èƒ½åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="analogicalReasoning">-</div>
                                <div class="ability-emoji" id="analogicalReasoning-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è¨€è¯­ç†è§£èƒ½åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="verbalComprehension">-</div>
                                <div class="ability-emoji" id="verbalComprehension-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">æŠ½è±¡æ¨ç†èƒ½åŠ›</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="abstractReasoning">-</div>
                                <div class="ability-emoji" id="abstractReasoning-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è§†è§‰ç©ºé—´æ™ºèƒ½</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="visualSpatialIntelligence">-</div>
                                <div class="ability-emoji" id="visualSpatialIntelligence-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å­¦ä¹ ç­–ç•¥ -->
                <div class="ability-section strategy-section">
                    <div class="section-header">å­¦ä¹ ç­–ç•¥</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">å¤è¿°ç­–ç•¥</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="elaborationStrategy">-</div>
                                <div class="ability-emoji" id="elaborationStrategy-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ç²¾ç»†åŠ å·¥ç­–ç•¥</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="detailedProcessingStrategy">-</div>
                                <div class="ability-emoji" id="detailedProcessingStrategy-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ç»„ç»‡ç­–ç•¥</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="organizationalStrategy">-</div>
                                <div class="ability-emoji" id="organizationalStrategy-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å…ƒè®¤çŸ¥è®¡åˆ’</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="metacognitivePlanning">-</div>
                                <div class="ability-emoji" id="metacognitivePlanning-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å…ƒè®¤çŸ¥ç›‘æ§</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="metacognitiveMonitoring">-</div>
                                <div class="ability-emoji" id="metacognitiveMonitoring-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å…ƒè®¤çŸ¥è°ƒèŠ‚</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="metacognitiveRegulation">-</div>
                                <div class="ability-emoji" id="metacognitiveRegulation-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">åŠªåŠ›ç®¡ç†</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="effortManagement">-</div>
                                <div class="ability-emoji" id="effortManagement-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">æ—¶é—´ç®¡ç†</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="timeManagement">-</div>
                                <div class="ability-emoji" id="timeManagement-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å¤–ç•Œèµ„æºåˆ©ç”¨</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="externalResourceUtilization">-</div>
                                <div class="ability-emoji" id="externalResourceUtilization-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å­¦ä¹ åŠ¨æœº -->
                <div class="ability-section motivation-section">
                    <div class="section-header">å­¦ä¹ åŠ¨æœº</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">æˆé•¿</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="growth">-</div>
                                <div class="ability-emoji" id="growth-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è‡ªä¸»</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="autonomy">-</div>
                                <div class="ability-emoji" id="autonomy-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">äº’åŠ¨</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="interaction">-</div>
                                <div class="ability-emoji" id="interaction-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">å…´è¶£</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="interest">-</div>
                                <div class="ability-emoji" id="interest-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">è®¤å¯</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="recognition">-</div>
                                <div class="ability-emoji" id="recognition-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ç«äº‰</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="competition">-</div>
                                <div class="ability-emoji" id="competition-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ç‰©è´¨å¥–åŠ±</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="materialReward">-</div>
                                <div class="ability-emoji" id="materialReward-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æƒ…ç»ªæ™ºåŠ› -->
                <div class="ability-section emotion-section">
                    <div class="section-header">æƒ…ç»ªæ™ºåŠ›</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">æƒ…ç»ªæ„ŸçŸ¥ç†è§£</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="emotionalAwareness">-</div>
                                <div class="ability-emoji" id="emotionalAwareness-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">æƒ…ç»ªè°ƒèŠ‚è¡¨è¾¾</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="emotionalRegulation">-</div>
                                <div class="ability-emoji" id="emotionalRegulation-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å­¦ä¹ å“è´¨ -->
                <div class="ability-section quality-section">
                    <div class="section-header">å­¦ä¹ å“è´¨</div>
                    <div class="section-content">
                        <div class="ability-item">
                            <div class="ability-label">è´£ä»»å¿ƒ</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="responsibility">-</div>
                                <div class="ability-emoji" id="responsibility-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">ä¸¥è°¨æ€§</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="seriousness">-</div>
                                <div class="ability-emoji" id="seriousness-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">åšæ¯…æ€§</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="perseverance">-</div>
                                <div class="ability-emoji" id="perseverance-emoji"></div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-label">åˆ›æ–°æ€§</div>
                            <div class="ability-score-container">
                                <div class="ability-value" id="creativity">-</div>
                                <div class="ability-emoji" id="creativity-emoji"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modalå¼¹æ¡† -->
    <div id="abilityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">èƒ½åŠ›è¯¦æƒ…</h3>
                <span class="close" onclick="closeAbilityModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="ability-info">
                    <div class="ability-name" id="modalAbilityName"></div>
                    <div class="ability-description" id="modalAbilityDescription"></div>
                </div>
                <div class="game-info" id="gameInfo" style="margin-top: 40px; padding-top: 40px; border-top: 2px solid #eee; display: none;">
                    <h4 style="margin-bottom: 20px; color: #333; font-size: 32px;">ç›¸å…³æ¸¸æˆ</h4>
                    <div class="game-name" id="modalGameName" style="color: #007bff; cursor: pointer; text-decoration: underline; font-weight: bold; font-size: 28px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let radarChart;
        let profileData = {};
        let userInfoData = {};
        let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        let isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        const isLandscape = () => window.innerWidth > window.innerHeight;
        const getScreenSize = () => ({
            width: window.innerWidth,
            height: window.innerHeight,
            ratio: window.devicePixelRatio || 1
        });
        
        // ç›‘å¬æ¥è‡ªçˆ¶é¡µé¢çš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            console.log("æ”¶åˆ°æ¶ˆæ¯",event.data)
            if (event.data && event.data.type === 'setGameConfig') {
                profileData = event.data.data.profileData;
                userInfoData = event.data.data.userInfoData;
                profileData && updateProfile(profileData);
                userInfoData && updateUserInfo(userInfoData);
            }
        });
        
        // é¡µé¢åŠ è½½å®Œæˆåå‘é€æ¶ˆæ¯
        window.addEventListener('load', function() {
            // é€šçŸ¥çˆ¶é¡µé¢é¡µé¢å·²åŠ è½½
            window.parent.postMessage({
                type: 'pageLoaded'
            }, '*');
            
            // è¯·æ±‚æ•°æ®
            window.parent.postMessage({
                type: 'requestProfileData'
            }, '*');
            
            // æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ requestAnimationFrame
            requestAnimationFrame(() => {
                initRadarChart();
                // adjustLayout();
                if (isTouch) {
                    addTouchEvents();
                }
                
                // åˆå§‹åŒ–èƒ½åŠ›é¡¹ç‚¹å‡»äº‹ä»¶
                initAbilityItemEvents();
                
                // æ·»åŠ åŠ è½½å®Œæˆçš„è§†è§‰åé¦ˆ
                const container = document.getElementById('profileContainer');
                container.classList.add('loaded');
                
                // é¢„åŠ è½½ä¼˜åŒ–
                preloadOptimizations();
            });
        });
        
        // é¢„è®¾ç½®ä¸€äº›æ ·å¼ä»¥é¿å…é—ªçƒ
        const container = document.getElementById('profileContainer');
        if (container) {
            container.style.visibility = 'visible';
        }
        
        // æ·»åŠ åŠ è½½æŒ‡ç¤ºå™¨
        showLoadingIndicator();
        
        // é¢„åŠ è½½ä¼˜åŒ–
        function preloadOptimizations() {
            // é¢„è®¡ç®—ä¸€äº›å€¼ä»¥æé«˜æ€§èƒ½
            const screenSize = getScreenSize();
            
            // ç¼“å­˜DOMå…ƒç´ 
            window.cachedElements = {
                container: document.getElementById('profileContainer'),
                content: document.querySelector('.content'),
                leftPanel: document.querySelector('.left-panel'),
                rightPanel: document.querySelector('.right-panel'),
                radarContainer: document.querySelector('.radar-container')
            };
            
            // ç§»é™¤åŠ è½½æŒ‡ç¤ºå™¨
            hideLoadingIndicator();
        }
        
        // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
        function showLoadingIndicator() {
            const loadingDiv = document.querySelector('.loading');
            if (loadingDiv) {
                loadingDiv.style.display = 'flex';
            }
        }
        
        // éšè—åŠ è½½æŒ‡ç¤ºå™¨
        function hideLoadingIndicator() {
            const loadingDiv = document.querySelector('.loading');
            if (loadingDiv) {
                loadingDiv.style.opacity = '0';
                setTimeout(() => {
                    loadingDiv.style.display = 'none';
                }, 300);
            }
        }
            
        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // èƒ½åŠ›é…ç½®æ•°æ®
        const abilityConfig = {
            // è®¤çŸ¥èƒ½åŠ›
            focusedAttention: {
                id: 'focusedAttention',
                label: 'é›†ä¸­æ€§æ³¨æ„åŠ›',
                description: 'æŒ‡åœ¨ä¸€å®šæ—¶é—´å†…ä¸“æ³¨äºç‰¹å®šä»»åŠ¡æˆ–åˆºæ¿€çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä¿æŒä¸“æ³¨ï¼Œä¸è¢«å¤–ç•Œå¹²æ‰°åˆ†æ•£æ³¨æ„åŠ›ï¼Œä»è€Œæé«˜å­¦ä¹ æ•ˆç‡å’Œè´¨é‡ã€‚é›†ä¸­æ€§æ³¨æ„åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿæ›´å¥½åœ°å®Œæˆéœ€è¦æŒç»­ä¸“æ³¨çš„ä»»åŠ¡ï¼Œå¦‚é˜…è¯»ã€å¬è®²å’Œè§£é¢˜ã€‚'
            },
            selectiveAttention: {
                id: 'selectiveAttention',
                label: 'é€‰æ‹©æ€§æ³¨æ„åŠ›',
                description: 'æŒ‡ä»å¤šä¸ªåˆºæ¿€ä¸­é€‰æ‹©æ€§åœ°å…³æ³¨é‡è¦ä¿¡æ¯ï¼Œå¿½ç•¥æ— å…³ä¿¡æ¯çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨å¤æ‚çš„å­¦ä¹ ç¯å¢ƒä¸­ç­›é€‰å‡ºå…³é”®ä¿¡æ¯ï¼Œæé«˜ä¿¡æ¯å¤„ç†çš„æ•ˆç‡ã€‚é€‰æ‹©æ€§æ³¨æ„åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿåœ¨å˜ˆæ‚çš„ç¯å¢ƒä¸­ä¸“æ³¨å­¦ä¹ ï¼Œå¿«é€Ÿè¯†åˆ«é‡ç‚¹å†…å®¹ã€‚'
            },
            shiftingAttention: {
                id: 'shiftingAttention',
                label: 'è½¬ç§»æ€§æ³¨æ„åŠ›',
                description: 'æŒ‡æ ¹æ®ä»»åŠ¡éœ€è¦çµæ´»è½¬æ¢æ³¨æ„åŠ›ç„¦ç‚¹çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨ä¸åŒå­¦ä¹ ä»»åŠ¡é—´å¿«é€Ÿåˆ‡æ¢ï¼Œé€‚åº”å¤šä»»åŠ¡å­¦ä¹ ç¯å¢ƒã€‚è½¬ç§»æ€§æ³¨æ„åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å¤åˆå‹å­¦ä¹ ä»»åŠ¡ï¼Œåœ¨ä¸åŒå­¦ç§‘é—´çµæ´»è½¬æ¢æ€ç»´æ¨¡å¼ã€‚'
            },
            distributedAttention: {
                id: 'distributedAttention',
                label: 'åˆ†é…æ€§æ³¨æ„åŠ›',
                description: 'æŒ‡åŒæ—¶å…³æ³¨å¤šä¸ªä»»åŠ¡æˆ–ä¿¡æ¯æºçš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨å¤šä»»åŠ¡ç¯å¢ƒä¸­ä¿æŒæ•ˆç‡ï¼Œåˆç†åˆ†é…è®¤çŸ¥èµ„æºã€‚åˆ†é…æ€§æ³¨æ„åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿåœ¨å¬è®²çš„åŒæ—¶åšç¬”è®°ï¼Œæˆ–è€…åŒæ—¶å¤„ç†å¤šä¸ªå­¦ä¹ ä»»åŠ¡è€Œä¸é™ä½è´¨é‡ã€‚'
            },
            visualMemory: {
                id: 'visualMemory',
                label: 'è§†è§‰è®°å¿†',
                description: 'æŒ‡å¯¹è§†è§‰ä¿¡æ¯è¿›è¡Œç¼–ç ã€å­˜å‚¨å’Œæå–çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…è®°ä½å›¾è¡¨ã€å›¾åƒã€æ–‡å­—å¸ƒå±€ç­‰è§†è§‰ææ–™ã€‚è§†è§‰è®°å¿†å¼ºçš„å­¦ä¹ è€…åœ¨å­¦ä¹ å‡ ä½•ã€åœ°ç†ã€è‰ºæœ¯ç­‰éœ€è¦è§†è§‰æƒ³è±¡çš„å­¦ç§‘æ—¶å…·æœ‰ä¼˜åŠ¿ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œè®°å¿†ç©ºé—´å…³ç³»ã€‚'
            },
            auditoryMemory: {
                id: 'auditoryMemory',
                label: 'å¬è§‰è®°å¿†',
                description: 'æŒ‡å¯¹å¬è§‰ä¿¡æ¯è¿›è¡Œç¼–ç ã€å­˜å‚¨å’Œæå–çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…è®°ä½è¯­è¨€ã€éŸ³ä¹ã€å£°éŸ³ç­‰å¬è§‰ææ–™ã€‚å¬è§‰è®°å¿†å¼ºçš„å­¦ä¹ è€…åœ¨è¯­è¨€å­¦ä¹ ã€éŸ³ä¹å­¦ä¹ ç­‰æ–¹é¢è¡¨ç°çªå‡ºï¼Œèƒ½å¤Ÿæ›´å¥½åœ°è®°ä½è€å¸ˆçš„è®²è§£å’ŒéŸ³é¢‘ææ–™ã€‚'
            },
            workingMemory: {
                id: 'workingMemory',
                label: 'å·¥ä½œè®°å¿†',
                description: 'æŒ‡åœ¨æ‰§è¡Œè®¤çŸ¥ä»»åŠ¡æ—¶ä¸´æ—¶å­˜å‚¨å’Œæ“ä½œä¿¡æ¯çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›æ˜¯å­¦ä¹ å’Œæ€ç»´çš„æ ¸å¿ƒï¼Œå½±å“ç†è§£ã€æ¨ç†å’Œé—®é¢˜è§£å†³ã€‚å·¥ä½œè®°å¿†å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿåœ¨å¿ƒç†ä¸ŠåŒæ—¶ä¿æŒå¤šä¸ªä¿¡æ¯ï¼Œè¿›è¡Œå¤æ‚çš„æ€ç»´æ“ä½œï¼Œåœ¨æ•°å­¦è®¡ç®—å’Œé€»è¾‘æ¨ç†ä¸­è¡¨ç°ä¼˜å¼‚ã€‚'
            },
            inductiveReasoning: {
                id: 'inductiveReasoning',
                label: 'å½’çº³æ¨ç†èƒ½åŠ›',
                description: 'æŒ‡ä»å…·ä½“äº‹ä¾‹ä¸­æ€»ç»“å‡ºä¸€èˆ¬è§„å¾‹çš„æ€ç»´èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…å‘ç°æ¨¡å¼ã€æ€»ç»“è§„å¾‹ï¼Œå½¢æˆæ¦‚å¿µå’Œç†è®ºã€‚å½’çº³æ¨ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…å–„äºä»å®ä¾‹ä¸­æŠ½è±¡å‡ºåŸç†ï¼Œåœ¨ç§‘å­¦ç ”ç©¶å’Œåˆ›æ–°æ€ç»´ä¸­å…·æœ‰ä¼˜åŠ¿ã€‚'
            },
            deductiveReasoning: {
                id: 'deductiveReasoning',
                label: 'æ¼”ç»æ¨ç†èƒ½åŠ›',
                description: 'æŒ‡ä»ä¸€èˆ¬åŸç†æ¨å¯¼å‡ºå…·ä½“ç»“è®ºçš„æ€ç»´èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…è¿ç”¨å·²çŸ¥è§„å¾‹è§£å†³æ–°é—®é¢˜ï¼Œè¿›è¡Œé€»è¾‘æ¨ç†ã€‚æ¼”ç»æ¨ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…å–„äºè¿ç”¨ç†è®ºçŸ¥è¯†åˆ†æå®é™…é—®é¢˜ï¼Œåœ¨æ•°å­¦è¯æ˜å’Œé€»è¾‘åˆ†æä¸­è¡¨ç°çªå‡ºã€‚'
            },
            analogicalReasoning: {
                id: 'analogicalReasoning',
                label: 'ç±»æ¯”æ¨ç†èƒ½åŠ›',
                description: 'æŒ‡é€šè¿‡æ¯”è¾ƒä¸åŒäº‹ç‰©é—´çš„ç›¸ä¼¼æ€§æ¥è¿›è¡Œæ¨ç†çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…è¿ç”¨å·²æœ‰çŸ¥è¯†ç†è§£æ–°æ¦‚å¿µï¼Œä¿ƒè¿›çŸ¥è¯†è¿ç§»ã€‚ç±»æ¯”æ¨ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…å–„äºå‘ç°äº‹ç‰©é—´çš„å†…åœ¨è”ç³»ï¼Œèƒ½å¤Ÿå¿«é€Ÿç†è§£æŠ½è±¡æ¦‚å¿µã€‚'
            },
            verbalComprehension: {
                id: 'verbalComprehension',
                label: 'è¨€è¯­ç†è§£èƒ½åŠ›',
                description: 'æŒ‡ç†è§£å’Œè¿ç”¨è¯­è¨€çš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬è¯æ±‡ç†è§£ã€è¯­æ³•æŒæ¡å’Œè¯­ä¹‰åˆ†æã€‚è¿™ç§èƒ½åŠ›æ˜¯å­¦ä¹ çš„åŸºç¡€ï¼Œå½±å“é˜…è¯»ç†è§£å’Œè¡¨è¾¾èƒ½åŠ›ã€‚è¨€è¯­ç†è§£èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…åœ¨è¯­æ–‡ã€å¤–è¯­ç­‰è¯­è¨€ç±»å­¦ç§‘ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œèƒ½å¤Ÿå‡†ç¡®ç†è§£å¤æ‚çš„æ–‡æœ¬å†…å®¹ã€‚'
            },
            abstractReasoning: {
                id: 'abstractReasoning',
                label: 'æŠ½è±¡æ¨ç†èƒ½åŠ›',
                description: 'æŒ‡å¤„ç†æŠ½è±¡æ¦‚å¿µå’Œç¬¦å·å…³ç³»çš„æ€ç»´èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…ç†è§£å¤æ‚çš„ç†è®ºæ¦‚å¿µï¼Œè¿›è¡Œé«˜å±‚æ¬¡çš„æ€ç»´æ´»åŠ¨ã€‚æŠ½è±¡æ¨ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…åœ¨æ•°å­¦ã€ç‰©ç†ã€å“²å­¦ç­‰éœ€è¦æŠ½è±¡æ€ç»´çš„å­¦ç§‘ä¸­å…·æœ‰ä¼˜åŠ¿ã€‚'
            },
            visualSpatialIntelligence: {
                id: 'visualSpatialIntelligence',
                label: 'è§†è§‰ç©ºé—´æ™ºèƒ½',
                description: 'æŒ‡æ„ŸçŸ¥ã€ç†è§£å’Œæ“ä½œè§†è§‰ç©ºé—´ä¿¡æ¯çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…ç†è§£å‡ ä½•å…³ç³»ã€ç©ºé—´ç»“æ„å’Œè§†è§‰æ¨¡å¼ã€‚è§†è§‰ç©ºé—´æ™ºèƒ½å¼ºçš„å­¦ä¹ è€…åœ¨å‡ ä½•ã€å·¥ç¨‹ã€è‰ºæœ¯è®¾è®¡ç­‰é¢†åŸŸè¡¨ç°çªå‡ºï¼Œèƒ½å¤Ÿå¾ˆå¥½åœ°è¿›è¡Œç©ºé—´æƒ³è±¡å’Œæ“ä½œã€‚'
            },
            // å­¦ä¹ ç­–ç•¥
            elaborationStrategy: {
                id: 'elaborationStrategy',
                label: 'å¤è¿°ç­–ç•¥',
                description: 'æŒ‡é€šè¿‡é‡å¤ç»ƒä¹ æ¥å·©å›ºè®°å¿†çš„å­¦ä¹ æ–¹æ³•ã€‚è¿™ç§ç­–ç•¥å¸®åŠ©å­¦ä¹ è€…åŠ å¼ºè®°å¿†ç—•è¿¹ï¼Œæé«˜ä¿¡æ¯ä¿æŒç‡ã€‚å–„ç”¨å¤è¿°ç­–ç•¥çš„å­¦ä¹ è€…èƒ½å¤Ÿé€šè¿‡æœ‰æ•ˆçš„é‡å¤ç»ƒä¹ æŒæ¡åŸºç¡€çŸ¥è¯†ï¼Œä¸ºè¿›ä¸€æ­¥å­¦ä¹ æ‰“ä¸‹åšå®åŸºç¡€ã€‚'
            },
            detailedProcessingStrategy: {
                id: 'detailedProcessingStrategy',
                label: 'ç²¾ç»†åŠ å·¥ç­–ç•¥',
                description: 'æŒ‡é€šè¿‡æ·±å…¥åˆ†æã€è”æƒ³å’Œæ•´åˆæ¥ç†è§£å’Œè®°å¿†ä¿¡æ¯çš„å­¦ä¹ æ–¹æ³•ã€‚è¿™ç§ç­–ç•¥å¸®åŠ©å­¦ä¹ è€…å»ºç«‹çŸ¥è¯†é—´çš„è”ç³»ï¼Œå½¢æˆæ·±å±‚ç†è§£ã€‚å–„ç”¨ç²¾ç»†åŠ å·¥ç­–ç•¥çš„å­¦ä¹ è€…èƒ½å¤Ÿå°†æ–°çŸ¥è¯†ä¸å·²æœ‰çŸ¥è¯†æœ‰æœºç»“åˆï¼Œæé«˜å­¦ä¹ çš„æ·±åº¦å’Œè´¨é‡ã€‚'
            },
            organizationalStrategy: {
                id: 'organizationalStrategy',
                label: 'ç»„ç»‡ç­–ç•¥',
                description: 'æŒ‡é€šè¿‡åˆ†ç±»ã€å½’çº³ã€æ„å»ºæ¡†æ¶ç­‰æ–¹å¼æ•´ç†å­¦ä¹ ææ–™çš„æ–¹æ³•ã€‚è¿™ç§ç­–ç•¥å¸®åŠ©å­¦ä¹ è€…å½¢æˆç³»ç»ŸåŒ–çš„çŸ¥è¯†ç»“æ„ï¼Œæé«˜å­¦ä¹ æ•ˆç‡ã€‚å–„ç”¨ç»„ç»‡ç­–ç•¥çš„å­¦ä¹ è€…èƒ½å¤Ÿå°†å¤æ‚çš„ä¿¡æ¯æœ‰åºåŒ–ï¼Œä¾¿äºç†è§£å’Œè®°å¿†ã€‚'
            },
            metacognitivePlanning: {
                id: 'metacognitivePlanning',
                label: 'å…ƒè®¤çŸ¥è®¡åˆ’',
                description: 'æŒ‡å¯¹å­¦ä¹ è¿‡ç¨‹è¿›è¡Œé¢„å…ˆè§„åˆ’å’Œè®¾è®¡çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åˆ¶å®šåˆç†çš„å­¦ä¹ ç›®æ ‡å’Œç­–ç•¥ï¼Œæé«˜å­¦ä¹ çš„é’ˆå¯¹æ€§ã€‚å…ƒè®¤çŸ¥è®¡åˆ’èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿæ ¹æ®ä»»åŠ¡ç‰¹ç‚¹å’Œè‡ªèº«æƒ…å†µåˆ¶å®šæœ‰æ•ˆçš„å­¦ä¹ è®¡åˆ’ã€‚'
            },
            metacognitiveMonitoring: {
                id: 'metacognitiveMonitoring',
                label: 'å…ƒè®¤çŸ¥ç›‘æ§',
                description: 'æŒ‡å¯¹å­¦ä¹ è¿‡ç¨‹è¿›è¡Œå®æ—¶ç›‘å¯Ÿå’Œè¯„ä¼°çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åŠæ—¶å‘ç°å­¦ä¹ ä¸­çš„é—®é¢˜ï¼Œè°ƒæ•´å­¦ä¹ ç­–ç•¥ã€‚å…ƒè®¤çŸ¥ç›‘æ§èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿå‡†ç¡®åˆ¤æ–­è‡ªå·±çš„å­¦ä¹ çŠ¶æ€ï¼ŒåŠæ—¶çº æ­£é”™è¯¯ã€‚'
            },
            metacognitiveRegulation: {
                id: 'metacognitiveRegulation',
                label: 'å…ƒè®¤çŸ¥è°ƒèŠ‚',
                description: 'æŒ‡æ ¹æ®å­¦ä¹ æƒ…å†µè°ƒæ•´å­¦ä¹ ç­–ç•¥å’Œæ–¹æ³•çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…ä¼˜åŒ–å­¦ä¹ è¿‡ç¨‹ï¼Œæé«˜å­¦ä¹ æ•ˆæœã€‚å…ƒè®¤çŸ¥è°ƒèŠ‚èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿçµæ´»è¿ç”¨ä¸åŒçš„å­¦ä¹ ç­–ç•¥ï¼Œé€‚åº”å„ç§å­¦ä¹ æƒ…å¢ƒã€‚'
            },
            effortManagement: {
                id: 'effortManagement',
                label: 'åŠªåŠ›ç®¡ç†',
                description: 'æŒ‡åˆç†åˆ†é…å’Œè°ƒèŠ‚å­¦ä¹ åŠªåŠ›ç¨‹åº¦çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨ä¸åŒä»»åŠ¡é—´åˆç†åˆ†é…ç²¾åŠ›ï¼Œä¿æŒæŒç»­çš„å­¦ä¹ åŠ¨åŠ›ã€‚åŠªåŠ›ç®¡ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿåœ¨å›°éš¾é¢å‰åšæŒä¸æ‡ˆï¼ŒåŒæ—¶é¿å…è¿‡åº¦ç–²åŠ³ã€‚'
            },
            timeManagement: {
                id: 'timeManagement',
                label: 'æ—¶é—´ç®¡ç†',
                description: 'æŒ‡æœ‰æ•ˆè§„åˆ’å’Œåˆ©ç”¨å­¦ä¹ æ—¶é—´çš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…æé«˜å­¦ä¹ æ•ˆç‡ï¼Œå¹³è¡¡å„é¡¹å­¦ä¹ ä»»åŠ¡ã€‚æ—¶é—´ç®¡ç†èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿåˆ¶å®šåˆç†çš„æ—¶é—´å®‰æ’ï¼Œé¿å…æ‹–å»¶ï¼Œå……åˆ†åˆ©ç”¨æœ‰é™çš„æ—¶é—´ã€‚'
            },
            externalResourceUtilization: {
                id: 'externalResourceUtilization',
                label: 'å¤–ç•Œèµ„æºåˆ©ç”¨',
                description: 'æŒ‡æœ‰æ•ˆå¯»æ‰¾å’Œåˆ©ç”¨å¤–éƒ¨å­¦ä¹ èµ„æºçš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…æ‰©å±•å­¦ä¹ æ¸ é“ï¼Œè·å¾—æ›´ä¸°å¯Œçš„å­¦ä¹ æ”¯æŒã€‚å–„äºåˆ©ç”¨å¤–ç•Œèµ„æºçš„å­¦ä¹ è€…èƒ½å¤Ÿä¸»åŠ¨å¯»æ±‚å¸®åŠ©ï¼Œå……åˆ†åˆ©ç”¨å›¾ä¹¦é¦†ã€ç½‘ç»œã€åŒä¼´ç­‰å„ç§å­¦ä¹ èµ„æºã€‚'
            },
            // å­¦ä¹ åŠ¨æœº
            growth: {
                id: 'growth',
                label: 'æˆé•¿',
                description: 'æŒ‡è¿½æ±‚ä¸ªäººèƒ½åŠ›æå‡å’Œè‡ªæˆ‘å‘å±•çš„å†…åœ¨åŠ¨æœºã€‚è¿™ç§åŠ¨æœºé©±åŠ¨å­¦ä¹ è€…ä¸æ–­æŒ‘æˆ˜è‡ªå·±ï¼Œè¿½æ±‚è¿›æ­¥ã€‚å…·æœ‰å¼ºçƒˆæˆé•¿åŠ¨æœºçš„å­¦ä¹ è€…å°†å­¦ä¹ è§†ä¸ºè‡ªæˆ‘å®Œå–„çš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿä»æŒ«æŠ˜ä¸­å­¦ä¹ ï¼ŒæŒç»­æå‡è‡ªå·±çš„èƒ½åŠ›ã€‚'
            },
            autonomy: {
                id: 'autonomy',
                label: 'è‡ªä¸»',
                description: 'æŒ‡è¿½æ±‚å­¦ä¹ è‡ªä¸»æƒå’Œç‹¬ç«‹æ€§çš„åŠ¨æœºã€‚è¿™ç§åŠ¨æœºå¸®åŠ©å­¦ä¹ è€…å‘å±•è‡ªä¸»å­¦ä¹ èƒ½åŠ›ï¼ŒåŸ¹å…»ç‹¬ç«‹æ€è€ƒçš„ä¹ æƒ¯ã€‚å…·æœ‰å¼ºçƒˆè‡ªä¸»åŠ¨æœºçš„å­¦ä¹ è€…å–œæ¬¢è‡ªå·±æŒæ§å­¦ä¹ è¿‡ç¨‹ï¼Œèƒ½å¤Ÿä¸»åŠ¨æ¢ç´¢å’Œå‘ç°çŸ¥è¯†ã€‚'
            },
            interaction: {
                id: 'interaction',
                label: 'äº’åŠ¨',
                description: 'æŒ‡é€šè¿‡ä¸ä»–äººäº¤æµåˆä½œæ¥è·å¾—å­¦ä¹ æ»¡è¶³æ„Ÿçš„åŠ¨æœºã€‚è¿™ç§åŠ¨æœºä¿ƒè¿›å­¦ä¹ è€…ç§¯æå‚ä¸ç¾¤ä½“å­¦ä¹ æ´»åŠ¨ï¼Œå‘å±•ç¤¾äº¤æŠ€èƒ½ã€‚å…·æœ‰å¼ºçƒˆäº’åŠ¨åŠ¨æœºçš„å­¦ä¹ è€…å–œæ¬¢è®¨è®ºäº¤æµï¼Œèƒ½å¤Ÿåœ¨åˆä½œä¸­å­¦ä¹ å’Œæˆé•¿ã€‚'
            },
            interest: {
                id: 'interest',
                label: 'å…´è¶£',
                description: 'æŒ‡å¯¹å­¦ä¹ å†…å®¹æœ¬èº«çš„å¥½å¥‡å¿ƒå’Œå–œçˆ±ç¨‹åº¦ã€‚è¿™ç§åŠ¨æœºæ˜¯æœ€æŒä¹…çš„å­¦ä¹ é©±åŠ¨åŠ›ï¼Œèƒ½å¤Ÿç»´æŒé•¿æœŸçš„å­¦ä¹ çƒ­æƒ…ã€‚å…·æœ‰å¼ºçƒˆå…´è¶£åŠ¨æœºçš„å­¦ä¹ è€…å¯¹çŸ¥è¯†å……æ»¡å¥½å¥‡ï¼Œèƒ½å¤Ÿä¸»åŠ¨æ·±å…¥æ¢ç´¢æ„Ÿå…´è¶£çš„é¢†åŸŸã€‚'
            },
            recognition: {
                id: 'recognition',
                label: 'è®¤å¯',
                description: 'æŒ‡å¯»æ±‚ä»–äººè‚¯å®šå’Œèµæ‰¬çš„åŠ¨æœºã€‚è¿™ç§åŠ¨æœºå¸®åŠ©å­¦ä¹ è€…è·å¾—æˆå°±æ„Ÿï¼Œå¢å¼ºå­¦ä¹ ä¿¡å¿ƒã€‚å…·æœ‰å¼ºçƒˆè®¤å¯åŠ¨æœºçš„å­¦ä¹ è€…é‡è§†ä»–äººçš„è¯„ä»·ï¼Œèƒ½å¤Ÿé€šè¿‡è·å¾—è®¤å¯æ¥ç»´æŒå­¦ä¹ åŠ¨åŠ›ã€‚'
            },
            competition: {
                id: 'competition',
                label: 'ç«äº‰',
                description: 'æŒ‡é€šè¿‡ä¸ä»–äººæ¯”è¾ƒæ¥æ¿€å‘å­¦ä¹ åŠ¨åŠ›çš„åŠ¨æœºã€‚è¿™ç§åŠ¨æœºèƒ½å¤Ÿæ¨åŠ¨å­¦ä¹ è€…åŠªåŠ›è¶…è¶Šä»–äººï¼Œè¿½æ±‚å“è¶Šè¡¨ç°ã€‚å…·æœ‰å¼ºçƒˆç«äº‰åŠ¨æœºçš„å­¦ä¹ è€…å–œæ¬¢æŒ‘æˆ˜ï¼Œèƒ½å¤Ÿåœ¨ç«äº‰ä¸­æ¿€å‘æ½œèƒ½ã€‚'
            },
            materialReward: {
                id: 'materialReward',
                label: 'ç‰©è´¨å¥–åŠ±',
                description: 'æŒ‡é€šè¿‡è·å¾—ç‰©è´¨å›æŠ¥æ¥ç»´æŒå­¦ä¹ åŠ¨åŠ›çš„åŠ¨æœºã€‚è¿™ç§åŠ¨æœºèƒ½å¤Ÿæä¾›çŸ­æœŸçš„å­¦ä¹ æ¿€åŠ±ï¼Œä½†éœ€è¦ä¸å†…åœ¨åŠ¨æœºç›¸ç»“åˆã€‚å—ç‰©è´¨å¥–åŠ±åŠ¨æœºé©±åŠ¨çš„å­¦ä¹ è€…èƒ½å¤Ÿä¸ºäº†è·å¾—å¥–åŠ±è€ŒåŠªåŠ›å­¦ä¹ ã€‚'
            },
            // æƒ…ç»ªæ™ºåŠ›
            emotionalAwareness: {
                id: 'emotionalAwareness',
                label: 'æƒ…ç»ªæ„ŸçŸ¥ç†è§£',
                description: 'æŒ‡è¯†åˆ«ã€ç†è§£è‡ªå·±å’Œä»–äººæƒ…ç»ªçš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…æ›´å¥½åœ°ç®¡ç†å­¦ä¹ è¿‡ç¨‹ä¸­çš„æƒ…ç»ªæ³¢åŠ¨ï¼Œå»ºç«‹è‰¯å¥½çš„äººé™…å…³ç³»ã€‚æƒ…ç»ªæ„ŸçŸ¥ç†è§£èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«æƒ…ç»ªä¿¡å·ï¼Œç†è§£æƒ…ç»ªå¯¹å­¦ä¹ çš„å½±å“ã€‚'
            },
            emotionalRegulation: {
                id: 'emotionalRegulation',
                label: 'æƒ…ç»ªè°ƒèŠ‚è¡¨è¾¾',
                description: 'æŒ‡æœ‰æ•ˆç®¡ç†å’Œè¡¨è¾¾æƒ…ç»ªçš„èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›å¸®åŠ©å­¦ä¹ è€…åœ¨å­¦ä¹ ä¸­ä¿æŒç§¯æçš„æƒ…ç»ªçŠ¶æ€ï¼Œåˆç†è¡¨è¾¾è‡ªå·±çš„æ„Ÿå—ã€‚æƒ…ç»ªè°ƒèŠ‚è¡¨è¾¾èƒ½åŠ›å¼ºçš„å­¦ä¹ è€…èƒ½å¤Ÿæ§åˆ¶è´Ÿé¢æƒ…ç»ªï¼Œä¿æŒå­¦ä¹ çš„ç§¯ææ€§å’Œä¸“æ³¨åº¦ã€‚'
            },
            // å­¦ä¹ å“è´¨
            responsibility: {
                id: 'responsibility',
                label: 'è´£ä»»å¿ƒ',
                description: 'æŒ‡å¯¹å­¦ä¹ ä»»åŠ¡å’Œç›®æ ‡æ‰¿æ‹…è´£ä»»çš„å“è´¨ã€‚è¿™ç§å“è´¨å¸®åŠ©å­¦ä¹ è€…è®¤çœŸå¯¹å¾…å­¦ä¹ ï¼Œå±¥è¡Œå­¦ä¹ ä¹‰åŠ¡ã€‚å…·æœ‰å¼ºçƒˆè´£ä»»å¿ƒçš„å­¦ä¹ è€…èƒ½å¤Ÿè‡ªè§‰å®Œæˆå­¦ä¹ ä»»åŠ¡ï¼Œå¯¹è‡ªå·±çš„å­¦ä¹ æˆæœè´Ÿè´£ã€‚'
            },
            seriousness: {
                id: 'seriousness',
                label: 'ä¸¥è°¨æ€§',
                description: 'æŒ‡åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä¿æŒä¸¥æ ¼ã€ç»†è‡´æ€åº¦çš„å“è´¨ã€‚è¿™ç§å“è´¨å¸®åŠ©å­¦ä¹ è€…é¿å…ç²—å¿ƒé”™è¯¯ï¼Œæé«˜å­¦ä¹ è´¨é‡ã€‚å…·æœ‰ä¸¥è°¨æ€§çš„å­¦ä¹ è€…æ³¨é‡ç»†èŠ‚ï¼Œèƒ½å¤Ÿè¿›è¡Œæ·±å…¥ç»†è‡´çš„æ€è€ƒå’Œåˆ†æã€‚'
            },
            perseverance: {
                id: 'perseverance',
                label: 'åšæ¯…æ€§',
                description: 'æŒ‡é¢å¯¹å›°éš¾å’ŒæŒ«æŠ˜æ—¶åšæŒä¸æ‡ˆçš„å“è´¨ã€‚è¿™ç§å“è´¨å¸®åŠ©å­¦ä¹ è€…å…‹æœå­¦ä¹ ä¸­çš„éšœç¢ï¼Œå®ç°é•¿æœŸç›®æ ‡ã€‚å…·æœ‰åšæ¯…æ€§çš„å­¦ä¹ è€…èƒ½å¤Ÿåœ¨å›°éš¾é¢å‰ä¸è½»æ˜“æ”¾å¼ƒï¼Œé€šè¿‡æŒç»­åŠªåŠ›è¾¾æˆç›®æ ‡ã€‚'
            },
            creativity: {
                id: 'creativity',
                label: 'åˆ›æ–°æ€§',
                description: 'æŒ‡äº§ç”Ÿæ–°é¢–ã€ç‹¬ç‰¹æƒ³æ³•å’Œè§£å†³æ–¹æ¡ˆçš„å“è´¨ã€‚è¿™ç§å“è´¨å¸®åŠ©å­¦ä¹ è€…çªç ´å¸¸è§„æ€ç»´ï¼Œå‘ç°æ–°çš„å­¦ä¹ æ–¹æ³•å’ŒçŸ¥è¯†è”ç³»ã€‚å…·æœ‰åˆ›æ–°æ€§çš„å­¦ä¹ è€…å–„äºç‹¬ç«‹æ€è€ƒï¼Œèƒ½å¤Ÿæå‡ºåŸåˆ›æ€§çš„è§è§£å’Œè§£å†³æ–¹æ¡ˆã€‚'
            }
        };

        function OnClickProfileItem(abilityId) {
            const config = abilityConfig[abilityId];
            if (config) {
                // è·å–å¯¹åº”çš„gameä¿¡æ¯
                const fieldData = profileData[abilityId];
                const gameInfo = fieldData && fieldData.game ? fieldData.game : null;
                showAbilityModal(config, gameInfo);
            }
        }
        
        // æ˜¾ç¤ºèƒ½åŠ›è¯¦æƒ…å¼¹æ¡†
        function showAbilityModal(config, gameInfo = null) {
            const modal = document.getElementById('abilityModal');
            const modalAbilityName = document.getElementById('modalAbilityName');
            const modalAbilityDescription = document.getElementById('modalAbilityDescription');
            const gameInfoDiv = document.getElementById('gameInfo');
            const modalGameName = document.getElementById('modalGameName');
            
            modalAbilityName.textContent = config.label;
            modalAbilityDescription.textContent = config.description;
            
            // å¤„ç†gameä¿¡æ¯
            if (gameInfo && gameInfo.game_name) {
                try {
                    // è§£ç åå†ç¼–ç ï¼Œç¡®ä¿ä¸€è‡´æ€§
                    const decodedGameName = decodeURIComponent(escape(atob(gameInfo.game_name)));

                    modalGameName.textContent = decodedGameName;
                    
                    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    modalGameName.onclick = function() {
                        // å…³é—­modal
                        closeAbilityModal();
                        
                        // å‘é€postMessage
                        window.parent.postMessage({
                            type: 'gameNameClicked',
                            gameInfo: {...gameInfo, decodeName: decodedGameName}
                        }, '*');
                    };
                    
                    gameInfoDiv.style.display = 'block';
                } catch (e) {
                    console.error('Base64è§£ç å¤±è´¥:', e);
                    gameInfoDiv.style.display = 'none';
                }
            } else {
                gameInfoDiv.style.display = 'none';
            }
            
            modal.classList.add('show');
            modal.style.display = 'flex';
            
        }
        
        // å…³é—­èƒ½åŠ›è¯¦æƒ…å¼¹æ¡†
        function closeAbilityModal() {
            const modal = document.getElementById('abilityModal');
            modal.classList.remove('show');
            modal.style.display = 'none';
        
        }
        
        // ç‚¹å‡»èƒŒæ™¯å…³é—­å¼¹æ¡†
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('abilityModal');
            if (event.target === modal) {
                closeAbilityModal();
            }
        });
        
        // ESCé”®å…³é—­å¼¹æ¡†
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAbilityModal();
            }
        });
        
        // åˆå§‹åŒ–èƒ½åŠ›é¡¹ç‚¹å‡»äº‹ä»¶
        function initAbilityItemEvents() {
            const abilityItems = document.querySelectorAll('.ability-item');
            abilityItems.forEach(item => {
                const abilityValueElement = item.querySelector('.ability-value');
                if (abilityValueElement && abilityValueElement.id) {
                    const abilityId = abilityValueElement.id;
                    item.addEventListener('click', function() {
                        OnClickProfileItem(abilityId);
                    });
                    
                    // æ·»åŠ è§†è§‰åé¦ˆ
                    item.style.cursor = 'pointer';
                }
            });
        }
        
        // è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰
        function addTouchEvents() {
            const abilityItems = document.querySelectorAll('.ability-item');
            const sectionHeaders = document.querySelectorAll('.section-header');
            
            // ä¸ºèƒ½åŠ›é¡¹æ·»åŠ è§¦æ‘¸äº‹ä»¶
            abilityItems.forEach(item => {
                let touchStartTime = 0;
                
                item.addEventListener('touchstart', function(e) {
                    touchStartTime = Date.now();
                    this.style.backgroundColor = '#e3f2fd';
                    this.style.transform = 'scale(0.98)';
                    
                    // æ·»åŠ è§¦è§‰åé¦ˆï¼ˆå¦‚æœæ”¯æŒï¼‰
                    if (navigator.vibrate) {
                        navigator.vibrate(10);
                    }
                }, { passive: true });
                
                item.addEventListener('touchend', function(e) {
                    const touchDuration = Date.now() - touchStartTime;
                    const delay = touchDuration < 100 ? 150 : 50;
                    
                    setTimeout(() => {
                        this.style.backgroundColor = 'white';
                        this.style.transform = '';
                    }, delay);
                }, { passive: true });
                
                item.addEventListener('touchcancel', function(e) {
                    this.style.backgroundColor = 'white';
                    this.style.transform = '';
                }, { passive: true });
            });
            
            // ä¸ºèŠ‚æ ‡é¢˜æ·»åŠ è§¦æ‘¸äº‹ä»¶
            sectionHeaders.forEach(header => {
                header.addEventListener('touchstart', function(e) {
                    this.style.transform = 'translateY(-1px) scale(0.99)';
                }, { passive: true });
                
                header.addEventListener('touchend', function(e) {
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 100);
                }, { passive: true });
            });
        }
        
        // åŠ¨æ€è°ƒæ•´å¸ƒå±€ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰
        function adjustLayout() {
            const elements = window.cachedElements || {
                container: document.getElementById('profileContainer'),
                content: document.querySelector('.content'),
                leftPanel: document.querySelector('.left-panel'),
                rightPanel: document.querySelector('.right-panel'),
                radarContainer: document.querySelector('.radar-container')
            };
            
            const screenSize = getScreenSize();
            
            // æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´å¸ƒå±€
            if (screenSize.width < 768) {
                elements.content.style.flexDirection = 'column';
                elements.leftPanel.style.width = '100%';
                elements.rightPanel.style.width = '100%';
            } else {
                elements.content.style.flexDirection = 'row';
                elements.leftPanel.style.width = '';
                elements.rightPanel.style.width = '';
            }
            
            // è°ƒæ•´é›·è¾¾å›¾å¤§å°å¹¶é‡æ–°ä¼˜åŒ–Canvasåˆ†è¾¨ç‡
            if (elements.radarContainer && radarChart) {
                // ä½¿ç”¨ requestAnimationFrame ä¼˜åŒ–æ€§èƒ½
                requestAnimationFrame(() => {
                    const canvas = document.getElementById('radarChart');
                    if (canvas) {
                        // é‡æ–°ä¼˜åŒ–Canvasé«˜DPIæ˜¾ç¤º
                        optimizeCanvasForHighDPI(canvas);
                        // è°ƒæ•´å›¾è¡¨å¤§å°
                        radarChart.resize();
                        // å¼ºåˆ¶é‡ç»˜ä»¥ç¡®ä¿æ¸…æ™°åº¦
                        radarChart.update('none');
                    }
                });
            }
        }
        
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });
        
        // ä¼˜åŒ–Canvasé«˜DPIæ˜¾ç¤º
        function optimizeCanvasForHighDPI(canvas) {
            const ctx = canvas.getContext('2d');
            const devicePixelRatio = window.devicePixelRatio || 1;
            const backingStoreRatio = ctx.webkitBackingStorePixelRatio ||
                                    ctx.mozBackingStorePixelRatio ||
                                    ctx.msBackingStorePixelRatio ||
                                    ctx.oBackingStorePixelRatio ||
                                    ctx.backingStorePixelRatio || 1;
            
            const ratio = devicePixelRatio / backingStoreRatio;
            
            if (devicePixelRatio !== backingStoreRatio) {
                const oldWidth = canvas.width;
                const oldHeight = canvas.height;
                
                canvas.width = oldWidth * ratio;
                canvas.height = oldHeight * ratio;
                
                canvas.style.width = oldWidth + 'px';
                canvas.style.height = oldHeight + 'px';
                
                ctx.scale(ratio, ratio);
            }
            
            return ratio;
        }
        
        function initRadarChart() {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            
            // ä¼˜åŒ–Canvasé«˜DPIæ˜¾ç¤º
            // const pixelRatio = optimizeCanvasForHighDPI(canvas);
            const pixelRatio = 1
            
            // è®¾ç½®CanvasæŠ—é”¯é½¿
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['è®¤çŸ¥èƒ½åŠ›', 'å­¦ä¹ ç­–ç•¥', 'å­¦ä¹ åŠ¨æœº', 'æƒ…ç»ªæ™ºåŠ›', 'å­¦ä¹ å“è´¨'],
                    datasets: [{
                        label: '60åˆ†åŸºå‡†çº¿',
                        data: [60, 60, 60, 60, 60],
                        backgroundColor: 'transparent',
                        borderColor: '#ffcc00',
                        borderWidth: 2 * pixelRatio,
                        borderDash: [5 * pixelRatio, 5 * pixelRatio],
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }, {
                        label: '90åˆ†åŸºå‡†çº¿',
                        data: [90, 90, 90, 90, 90],
                        backgroundColor: 'transparent',
                        borderColor: '#00cc00',
                        borderWidth: 2 * pixelRatio,
                        borderDash: [5 * pixelRatio, 5 * pixelRatio],
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }, {
                        label: 'æˆ‘çš„èƒ½åŠ›',
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(116, 185, 255, 0.2)',
                        borderColor: 'rgba(116, 185, 255, 1)',
                        borderWidth: 2 * pixelRatio,
                        pointBackgroundColor: 'rgba(116, 185, 255, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(116, 185, 255, 1)',
                        pointRadius: 4 * pixelRatio,
                        pointHoverRadius: 6 * pixelRatio
                    }]
                },
                options: {
                    responsive: true,
                    devicePixelRatio: window.devicePixelRatio || 1,
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: Math.max(10 * pixelRatio, 10)
                                },
                                padding: 10 * pixelRatio,
                                usePointStyle: true
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                font: {
                                    size: Math.max(10 * pixelRatio, 10)
                                },
                                backdropPadding: 2 * pixelRatio
                            },
                            pointLabels: {
                                font: {
                                    size: Math.max((isMobile ? 10 : 11) * pixelRatio, isMobile ? 10 : 11),
                                    family: 'Arial, sans-serif'
                                },
                                padding: (isMobile ? 15 : 20) * pixelRatio,
                                color: '#333'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)',
                                lineWidth: 1 * pixelRatio
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)',
                                lineWidth: 1 * pixelRatio
                            }
                        }
                    },
                }
            });
            
            // å­˜å‚¨pixelRatioä¾›åç»­ä½¿ç”¨
            window.canvasPixelRatio = pixelRatio;
        }
        
        function updateUserInfo(data) {
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            const fields = ['nickName', 'userName'];
            fields.forEach(field => {
                const element = document.querySelector(`.${field}`);
                if (element) {
                    const value = data[field];
                    if (value !== undefined && value !== null && value !== '') {
                        if (field == 'nickName'){
                            element.textContent = 'ç”¨æˆ·æ˜µç§°ï¼š' + decodeURIComponent(escape(atob(value)));
                        }else if(field == 'userName'){
                            element.textContent = 'è´¦å·ï¼š' + value;
                        }
                    } else {
                        element.textContent = '-';
                    }
                }
            });
        }

        function updateProfile(data) {
            // æ›´æ–°å„é¡¹èƒ½åŠ›å€¼
            const fields = [
                'focusedAttention', 'selectiveAttention', 'shiftingAttention', 'distributedAttention',
                'visualMemory', 'auditoryMemory', 'workingMemory',
                'inductiveReasoning', 'deductiveReasoning', 'analogicalReasoning', 
                'verbalComprehension', 'abstractReasoning', 'visualSpatialIntelligence',
                'elaborationStrategy', 'detailedProcessingStrategy', 'organizationalStrategy',
                'metacognitivePlanning', 'metacognitiveMonitoring', 'metacognitiveRegulation',
                'effortManagement', 'timeManagement', 'externalResourceUtilization',
                'growth', 'autonomy', 'interaction', 'interest', 'recognition', 'competition', 'materialReward',
                'emotionalAwareness', 'emotionalRegulation',
                'responsibility', 'seriousness', 'perseverance', 'creativity'
            ];
           
            fields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    const fieldData = data[field];
                    if (fieldData && typeof fieldData === 'object') {
                        // æ–°æ•°æ®æ ¼å¼ï¼šåŒ…å«scoreå’Œtest_score
                        const score = fieldData.score;
                        const testScore = fieldData.test_score;
                        if (score !== undefined && score !== null && score !== '' && score !== '0' && score !== 0) {
                            if(score !== testScore){
                                element.innerHTML = `${score}<span style="color: #888; font-size: 0.9em;">(${testScore})</span>`;
                            }else{
                                element.textContent = `${score}`;
                            }
                            element.classList.remove('empty');
                            
                            // æ›´æ–°emojiå›¾æ ‡
                            updateEmojiForAbility(field, Number(score));
                        } else {
                            element.textContent = '-';
                            element.classList.add('empty');
                            
                            // æ¸…ç©ºemoji
                            updateEmojiForAbility(field, null);
                        }
                    } else {
                        // å…¼å®¹æ—§æ•°æ®æ ¼å¼
                        const value = fieldData;
                        if (value !== undefined && value !== null && value !== '' && value !== '0' && value !== 0) {
                            element.textContent = value;
                            element.classList.remove('empty');
                            
                            // æ›´æ–°emojiå›¾æ ‡
                            updateEmojiForAbility(field, Number(value));
                        } else {
                            element.textContent = '-';
                            element.classList.add('empty');
                            
                            // æ¸…ç©ºemoji
                            updateEmojiForAbility(field, null);
                        }
                    }
                }
            });
            
            // æ›´æ–°é›·è¾¾å›¾
            updateRadarChart(data);
        }
        
        function updateEmojiForAbility(abilityId, score) {
              const emojiElement = document.querySelector(`#${abilityId}`).parentElement.querySelector('.ability-emoji');
              if (emojiElement) {
                  if (score === null || score === undefined) {
                      emojiElement.innerHTML = '';
                  } else if (score < 60) {
                      emojiElement.innerHTML = '<span style="color: #e74c3c; font-weight: bold; font-size: 14px;">â¬‡</span>'; // çº¢è‰²å‘ä¸‹ç®­å¤´ - å¾…æå‡
                  } else if (score >= 60 && score < 80) {
                      emojiElement.innerHTML = '<span style="color: #f39c12; font-weight: bold; font-size: 14px;">â¡</span>'; // æ©™è‰²å‘å³ç®­å¤´ - è‰¯å¥½
                  } else if (score >= 80) {
                      emojiElement.innerHTML = '<span style="color: #27ae60; font-weight: bold; font-size: 14px;">â¬†</span>'; // ç»¿è‰²å‘ä¸Šç®­å¤´ - ä¼˜å¼‚
                  }
              }
          }
        function updateRadarChart(data) {
            if (!radarChart) return;
            
            // è®¡ç®—å„ç»´åº¦å¹³å‡å€¼
            const cognitiveAvg = calculateAverage(data, [
                'focusedAttention', 'selectiveAttention', 'shiftingAttention', 'distributedAttention',
                'visualMemory', 'auditoryMemory', 'workingMemory',
                'inductiveReasoning', 'deductiveReasoning', 'analogicalReasoning', 
                'verbalComprehension', 'abstractReasoning', 'visualSpatialIntelligence'
            ]);
            
            const strategyAvg = calculateAverage(data, [
                'elaborationStrategy', 'detailedProcessingStrategy', 'organizationalStrategy',
                'metacognitivePlanning', 'metacognitiveMonitoring', 'metacognitiveRegulation',
                'effortManagement', 'timeManagement', 'externalResourceUtilization'
            ]);
            
            const motivationAvg = calculateAverage(data, [
                'growth', 'autonomy', 'interaction', 'interest', 'recognition', 'competition', 'materialReward'
            ]);
            
            const emotionAvg = calculateAverage(data, [
                'emotionalAwareness', 'emotionalRegulation'
            ]);
            
            const qualityAvg = calculateAverage(data, [
                'responsibility', 'seriousness', 'perseverance', 'creativity'
            ]);
            
            radarChart.data.datasets[2].data = [cognitiveAvg, strategyAvg, motivationAvg, emotionAvg, qualityAvg];
            radarChart.update();
        }
        
        function calculateAverage(data, fields) {
            const validValues = fields
                .map(field => data[field])
                .filter(value => value !== undefined && value !== null && value !== '' && !isNaN(value))
                .map(value => Number(value));
            
            if (validValues.length === 0) return 0;
            return Math.round(validValues.reduce((sum, value) => sum + value, 0) / validValues.length);
        }
    </script>
</body>
</html>
