<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>麦思AI测评 - 解锁专属特权</title>
    <script src="https://cdn.keepwork.com/keepwork/cdn/tailwindcss@3.4.16.js"></script>
    <script src="https://cdn.keepwork.com/sdk/keepworkSDK.iife.js"></script>
    <style>
      .gradient-text {
        background: linear-gradient(45deg, #fbbf24, #f59e0b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .qr-container {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 24px;
        padding: 24px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        position: relative;
        overflow: hidden;
      }

      .qr-container::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transform: rotate(45deg);
        animation: shimmer 3s infinite;
      }

      /* 横屏布局样式 */
      .landscape-layout {
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        height: 100vh;
        overflow: hidden;
        justify-content: center;
        align-items: flex-start;
      }

      .qr-code-small {
        background-image: url("https://api.keepwork.com/ts-storage/siteFiles/46418/raw#qrcodemaisiai.jpg");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        width: 180px;
        height: 180px;
        background-color: white;
        border-radius: 12px;
        margin: 0 auto 16px;
      }

      .vip-benefits-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 20px;
      }

      .benefit-card {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
        border-radius: 12px;
        padding: 16px;
        backdrop-filter: blur(10px);
        transition: transform 0.2s ease;
      }

      .benefit-card:hover {
        transform: translateY(-2px);
      }

      .compact-text {
        font-size: 14px;
        line-height: 1.4;
      }

      .header-compact {
        color: white;
        padding: 4px 20px 12px;
        position: sticky;
        top: 0;
        z-index: 50;
      }

      .steps-list {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        padding: 16px;
        margin-top: 16px;
      }

      .step-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        font-size: 15px;
        color: white;
      }

      .step-item:last-child {
        margin-bottom: 0;
      }
    </style>
  </head>

  <body class="bg-gray-100">
    <!-- 横屏布局容器 -->
    <div class="landscape-layout">
      <!-- 水平布局：左侧介绍 + 右侧二维码 -->
      <div class="flex items-start justify-center gap-6 max-w-6xl mx-auto">
        <!-- 左侧：产品介绍 -->
        <div class="text-white flex-1">
          <div class="header-compact text-center">
            <h1 class="text-2xl font-bold mb-2">麦思AI测评：(5-16岁) • 精准诊断学习能力长短板</h1>
          </div>

          <div class="flex gap-4 mb-4 text-center">
            <div class="bg-white/20 rounded-lg p-3 backdrop-blur-sm flex-1">
              <div class="text-3xl font-bold text-yellow-300">8</div>
              <div class="text-sm text-white/90">大维度</div>
            </div>
            <div class="bg-white/20 rounded-lg p-3 backdrop-blur-sm flex-1">
              <div class="text-3xl font-bold text-yellow-300">56</div>
              <div class="text-sm text-white/90">核心能力</div>
            </div>
            <div class="bg-white/20 rounded-lg p-3 backdrop-blur-sm flex-1">
              <div class="text-3xl font-bold text-yellow-300">34</div>
              <div class="text-sm text-white/90">学习素养</div>
            </div>
          </div>

          <div class="flex justify-center items-center gap-4 text-base text-white/90">
            <div class="flex items-center">
              <span class="mr-1">✓</span>
              <span>覆盖全国22个省市及地区</span>
            </div>
            <div class="flex items-center">
              <span class="mr-1">✓</span>
              <span>走进12300余所中小学校</span>
            </div>
            <div class="flex items-center">
              <span class="mr-1">✓</span>
              <span>超过500万学生使用</span>
            </div>
          </div>

          <!-- 产品介绍图片 -->
          <div class="mt-6">
            <img src="https://cdn.keepwork.com/maisi/launcher/launcher03.jpg" 
                 alt="麦思AI学习力测评" 
                 class="w-full h-auto rounded-lg shadow-2xl" />
          </div>
        </div>

        <!-- 右侧：二维码 -->
        <div class="fade-in text-center">
          <p class="text-xl mb-2 text-white font-semibold">微信小程序</p>
          <p class="text-base mb-3 text-white/90">立即扫码使用 麦思AI测评</p>

          <div class="qr-code-small shadow-lg"></div>

          <div class="steps-list text-left">
            <div class="step-item">
              <span class="mr-3">1️⃣</span>
              <span>家长使用微信扫码</span>
            </div>
            <div class="step-item">
              <span class="mr-3">2️⃣</span>
              <span id="bindPhone">绑定手机号</span>
            </div>
          </div>
          <div class="mt-6">
            <button
              onclick="clickVipResult()"
              class="bg-gradient-to-r from-yellow-400 to-yellow-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:from-yellow-500 hover:to-yellow-600 transform hover:scale-105 transition-all duration-200"
            >
              我已开通
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      const sdk = new KeepworkSDK({
        timeout: 30000,
      });
      let userInfo = {};
      let keepworkToken = "";
      const pageName = "maisi_userinfo";

      function clickVipResult() {
        window.parent.postMessage({ type: "vipPayResult" }, "*");
      }

      function updateCellPhone(cellphone) {
        const bindPhone = document.getElementById("bindPhone");
        if (bindPhone) {
          const maskedPhone = cellphone.replace(/(\d{3})\d{4}(\d{4})/, "$1****$2");
          bindPhone.innerHTML = "您的手机号：" + maskedPhone;
        }
      }

      function updateQRCode(qrcodeUrl) {
        const qrCodeContainer = document.querySelector(".qr-code-small");
        if (!qrCodeContainer) {
          console.warn("QR码容器元素未找到");
          return;
        }

        if (qrcodeUrl && qrcodeUrl.trim() !== "") {
          try {
            qrCodeContainer.style.backgroundImage = `url(${qrcodeUrl})`;
            qrCodeContainer.style.display = "block";
          } catch (error) {
            console.error("设置QR码图片失败:", error);
          }
        } else {
          console.log("无有效QR码URL");
        }
      }

      async function getUserQrcodeUrl() {
        const requestData = {};
        const response = await fetch("http://api.keepwork.com/core/v0/maisi/getWxQRCode", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: "Bearer " + keepworkToken,
          },
          body: JSON.stringify(requestData),
        });
        console.log("获取二维码响应:", response);
        const data = await response.json();
        if (data && data.code == 200 && data.data && data.data !== "") {
          const qrcodeUrl = data.data;
          updateQRCode(qrcodeUrl);
        }
      }

      window.addEventListener("message", function (event) {
        if (event.data.type === "miniGameProxyDataResponse") {
          keepworkToken = event.data.keepworkToken;
          maisiToken = event.data.maisiToken;
          if (keepworkToken) {
            sdk.setToken(keepworkToken);
            sdk
              .getUserProfile()
              .then((res) => {
                userInfo = res;
                if (userInfo && userInfo.cellphone) {
                  updateCellPhone(userInfo.cellphone);
                  getUserQrcodeUrl();
                } else {
                  console.log("用户未绑定手机号");
                  sdk.remoteLog.logBehavior(
                    "maisiAI.user.getQRCodeUrl",
                    {
                      userInfo: userInfo,
                    },
                    "maisiAI"
                  );
                }
              })
              .catch((err) => {
                console.log(err);
              });
          }
        }
      });
      window.addEventListener("load", function () {
        window.parent.parent.postMessage({ type: "getMiniGameProxyData" }, "*");
      });
    </script>
  </body>
</html>
