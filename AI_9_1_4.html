<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå®è·µå·¥å…·åˆæ¢ï¼šä»å›¾å½¢åŒ–åˆ°ä»£ç å—/åº“</title>    
    <script src="https://cdn.keepwork.com/keepwork/cdn/tailwindcss@3.4.16.js"></script>    <!-- Load Blockly core -->
    <script src="https://unpkg.com/blockly/blockly_compressed.js"></script>
    <!-- Load the default blocks -->
    <script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
    <!-- Load a generator -->
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <!-- Load a message file -->
    <script src="https://unpkg.com/blockly/msg/zh-hans.js"></script>
    
    <!-- ä»£ç ç¼–è¾‘å™¨å’ŒPythonæ‰§è¡Œç¯å¢ƒ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/hint/python-hint.min.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    
    <!-- CodeMirror æ ·å¼ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/material.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/hint/show-hint.min.css">
    <style>
        .section { display: none; }
        .section.active { display: block; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card-hover { transition: transform 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); }
        .nav-arrow { 
            position: fixed; 
            top: 50%; 
            transform: translateY(-50%); 
            z-index: 40; 
            background: rgba(59, 130, 246, 0.9); 
            color: white; 
            border: none; 
            border-radius: 50%; 
            width: 50px; 
            height: 50px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .nav-arrow:hover { 
            background: rgba(59, 130, 246, 1); 
            transform: translateY(-50%) scale(1.1); 
        }
        .nav-arrow:disabled { 
            background: rgba(156, 163, 175, 0.5); 
            cursor: not-allowed; 
        }
        .nav-arrow.left { left: 20px; }
        .nav-arrow.right { right: 20px; }          /* Blockly å·¥ä½œåŒºæ ·å¼ */
        #blocklyDiv {
            height: 480px;
            width: 100%;
            min-width: 500px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }
        
        /* å“åº”å¼Blocklyå¸ƒå±€ */
        .blockly-container {
            min-width: 500px;
            flex: 1;
        }
        
        .blockly-workspace {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        @media (min-width: 1200px) {
            .blockly-workspace {
                flex-direction: row;
            }
            .blockly-container {
                min-width: 500px;
                max-width: 60%;
            }
            .blockly-results {
                flex: 1;
                min-width: 400px;
            }
        }
        
        .blockly-toolbar {
            background: #f8fafc;
            padding: 10px;
            border-radius: 8px 8px 0 0;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .blockly-output {
            background: #1f2937;
            color: #f9fafb;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 16px;
            border-radius: 8px;
            min-height: 200px;
            white-space: pre-wrap;
            overflow-y: auto;
        }
        
        /* Blocklyå·¥å…·ç®±è‡ªåŠ¨éšè— */
        .blocklyToolboxDiv.toolboxHidden {
            visibility: hidden !important;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        /* Blocklyæ‹–æ‹½çŠ¶æ€æ ·å¼ */
        .blocklyDragging .blocklyToolboxDiv {
            pointer-events: none;
        }
        
        /* æ”¹å–„Blocklyå·¥å…·ç®±å¤–è§‚ */
        .blocklyToolboxDiv {
            background-color: #f8fafc !important;
            border-right: 2px solid #e5e7eb !important;
        }
        
        .blocklyTreeRow {
            padding: 8px 12px !important;
            border-radius: 6px !important;
            margin: 2px 4px !important;
        }
        
        .blocklyTreeRowSelected {
            background-color: #3b82f6 !important;
            color: white !important;
        }
          .visual-program-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        /* ä»£ç ç¼–è¾‘å™¨æ ·å¼ */
        .code-editor-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .code-editor-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 15px 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .code-output {
            background: #1a1a1a;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 16px;
            min-height: 200px;
            white-space: pre-wrap;
            overflow-y: auto;
            border-radius: 0 0 8px 8px;
        }
        
        .code-workspace {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 1024px) {
            .code-workspace {
                grid-template-columns: 1fr;
            }
        }
        
        .code-toolbar {
            background: #f8fafc;
            padding: 12px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .code-examples {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .execution-status {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-ready { background: #e3f2fd; color: #1976d2; }
        .status-running { background: #fff3e0; color: #f57c00; }
        .status-success { background: #e8f5e8; color: #2e7d32; }
        .status-error { background: #ffebee; color: #c62828; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">    <!-- å¯¼èˆªæ  -->
    <nav class="bg-white shadow-md p-4 sticky top-0 z-50">
        <div class="w-full px-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-gray-800">AIå®è·µå·¥å…·åˆæ¢ï¼šä»å›¾å½¢åŒ–åˆ°ä»£ç å—/åº“</h1>
            <div class="flex space-x-2 overflow-x-auto">
                <button onclick="showSection('cover')" class="nav-btn px-3 py-1 rounded-full text-sm bg-blue-500 text-white">å°é¢</button>
                <button onclick="showSection('objectives')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">ç›®æ ‡</button>
                <button onclick="showSection('scenario')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">å¯¼å…¥</button>
                <button onclick="showSection('concepts')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">æ¢ç§˜</button>
                <button onclick="showSection('workshop')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">å·¥åŠ</button>
                <button onclick="showSection('discussion')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">æ€è¾¨</button>
                <button onclick="showSection('summary')" class="nav-btn px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700">æ€»ç»“</button>
            </div>
        </div>
    </nav>

    <!-- å·¦å³å¯¼èˆªæŒ‰é’® -->
    <button id="prevBtn" class="nav-arrow left" onclick="previousSection()" title="ä¸Šä¸€é¡µ">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
    </button>
    <button id="nextBtn" class="nav-arrow right" onclick="nextSection()" title="ä¸‹ä¸€é¡µ">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
        </svg>
    </button>    <!-- å°é¢ -->
    <section id="cover" class="section active fade-in">
        <div class="w-full px-6 py-6 text-center">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-12 rounded-2xl shadow-2xl mb-8">
                <h1 class="text-4xl font-bold mb-4">ğŸ¤– AIå®è·µå·¥å…·åˆæ¢</h1>
                <p class="text-xl mb-6">ä¹å¹´çº§ï¼ˆä¸Šï¼‰ç¬¬4è¯¾</p>
                <p class="text-lg opacity-90">ä»å›¾å½¢åŒ–åˆ°ä»£ç å—/åº“</p>
            </div>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                    <div class="text-4xl mb-4">ğŸ§©</div>
                    <h3 class="font-bold text-lg mb-2">å›¾å½¢åŒ–ç¼–ç¨‹</h3>
                    <p class="text-gray-600">åƒæ­ç§¯æœ¨ä¸€æ ·æ„å»ºAIæ¨¡å‹</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                    <div class="text-4xl mb-4">ğŸ“¦</div>
                    <h3 class="font-bold text-lg mb-2">ä»£ç å—/åº“</h3>
                    <p class="text-gray-600">ä½¿ç”¨é¢„åˆ¶ç»„ä»¶å¿«é€Ÿå¼€å‘</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg card-hover">
                    <div class="text-4xl mb-4">ğŸ’»</div>
                    <h3 class="font-bold text-lg mb-2">çº¯ä»£ç å¼€å‘</h3>
                    <p class="text-gray-600">å®Œå…¨è‡ªä¸»çš„AIç¨‹åºè®¾è®¡</p>
                </div>
            </div>
        </div>
    </section>    <!-- è¯¾ç¨‹ç›®æ ‡ -->
    <section id="objectives" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ“‹ è¯¾ç¨‹ç›®æ ‡</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">é‡ç‚¹ç›®æ ‡</h3>
                        <div class="space-y-3">
                            <div class="flex items-start space-x-3">
                                <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">1</span>
                                <p>ç†Ÿæ‚‰AIå¼€å‘å¹³å°çš„å¸¸ç”¨åŠŸèƒ½</p>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">2</span>
                                <p>æŒæ¡ä½¿ç”¨å·¥å…·è¿›è¡Œç®€å•AIä»»åŠ¡å®è·µ</p>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">3</span>
                                <p>å­¦ä¼šæ•°æ®å¯¼å…¥ã€æ¨¡å‹é€‰æ‹©ä¸è®­ç»ƒ</p>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">éš¾ç‚¹çªç ´</h3>
                        <div class="space-y-3">
                            <div class="flex items-start space-x-3">
                                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">1</span>
                                <p>ç†è§£ä¸åŒå·¥å…·çš„ä½¿ç”¨åœºæ™¯å’Œç‰¹ç‚¹</p>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">2</span>
                                <p>å°†æŠ½è±¡æ¦‚å¿µæ˜ å°„åˆ°å…·ä½“å·¥å…·æ“ä½œ</p>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">3</span>
                                <p>ä»å›¾å½¢åŒ–å‘ä»£ç åº“åº”ç”¨è¿‡æ¸¡</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-8 p-6 bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ç´ å…»ç›®æ ‡</h3>
                    <p class="text-gray-700">åŸ¹å…»ä½¿ç”¨ä¸åŒAIå¼€å‘å·¥å…·è§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ï¼Œå»ºç«‹ä»ç®€å•åˆ°å¤æ‚çš„æŠ€æœ¯å­¦ä¹ è·¯å¾„ï¼Œå½¢æˆå¯¹AIæŠ€æœ¯æ ˆçš„æ•´ä½“è®¤çŸ¥ã€‚</p>
                </div>
            </div>
        </div>
    </section>    <!-- æƒ…æ™¯å¯¼å…¥ -->
    <section id="scenario" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ¬ æƒ…æ™¯å¯¼å…¥</h2>
                <div class="bg-gray-50 p-6 rounded-xl mb-6">
                    <h3 class="text-xl font-bold mb-4 text-center">ğŸ’¡ AIå¼€å‘è€…çš„æˆé•¿ä¹‹è·¯</h3>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <p class="text-gray-700 leading-relaxed mb-4">
                            å°æ˜æ˜¯ä¸€ä¸ªå¯¹AIæŠ€æœ¯å……æ»¡å…´è¶£çš„ä¹å¹´çº§å­¦ç”Ÿã€‚ä»–å¬è¯´AIèƒ½å¤Ÿè¯†åˆ«å›¾ç‰‡ã€ç†è§£è¯­è¨€ã€ç”šè‡³ç©æ¸¸æˆã€‚äºæ˜¯ä»–å¼€å§‹æ€è€ƒï¼š
                            æˆ‘è¦å¦‚ä½•å…¥é—¨AIå¼€å‘å‘¢ï¼Ÿæ˜¯ç›´æ¥å­¦ä¹ å¤æ‚çš„ç¼–ç¨‹è¯­è¨€ï¼Œè¿˜æ˜¯ä»æ›´ç®€å•çš„æ–¹å¼å¼€å§‹ï¼Ÿ
                        </p>
                        <div class="grid md:grid-cols-3 gap-4 mb-4">
                            <div class="text-center p-4 bg-yellow-50 rounded-lg">
                                <div class="text-3xl mb-2">ğŸ§©</div>
                                <h4 class="font-semibold">å›¾å½¢åŒ–ç¼–ç¨‹</h4>
                                <p class="text-sm text-gray-600">æ‹–æ‹½ç»„ä»¶ï¼Œå¯è§†åŒ–æ„å»º</p>
                            </div>
                            <div class="text-center p-4 bg-orange-50 rounded-lg">
                                <div class="text-3xl mb-2">ğŸ“¦</div>
                                <h4 class="font-semibold">ä»£ç å—/åº“</h4>
                                <p class="text-sm text-gray-600">è°ƒç”¨ç°æˆå‡½æ•°ï¼Œå¿«é€Ÿå®ç°</p>
                            </div>
                            <div class="text-center p-4 bg-purple-50 rounded-lg">
                                <div class="text-3xl mb-2">ğŸ’»</div>
                                <h4 class="font-semibold">çº¯ä»£ç å¼€å‘</h4>
                                <p class="text-sm text-gray-600">ä»é›¶å¼€å§‹ï¼Œå®Œå…¨è‡ªä¸»</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-xl">
                    <h4 class="font-bold text-lg mb-3">ğŸ¤” æ€è€ƒé—®é¢˜</h4>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-white p-4 rounded-lg">
                            <p class="font-semibold text-blue-600 mb-2">é—®é¢˜1ï¼š</p>
                            <p class="text-gray-700">å¦‚æœä½ è¦å¼€å‘ä¸€ä¸ªèƒ½è¯†åˆ«çŒ«ç‹—ç…§ç‰‡çš„AIåº”ç”¨ï¼Œä½ ä¼šé€‰æ‹©å“ªç§å¼€å‘æ–¹å¼ï¼Ÿ</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <p class="font-semibold text-blue-600 mb-2">é—®é¢˜2ï¼š</p>
                            <p class="text-gray-700">ä¸åŒçš„å¼€å‘æ–¹å¼å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿé€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯ï¼Ÿ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>    <!-- æ¦‚å¿µæ¢ç§˜ -->
    <section id="concepts" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ” æ¦‚å¿µæ¢ç§˜</h2>
                
                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-center">AIå¼€å‘å¹³å°çš„åˆ†ç±»</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="concept-card bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-xl card-hover cursor-pointer" onclick="toggleDetail('visual-programming')">
                            <div class="text-4xl mb-3 text-center">ğŸ¨</div>
                            <h4 class="font-semibold text-center mb-3">å¯è§†åŒ–ç¼–ç¨‹å¹³å°</h4>
                            <p class="text-sm text-gray-600 text-center">Blocklyã€Scratch for AI</p>
                            <div id="visual-programming" class="hidden mt-4 text-xs text-gray-500 border-t pt-3">
                                ç‰¹ç‚¹ï¼šæ‹–æ‹½å¼æ“ä½œï¼Œæ— éœ€ç¼–ç¨‹åŸºç¡€ï¼Œé€‚åˆåˆå­¦è€…å¿«é€Ÿä¸Šæ‰‹AIæ¦‚å¿µ
                            </div>
                        </div>
                        <div class="concept-card bg-gradient-to-br from-green-50 to-teal-100 p-6 rounded-xl card-hover cursor-pointer" onclick="toggleDetail('api-platform')">
                            <div class="text-4xl mb-3 text-center">ğŸ”§</div>
                            <h4 class="font-semibold text-center mb-3">API/SDKå¹³å°</h4>
                            <p class="text-sm text-gray-600 text-center">TensorFlowã€PyTorch</p>
                            <div id="api-platform" class="hidden mt-4 text-xs text-gray-500 border-t pt-3">
                                ç‰¹ç‚¹ï¼šæä¾›ä»£ç åº“å’ŒAPIï¼Œéœ€è¦ä¸€å®šç¼–ç¨‹åŸºç¡€ï¼ŒåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»
                            </div>
                        </div>
                        <div class="concept-card bg-gradient-to-br from-purple-50 to-pink-100 p-6 rounded-xl card-hover cursor-pointer" onclick="toggleDetail('cloud-platform')">
                            <div class="text-4xl mb-3 text-center">â˜ï¸</div>
                            <h4 class="font-semibold text-center mb-3">äº‘ç«¯AIå¹³å°</h4>
                            <p class="text-sm text-gray-600 text-center">Google Colabã€ç™¾åº¦EasyDL</p>
                            <div id="cloud-platform" class="hidden mt-4 text-xs text-gray-500 border-t pt-3">
                                ç‰¹ç‚¹ï¼šäº‘ç«¯è®¡ç®—èµ„æºï¼Œé›†æˆå¼€å‘ç¯å¢ƒï¼Œé™ä½ç¡¬ä»¶é—¨æ§›
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-xl">
                    <h4 class="font-bold text-xl mb-4">ğŸ¯ å¼€å‘æµç¨‹å¯¹æ¯”</h4>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-semibold text-blue-600 mb-2">å›¾å½¢åŒ–ç¼–ç¨‹</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ æ‹–æ‹½ç»„ä»¶</li>
                                <li>â€¢ å¯è§†åŒ–é…ç½®</li>
                                <li>â€¢ ä¸€é”®è®­ç»ƒ</li>
                                <li>â€¢ å›¾å½¢åŒ–ç»“æœ</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-semibold text-green-600 mb-2">ä»£ç å—/åº“</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ å¯¼å…¥åº“</li>
                                <li>â€¢ è°ƒç”¨å‡½æ•°</li>
                                <li>â€¢ å‚æ•°è®¾ç½®</li>
                                <li>â€¢ è¿è¡Œè°ƒè¯•</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-semibold text-purple-600 mb-2">çº¯ä»£ç å¼€å‘</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ ç®—æ³•è®¾è®¡</li>
                                <li>â€¢ ä»£ç å®ç°</li>
                                <li>â€¢ æ€§èƒ½ä¼˜åŒ–</li>
                                <li>â€¢ å®Œæ•´æµ‹è¯•</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>    <!-- å®è·µå·¥åŠ -->
    <section id="workshop" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ› ï¸ å®è·µå·¥åŠ</h2>
                
                <!-- ä»»åŠ¡åˆ†æéƒ¨åˆ† -->
                <div class="mb-12">
                    <h3 class="text-2xl font-bold mb-6">ğŸ“Š ä»»åŠ¡åˆ†æï¼šçŒ«ç‹—å›¾åƒåˆ†ç±»å®è·µ</h3>
                    <div class="bg-gray-50 p-6 rounded-xl mb-6">
                        <div class="grid md:grid-cols-2 gap-6">                            <div class="bg-white p-6 rounded-lg shadow-sm">
                                <h4 class="font-bold text-lg mb-3 text-blue-600">ğŸ¨ å›¾å½¢åŒ–ç¼–ç¨‹å®è·µ</h4>
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3">
                                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">1</span>
                                        <p class="text-sm">é€‰æ‹©å›¾åƒåˆ†ç±»æ¨¡æ¿</p>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">2</span>
                                        <p class="text-sm">æ‹–æ‹½ä¸Šä¼ è®­ç»ƒæ•°æ®</p>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">3</span>
                                        <p class="text-sm">è°ƒæ•´å‚æ•°å¹¶å¼€å§‹è®­ç»ƒ</p>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">4</span>
                                        <p class="text-sm">æŸ¥çœ‹è®­ç»ƒç»“æœå’Œå‡†ç¡®ç‡</p>
                                    </div>
                                </div>
                                <button class="w-full mt-4 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors" onclick="startTask('visual')">
                                    å¼€å§‹å›¾å½¢åŒ–å®è·µ
                                </button>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm">
                                <h4 class="font-bold text-lg mb-3 text-green-600">ğŸ’» ä»£ç å—å®è·µ</h4>
                                <div class="bg-gray-50 p-3 rounded mb-4">
                                    <pre class="text-xs text-gray-600">
# å¯¼å…¥æ•°æ®å’Œæ¨¡å‹
from ai_toolkit import ImageData, Classifier
data = ImageData('cats_dogs_dataset/')
model = Classifier(type='cnn')

# è®­ç»ƒæ¨¡å‹
model.train(data, epochs=10)
accuracy = model.evaluate()
print(f'å‡†ç¡®ç‡: {accuracy:.2f}')
                                    </pre>
                                </div>
                                <button class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors" onclick="startTask('code')">
                                    å¼€å§‹ä»£ç å®è·µ
                                </button>
                            </div>
                        </div>
                    </div>                </div>

                <!-- å›¾å½¢åŒ–ç¼–ç¨‹å®è·µåŒº -->
                <div class="mb-12" id="visual-programming-area" style="display: none;">
                    <div class="visual-program-card">
                        <h3 class="text-2xl font-bold mb-4 text-center">ğŸ¨ å›¾å½¢åŒ–AIç¼–ç¨‹å·¥åŠ</h3>
                        <p class="text-center mb-6 opacity-90">é€šè¿‡æ‹–æ‹½ä»£ç å—ï¼Œæ„å»ºä½ çš„ç¬¬ä¸€ä¸ªAIå›¾åƒåˆ†ç±»å™¨</p>
                    </div>
                      <div class="blockly-workspace">
                        <!-- Blockly ç¼–ç¨‹åŒºåŸŸ -->
                        <div class="blockly-container bg-white rounded-xl shadow-lg p-4">
                            <div class="blockly-toolbar">
                                <div class="flex justify-between items-center">
                                    <h4 class="font-bold text-gray-700">ğŸ§© å¯è§†åŒ–ç¼–ç¨‹åŒº</h4>                                    <div class="space-x-2">
                                        <button onclick="runBlocklyCode()" class="bg-green-500 text-white px-4 py-2 rounded text-sm hover:bg-green-600 transition-colors">
                                            â–¶ï¸ è¿è¡Œ
                                        </button>
                                        <button onclick="clearWorkspace()" class="bg-red-500 text-white px-4 py-2 rounded text-sm hover:bg-red-600 transition-colors">
                                            ğŸ—‘ï¸ æ¸…ç©º
                                        </button>
                                        <button onclick="loadSample()" class="bg-purple-500 text-white px-4 py-2 rounded text-sm hover:bg-purple-600 transition-colors">
                                            ğŸ“– ç¤ºä¾‹
                                        </button>
                                        <button onclick="debugGeneratorStatus()" class="bg-orange-500 text-white px-4 py-2 rounded text-sm hover:bg-orange-600 transition-colors">
                                            ğŸ”§ è°ƒè¯•
                                        </button>                                        <button onclick="forceReinitAIGenerators()" class="bg-yellow-500 text-white px-4 py-2 rounded text-sm hover:bg-yellow-600 transition-colors">
                                            ğŸ”„ é‡ç½®ç”Ÿæˆå™¨
                                        </button>
                                        <button onclick="fullBlocklyReinit()" class="bg-red-500 text-white px-4 py-2 rounded text-sm hover:bg-red-600 transition-colors">
                                            ğŸ†˜ å®Œå…¨é‡ç½®
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div id="blocklyDiv"></div>
                        </div>
                        
                        <!-- ä»£ç è¾“å‡ºå’Œç»“æœåŒºåŸŸ -->
                        <div class="blockly-results space-y-4">
                            <!-- ç”Ÿæˆçš„ä»£ç  -->
                            <div class="bg-white rounded-xl shadow-lg p-4">
                                <h4 class="font-bold text-gray-700 mb-3">ğŸ“„ ç”Ÿæˆçš„ä»£ç </h4>
                                <div id="generatedCode" class="blockly-output" style="min-height: 150px;">
// åœ¨å·¦ä¾§æ‹–æ‹½ä»£ç å—æ¥ç”ŸæˆAIç¨‹åº
// ç‚¹å‡»"è¿è¡Œ"æŒ‰é’®æŸ¥çœ‹ç»“æœ
                                </div>
                            </div>
                            
                            <!-- è¿è¡Œç»“æœ -->
                            <div class="bg-white rounded-xl shadow-lg p-4">
                                <h4 class="font-bold text-gray-700 mb-3">ğŸ¯ è¿è¡Œç»“æœ</h4>
                                <div id="executionResult" class="blockly-output" style="min-height: 120px;">
ç­‰å¾…ç¨‹åºè¿è¡Œ...
                                </div>
                            </div>
                            
                            <!-- AIè®­ç»ƒè¿›åº¦ -->
                            <div class="bg-white rounded-xl shadow-lg p-4">
                                <h4 class="font-bold text-gray-700 mb-3">ğŸš€ è®­ç»ƒè¿›åº¦</h4>
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm">
                                        <span>è®­ç»ƒè¿›åº¦</span>
                                        <span id="progress-text">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div id="progress-bar" class="bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                    <div id="training-log" class="text-xs text-gray-600 max-h-20 overflow-y-auto">
                                        å‡†å¤‡å¼€å§‹è®­ç»ƒ...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæç¤º -->
                    <div class="mt-6 bg-blue-50 p-4 rounded-xl">
                        <h5 class="font-bold text-blue-800 mb-2">ğŸ’¡ æ“ä½œæç¤º</h5>
                        <div class="grid md:grid-cols-2 gap-4 text-sm text-blue-700">
                            <ul class="space-y-1">
                                <li>â€¢ ä»å·¦ä¾§å·¥å…·ç®±æ‹–æ‹½ä»£ç å—åˆ°ç¼–ç¨‹åŒº</li>
                                <li>â€¢ è¿æ¥ä¸åŒçš„ä»£ç å—æ„å»ºç¨‹åºæµç¨‹</li>
                            </ul>
                            <ul class="space-y-1">
                                <li>â€¢ ç‚¹å‡»"è¿è¡Œ"æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç å’Œç»“æœ</li>
                                <li>â€¢ ä½¿ç”¨"ç¤ºä¾‹"æŒ‰é’®åŠ è½½é¢„è®¾çš„AIç¨‹åº</li>
                            </ul>
                        </div>                    </div>
                </div>

                <!-- ä»£ç å—å®è·µåŒº -->
                <div class="mb-12" id="code-programming-area" style="display: none;">
                    <div class="code-editor-container">
                        <div class="code-editor-header">
                            <h3 class="text-2xl font-bold mb-2">ğŸ’» ä»£ç å—AIç¼–ç¨‹å·¥åŠ</h3>
                            <p class="opacity-90">ä½¿ç”¨Pythonå’ŒAIåº“ï¼Œç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªå›¾åƒåˆ†ç±»ç¨‹åº</p>
                        </div>
                        
                        <div class="code-toolbar">
                            <div class="flex items-center space-x-3">
                                <h4 class="font-bold text-gray-700">ğŸ“ Pythonç¼–è¾‘å™¨</h4>
                                <span id="execution-status" class="execution-status status-ready">â— å‡†å¤‡å°±ç»ª</span>
                            </div>
                            <div class="space-x-2">
                                <button onclick="runPythonCode()" class="bg-green-500 text-white px-4 py-2 rounded text-sm hover:bg-green-600 transition-colors">
                                    â–¶ï¸ è¿è¡Œä»£ç 
                                </button>
                                <button onclick="clearCodeEditor()" class="bg-red-500 text-white px-4 py-2 rounded text-sm hover:bg-red-600 transition-colors">
                                    ğŸ—‘ï¸ æ¸…ç©º
                                </button>
                                <button onclick="loadCodeExample()" class="bg-purple-500 text-white px-4 py-2 rounded text-sm hover:bg-purple-600 transition-colors">
                                    ğŸ“– åŠ è½½ç¤ºä¾‹
                                </button>
                                <button onclick="installPackages()" class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 transition-colors">
                                    ğŸ“¦ å®‰è£…ä¾èµ–
                                </button>
                            </div>
                        </div>
                        
                        <div class="code-workspace">
                            <!-- ä»£ç ç¼–è¾‘å™¨ -->
                            <div>
                                <div class="bg-white">
                                    <textarea id="codeEditor" class="w-full h-96">
# åœ¨è¿™é‡Œç¼–å†™ä½ çš„Pythonä»£ç 
print("Hello, AI!")
                                    </textarea>
                                </div>
                                
                                <!-- ä»£ç ç¤ºä¾‹é€‰æ‹© -->
                                <div class="code-examples">
                                    <h5 class="font-bold text-gray-700 mb-3">ğŸ“š å¿«é€Ÿç¤ºä¾‹</h5>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button onclick="loadExample('basic')" class="text-left p-2 text-sm bg-white rounded border hover:bg-gray-50">
                                            ğŸŒŸ åŸºç¡€åˆ†ç±»å™¨
                                        </button>
                                        <button onclick="loadExample('advanced')" class="text-left p-2 text-sm bg-white rounded border hover:bg-gray-50">
                                            ğŸš€ é«˜çº§æ¨¡å‹
                                        </button>
                                        <button onclick="loadExample('visualization')" class="text-left p-2 text-sm bg-white rounded border hover:bg-gray-50">
                                            ğŸ“Š æ•°æ®å¯è§†åŒ–
                                        </button>
                                        <button onclick="loadExample('deep_learning')" class="text-left p-2 text-sm bg-white rounded border hover:bg-gray-50">
                                            ğŸ§  æ·±åº¦å­¦ä¹ 
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- è¾“å‡ºç»“æœåŒºåŸŸ -->
                            <div class="space-y-4">
                                <!-- ä»£ç è¾“å‡º -->
                                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                                    <div class="bg-gray-100 px-4 py-2 border-b">
                                        <h4 class="font-bold text-gray-700">ğŸ–¥ï¸ ç¨‹åºè¾“å‡º</h4>
                                    </div>
                                    <div id="codeOutput" class="code-output" style="height: 200px;">
ç­‰å¾…ä»£ç è¿è¡Œ...
ä½¿ç”¨ä¸Šæ–¹çš„"è¿è¡Œä»£ç "æŒ‰é’®æ‰§è¡ŒPythonç¨‹åº
                                    </div>
                                </div>
                                
                                <!-- æ‰§è¡ŒçŠ¶æ€å’Œæ€§èƒ½ -->
                                <div class="bg-white rounded-xl shadow-lg p-4">
                                    <h4 class="font-bold text-gray-700 mb-3">ğŸ“ˆ æ‰§è¡Œä¿¡æ¯</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between text-sm">
                                            <span>æ‰§è¡Œæ—¶é—´:</span>
                                            <span id="execution-time">-</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>å†…å­˜ä½¿ç”¨:</span>
                                            <span id="memory-usage">-</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Pythonç‰ˆæœ¬:</span>
                                            <span id="python-version">-</span>
                                        </div>
                                        <div id="error-info" class="hidden mt-3 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-800">
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- AIè®­ç»ƒè¿›åº¦ -->
                                <div class="bg-white rounded-xl shadow-lg p-4">
                                    <h4 class="font-bold text-gray-700 mb-3">ğŸ¤– AIæ‰§è¡Œè¿›åº¦</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between text-sm">
                                            <span>å½“å‰æ­¥éª¤</span>
                                            <span id="current-step">å‡†å¤‡æ‰§è¡Œ</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div id="code-progress-bar" class="bg-gradient-to-r from-green-500 to-blue-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                                        </div>
                                        <div id="step-log" class="text-xs text-gray-600 max-h-24 overflow-y-auto bg-gray-50 p-2 rounded">
å‡†å¤‡è¿è¡ŒAIä»£ç ...
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ä»£ç å®è·µæç¤º -->
                    <div class="mt-6 bg-green-50 p-4 rounded-xl">
                        <h5 class="font-bold text-green-800 mb-2">ğŸ’¡ ä»£ç å®è·µæŒ‡å—</h5>
                        <div class="grid md:grid-cols-2 gap-4 text-sm text-green-700">
                            <ul class="space-y-1">
                                <li>â€¢ ç‚¹å‡»"è¿è¡Œä»£ç "æ‰§è¡ŒPythonç¨‹åº</li>
                                <li>â€¢ ä½¿ç”¨"åŠ è½½ç¤ºä¾‹"å¿«é€Ÿå¼€å§‹</li>
                                <li>â€¢ ä¿®æ”¹ä»£ç å‚æ•°è§‚å¯Ÿç»“æœå˜åŒ–</li>
                            </ul>
                            <ul class="space-y-1">
                                <li>â€¢ æŸ¥çœ‹å³ä¾§è¾“å‡ºäº†è§£ç¨‹åºæ‰§è¡Œè¿‡ç¨‹</li>
                                <li>â€¢ åˆ†æAIæ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ç»“æœ</li>
                                <li>â€¢ å°è¯•ä¸åŒçš„æœºå™¨å­¦ä¹ ç®—æ³•</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- å¯¹æ¯”åˆ†æéƒ¨åˆ† -->
                <div class="mb-12">
                    <h3 class="text-2xl font-bold mb-6">ğŸ” å¯¹æ¯”åˆ†æ</h3>
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl">
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-semibold text-gray-800 mb-3">æ˜“ç”¨æ€§</h5>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>å›¾å½¢åŒ–</span>
                                        <span class="text-green-600">â˜…â˜…â˜…â˜…â˜…</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>ä»£ç å—</span>
                                        <span class="text-orange-600">â˜…â˜…â˜…â˜†â˜†</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-semibold text-gray-800 mb-3">çµæ´»æ€§</h5>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>å›¾å½¢åŒ–</span>
                                        <span class="text-orange-600">â˜…â˜…â˜†â˜†â˜†</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>ä»£ç å—</span>
                                        <span class="text-green-600">â˜…â˜…â˜…â˜…â˜†</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-semibold text-gray-800 mb-3">å­¦ä¹ æˆæœ¬</h5>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>å›¾å½¢åŒ–</span>
                                        <span class="text-green-600">ä½</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>ä»£ç å—</span>
                                        <span class="text-orange-600">ä¸­ç­‰</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å®è·µè®°å½• -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6">ğŸ“ å®è·µè®°å½•</h3>
                    <div class="bg-yellow-50 p-6 rounded-xl">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">é‡åˆ°çš„é—®é¢˜ï¼š</h4>
                                <textarea id="problems" class="w-full p-3 border border-gray-300 rounded-lg text-sm" rows="3" placeholder="è®°å½•å®è·µä¸­é‡åˆ°çš„é—®é¢˜..."></textarea>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">è§£å†³æ–¹æ¡ˆå’Œå¿ƒå¾—ï¼š</h4>
                                <textarea id="solutions" class="w-full p-3 border border-gray-300 rounded-lg text-sm" rows="3" placeholder="è®°å½•è§£å†³æ–¹æ¡ˆå’Œå­¦ä¹ å¿ƒå¾—..."></textarea>
                            </div>
                        </div>
                        <button class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors" onclick="saveRecord()">
                            ä¿å­˜è®°å½•
                        </button>
                    </div>
                </div>

                <div class="text-center">
                    <button class="bg-purple-500 text-white px-8 py-3 rounded-full font-bold hover:bg-purple-600 transition-colors shadow-lg" onclick="showPracticeResult()">
                        å®Œæˆå®è·µä»»åŠ¡
                    </button>
                </div>
                
                <div id="practice-result" class="hidden mt-6 p-6 bg-green-50 rounded-xl border-l-4 border-green-500">
                    <h4 class="font-bold text-lg mb-3">ğŸ‰ å®è·µä»»åŠ¡å®Œæˆï¼</h4>
                    <p class="text-gray-700 mb-4">æ­å–œä½ å®Œæˆäº†AIå·¥å…·çš„åˆæ­¥å®è·µã€‚é€šè¿‡è¿™æ¬¡ä½“éªŒï¼Œä½ å·²ç»äº†è§£äº†ï¼š</p>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>â€¢ å›¾å½¢åŒ–ç¼–ç¨‹çš„ç›´è§‚æ€§å’Œæ˜“ç”¨æ€§</li>
                            <li>â€¢ ä»£ç å—å¼€å‘çš„çµæ´»æ€§å’Œå¯æ§æ€§</li>
                        </ul>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>â€¢ ä¸åŒå·¥å…·çš„é€‚ç”¨åœºæ™¯</li>
                            <li>â€¢ AIå¼€å‘çš„åŸºæœ¬æµç¨‹å’Œæ­¥éª¤</li>
                        </ul>
                    </div>
                    <p class="text-gray-700">æ¥ä¸‹æ¥è®©æˆ‘ä»¬è¿›å…¥æ€è¾¨ç¯èŠ‚ï¼Œæ·±å…¥è®¨è®ºAIå·¥å…·é€‰æ‹©çš„ç­–ç•¥ã€‚</p>
                </div>
            </div>
        </div>
    </section>    <!-- æ€è¾¨å¹¿åœº -->
    <section id="discussion" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ’­ æ€è¾¨å¹¿åœº</h2>
                
                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-center">ğŸ”¥ çƒ­ç‚¹è¾©é¢˜</h3>
                    <div class="bg-gradient-to-r from-red-50 to-pink-50 p-6 rounded-xl mb-6">
                        <h4 class="font-bold text-lg mb-4 text-center">AIå¼€å‘å·¥å…·ï¼šç®€å•ä¼˜å…ˆè¿˜æ˜¯ä¸“ä¸šä¼˜å…ˆï¼Ÿ</h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-semibold text-blue-600 mb-2">è§‚ç‚¹Aï¼šç®€å•ä¼˜å…ˆ</h5>
                                <p class="text-sm text-gray-600 mb-3">åˆå­¦è€…åº”è¯¥ä»å›¾å½¢åŒ–å·¥å…·å¼€å§‹ï¼Œé™ä½å­¦ä¹ é—¨æ§›ï¼Œå…ˆç†è§£AIæ¦‚å¿µå†å­¦ç¼–ç¨‹</p>
                                <button class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 transition-colors" onclick="vote('simple')">
                                    æ”¯æŒ (<span id="simple-votes">0</span>ç¥¨)
                                </button>
                            </div>
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-semibold text-green-600 mb-2">è§‚ç‚¹Bï¼šä¸“ä¸šä¼˜å…ˆ</h5>
                                <p class="text-sm text-gray-600 mb-3">ç›´æ¥å­¦ä¹ ä»£ç ç¼–ç¨‹æ›´æœ‰ä»·å€¼ï¼Œèƒ½å¤ŸæŒæ¡æ ¸å¿ƒæŠ€èƒ½ï¼Œé¿å…è¢«å·¥å…·é™åˆ¶</p>
                                <button class="bg-green-500 text-white px-4 py-2 rounded text-sm hover:bg-green-600 transition-colors" onclick="vote('professional')">
                                    æ”¯æŒ (<span id="professional-votes">0</span>ç¥¨)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6">ğŸ—£ï¸ è§‚ç‚¹äº¤æµ</h3>
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-xl card-hover cursor-pointer" onclick="openDiscussion('tools')">
                            <h4 class="font-semibold text-indigo-800 mb-3">è¯é¢˜1ï¼šå·¥å…·é€‰æ‹©ç­–ç•¥</h4>
                            <p class="text-indigo-700 text-sm mb-4">ä¸åŒé¡¹ç›®ç±»å‹åº”è¯¥å¦‚ä½•é€‰æ‹©åˆé€‚çš„AIå¼€å‘å·¥å…·ï¼Ÿ</p>
                            <div class="flex items-center text-xs text-indigo-600">
                                <span class="mr-2">ğŸ‘¥</span>
                                <span>å‚ä¸è®¨è®º</span>
                            </div>
                        </div>
                        <div class="bg-gradient-to-br from-green-50 to-teal-100 p-6 rounded-xl card-hover cursor-pointer" onclick="openDiscussion('learning')">
                            <h4 class="font-semibold text-teal-800 mb-3">è¯é¢˜2ï¼šå­¦ä¹ è·¯å¾„è®¾è®¡</h4>
                            <p class="text-teal-700 text-sm mb-4">å¦‚ä½•è®¾è®¡ä»é›¶åŸºç¡€åˆ°AIä¸“å®¶çš„å®Œæ•´å­¦ä¹ è·¯å¾„ï¼Ÿ</p>
                            <div class="flex items-center text-xs text-teal-600">
                                <span class="mr-2">ğŸ¯</span>
                                <span>åˆ†äº«è§‚ç‚¹</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-700 mb-3">ğŸ’¬ å‘è¡¨ä½ çš„è§‚ç‚¹</h4>
                        <textarea id="comment-input" class="w-full p-3 border border-gray-300 rounded-lg text-sm" rows="3" placeholder="åˆ†äº«ä½ å¯¹AIå·¥å…·é€‰æ‹©çš„çœ‹æ³•..."></textarea>
                        <button class="mt-2 bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 transition-colors" onclick="addComment()">
                            å‘è¡¨è§‚ç‚¹
                        </button>
                        <div id="comments-section" class="mt-4 space-y-3">
                            <!-- è¯„è®ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-xl">
                    <h4 class="font-bold text-lg mb-4">ğŸ“Š å®æ—¶æŠ•ç¥¨ç»“æœ</h4>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <span class="w-20 text-sm">ç®€å•ä¼˜å…ˆ</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-4 mx-4">
                                <div id="simple-bar" class="bg-blue-500 h-4 rounded-full transition-all duration-500" style="width: 50%"></div>
                            </div>
                            <span id="simple-percent" class="text-sm font-medium">50%</span>
                        </div>
                        <div class="flex items-center">
                            <span class="w-20 text-sm">ä¸“ä¸šä¼˜å…ˆ</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-4 mx-4">
                                <div id="professional-bar" class="bg-green-500 h-4 rounded-full transition-all duration-500" style="width: 50%"></div>
                            </div>
                            <span id="professional-percent" class="text-sm font-medium">50%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>    <!-- è¯¾ç¨‹æ€»ç»“ -->
    <section id="summary" class="section fade-in">
        <div class="w-full px-6 py-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-blue-600">ğŸ“š è¯¾ç¨‹æ€»ç»“</h2>
                
                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-center">ğŸ¯ æ ¸å¿ƒæ”¶è·</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-xl">
                            <h4 class="font-bold text-lg mb-4 text-blue-800">çŸ¥è¯†å±‚é¢</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">ç†è§£äº†AIå¼€å‘å·¥å…·çš„åˆ†ç±»å’Œç‰¹ç‚¹</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">æŒæ¡äº†ä¸åŒå·¥å…·çš„é€‚ç”¨åœºæ™¯</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">äº†è§£äº†AIå¼€å‘çš„åŸºæœ¬æµç¨‹</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-br from-green-50 to-teal-100 p-6 rounded-xl">
                            <h4 class="font-bold text-lg mb-4 text-green-800">èƒ½åŠ›å±‚é¢</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">å…·å¤‡äº†å·¥å…·é€‰æ‹©çš„åˆ¤æ–­èƒ½åŠ›</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">èƒ½å¤Ÿè¿›è¡Œç®€å•çš„AIå®è·µæ“ä½œ</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-sm font-bold">âœ“</span>
                                    <p class="text-sm">åŸ¹å…»äº†æŠ€æœ¯å­¦ä¹ çš„ç³»ç»Ÿæ€ç»´</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-center">ğŸ›£ï¸ å­¦ä¹ è·¯å¾„æ€»ç»“</h3>
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-center">
                                <div class="w-12 h-12 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold mb-2">1</div>
                                <p class="text-sm font-semibold">å›¾å½¢åŒ–å…¥é—¨</p>
                                <p class="text-xs text-gray-600">ç†è§£æ¦‚å¿µ</p>
                            </div>
                            <div class="flex-1 h-1 bg-blue-300 mx-2"></div>
                            <div class="text-center">
                                <div class="w-12 h-12 bg-green-500 text-white rounded-full flex items-center justify-center font-bold mb-2">2</div>
                                <p class="text-sm font-semibold">ä»£ç å—è¿‡æ¸¡</p>
                                <p class="text-xs text-gray-600">å®è·µåº”ç”¨</p>
                            </div>
                            <div class="flex-1 h-1 bg-green-300 mx-2"></div>
                            <div class="text-center">
                                <div class="w-12 h-12 bg-purple-500 text-white rounded-full flex items-center justify-center font-bold mb-2">3</div>
                                <p class="text-sm font-semibold">ä¸“ä¸šå¼€å‘</p>
                                <p class="text-xs text-gray-600">æ·±åº¦æŒæ¡</p>
                            </div>
                        </div>
                        <p class="text-center text-gray-700 text-sm">ä»ç®€å•åˆ°å¤æ‚ï¼Œå¾ªåºæ¸è¿›çš„AIå­¦ä¹ ä¹‹è·¯</p>
                    </div>
                </div>

                <div class="text-center bg-gradient-to-r from-blue-500 to-purple-500 text-white p-8 rounded-xl">
                    <h4 class="font-bold text-xl mb-4">ğŸ‰ æ­å–œå®Œæˆæœ¬è¯¾å­¦ä¹ ï¼</h4>
                    <p class="mb-4">ä½ å·²ç»è¿ˆå‡ºäº†AIå¼€å‘çš„ç¬¬ä¸€æ­¥ï¼ŒæŒæ¡äº†å·¥å…·é€‰æ‹©çš„åŸºæœ¬åŸåˆ™</p>
                    <div class="flex justify-center space-x-4">
                        <button class="bg-white text-blue-600 px-6 py-2 rounded-full font-semibold hover:bg-gray-100 transition-colors" onclick="reviewCourse()">
                            å¤ä¹ æœ¬è¯¾
                        </button>
                    </div>
                </div>
            </div>
        </div>    </section>

    <script>
        let currentSection = 'cover';
        let votes = { simple: 0, professional: 0 };
        const sections = ['cover', 'objectives', 'scenario', 'concepts', 'workshop', 'discussion', 'summary'];
        let currentSectionIndex = 0;

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentSectionIndex === 0;
            nextBtn.disabled = currentSectionIndex === sections.length - 1;
            
            if (prevBtn.disabled) {
                prevBtn.style.opacity = '0.3';
            } else {
                prevBtn.style.opacity = '1';
            }
            
            if (nextBtn.disabled) {
                nextBtn.style.opacity = '0.3';
            } else {
                nextBtn.style.opacity = '1';
            }
        }

        function showSection(sectionId) {
            // éšè—æ‰€æœ‰section
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡section
            document.getElementById(sectionId).classList.add('active');
            
            // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-500', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            // æ‰¾åˆ°å¯¹åº”çš„å¯¼èˆªæŒ‰é’®å¹¶æ›´æ–°çŠ¶æ€
            const navBtn = Array.from(document.querySelectorAll('.nav-btn')).find(btn => 
                btn.getAttribute('onclick').includes(sectionId)
            );
            if (navBtn) {
                navBtn.classList.remove('bg-gray-200', 'text-gray-700');
                navBtn.classList.add('bg-blue-500', 'text-white');
            }
            
            currentSection = sectionId;
            currentSectionIndex = sections.indexOf(sectionId);
            updateNavigationButtons();
        }

        function nextSection() {
            if (currentSectionIndex < sections.length - 1) {
                showSection(sections[currentSectionIndex + 1]);
            }
        }

        function previousSection() {
            if (currentSectionIndex > 0) {
                showSection(sections[currentSectionIndex - 1]);
            }
        }

        function toggleDetail(id) {
            const element = document.getElementById(id);
            element.classList.toggle('hidden');
        }        // é˜²æ­¢é‡å¤ç‚¹å‡»çš„çŠ¶æ€å˜é‡
        let isInitializing = false;
        let lastInitTime = 0;
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€çš„è¾…åŠ©å‡½æ•°
        function updateButtonStatus(buttonText, disabled = false) {
            const buttons = document.querySelectorAll('button[onclick*="startTask"]');
            buttons.forEach(btn => {
                if (btn.textContent.includes('å¼€å§‹å›¾å½¢åŒ–å®è·µ')) {
                    btn.textContent = buttonText;
                    btn.disabled = disabled;
                }
            });
        }
        
        function startTask(taskType) {
            // é˜²æŠ–ï¼šå¦‚æœè·ç¦»ä¸Šæ¬¡åˆå§‹åŒ–ä¸åˆ°2ç§’ï¼Œå¿½ç•¥è¿™æ¬¡è°ƒç”¨
            const now = Date.now();
            if (now - lastInitTime < 2000) {
                console.log('æ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•');
                updateButtonStatus('è¯·ç¨åå†è¯•...', true);
                setTimeout(() => {
                    updateButtonStatus('å¼€å§‹å›¾å½¢åŒ–å®è·µ', false);
                }, 2000 - (now - lastInitTime));
                return;
            }
            
            // å¦‚æœæ­£åœ¨åˆå§‹åŒ–ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨
            if (isInitializing) {
                console.log('æ­£åœ¨åˆå§‹åŒ–ä¸­ï¼Œè¯·ç¨å€™...');
                return;
            }
            
            isInitializing = true;
            lastInitTime = now;
            updateButtonStatus('æ­£åœ¨åˆå§‹åŒ–...', true);
              if (taskType === 'visual') {
                // æ£€æŸ¥Blocklyæ˜¯å¦å·²åŠ è½½
                if (typeof Blockly === 'undefined') {
                    alert('âš ï¸ Blocklyåº“æœªå®Œå…¨åŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                    isInitializing = false;
                    updateButtonStatus('å¼€å§‹å›¾å½¢åŒ–å®è·µ', false);
                    return;
                }
                
                // æ˜¾ç¤ºå›¾å½¢åŒ–ç¼–ç¨‹åŒºåŸŸ
                document.getElementById('visual-programming-area').style.display = 'block';
                document.getElementById('code-programming-area').style.display = 'none';
                
                // ä½¿ç”¨æ–°çš„ç­‰å¾…æœºåˆ¶åˆå§‹åŒ–
                waitForBlocklyReady(() => {
                    try {
                        initBlocklyWorkspace();
                        // æ»šåŠ¨åˆ°ç¼–ç¨‹åŒºåŸŸ
                        document.getElementById('visual-programming-area').scrollIntoView({ behavior: 'smooth' });
                        updateButtonStatus('é‡æ–°åˆå§‹åŒ–', false);
                    } catch (error) {
                        console.error('Blocklyåˆå§‹åŒ–å¤±è´¥:', error);
                        alert('âŒ Blocklyåˆå§‹åŒ–å¤±è´¥: ' + error.message);
                        updateButtonStatus('å¼€å§‹å›¾å½¢åŒ–å®è·µ', false);
                    } finally {
                        isInitializing = false;
                    }
                });
            } else if (taskType === 'code') {
                // æ˜¾ç¤ºä»£ç å—å®è·µåŒºåŸŸ
                document.getElementById('code-programming-area').style.display = 'block';
                document.getElementById('visual-programming-area').style.display = 'none';
                
                // å»¶è¿Ÿåˆå§‹åŒ–ä»¥ç¡®ä¿DOMå‡†å¤‡å°±ç»ª
                setTimeout(() => {
                    try {
                        initCodeEditor();
                        initPyodide();
                        // æ»šåŠ¨åˆ°ç¼–ç¨‹åŒºåŸŸ
                        document.getElementById('code-programming-area').scrollIntoView({ behavior: 'smooth' });
                        updateButtonStatus('é‡æ–°åˆå§‹åŒ–', false);
                    } catch (error) {
                        console.error('ä»£ç ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:', error);
                        alert('âŒ ä»£ç ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥: ' + error.message);
                        updateButtonStatus('å¼€å§‹ä»£ç å®è·µ', false);
                    } finally {
                        isInitializing = false;
                    }
                }, 100);
            } else {
                isInitializing = false;
                updateButtonStatus('å¼€å§‹å›¾å½¢åŒ–å®è·µ', false);
            }
        }

        function saveRecord() {
            const problems = document.getElementById('problems').value;
            const solutions = document.getElementById('solutions').value;
            if (problems || solutions) {
                alert('å®è·µè®°å½•å·²ä¿å­˜ï¼');
            } else {
                alert('è¯·å…ˆå¡«å†™å®è·µè®°å½•å†…å®¹ã€‚');
            }
        }

        function showPracticeResult() {
            document.getElementById('practice-result').classList.remove('hidden');
        }

        function openDiscussion(topic) {
            if (topic === 'tools') {
                alert('å·¥å…·é€‰æ‹©ç­–ç•¥è®¨è®ºå·²æ‰“å¼€ï¼');
            } else if (topic === 'learning') {
                alert('å­¦ä¹ è·¯å¾„è®¾è®¡è®¨è®ºå·²æ‰“å¼€ï¼');
            }
        }

        function vote(side) {
            votes[side]++;
            document.getElementById(side + '-votes').textContent = votes[side];
            updateVoteDisplay();
        }

        function updateVoteDisplay() {
            const total = votes.simple + votes.professional;
            if (total > 0) {
                const simplePercent = Math.round((votes.simple / total) * 100);
                const professionalPercent = Math.round((votes.professional / total) * 100);
                
                document.getElementById('simple-bar').style.width = simplePercent + '%';
                document.getElementById('professional-bar').style.width = professionalPercent + '%';
                document.getElementById('simple-percent').textContent = simplePercent + '%';
                document.getElementById('professional-percent').textContent = professionalPercent + '%';
            }
        }

        function addComment() {
            const input = document.getElementById('comment-input');
            const comment = input.value.trim();
            
            if (comment) {
                const commentsSection = document.getElementById('comments-section');
                const newComment = document.createElement('div');
                newComment.className = 'bg-white p-4 rounded-lg shadow-sm';
                newComment.innerHTML = `
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold">
                            ${String.fromCharCode(65 + Math.floor(Math.random() * 26))}
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-700 text-sm">${comment}</p>
                            <p class="text-xs text-gray-400 mt-1">åˆšåˆš</p>
                        </div>
                    </div>
                `;
                
                commentsSection.insertBefore(newComment, commentsSection.firstChild);
                input.value = '';
            }
        }

        function reviewCourse() {
            showSection('cover');
            alert('å¼€å§‹å¤ä¹ æœ¬è¯¾å†…å®¹ï¼');
        }

        function nextCourse() {
            alert('å³å°†è·³è½¬åˆ°ä¸‹ä¸€è¯¾ç¨‹ï¼šAIé¡¹ç›®å®Œæ•´å¼€å‘æµç¨‹');
        }        // é”®ç›˜å¯¼èˆªæ”¯æŒ        // å…¨å±€é”™è¯¯å¤„ç†ï¼Œç‰¹åˆ«é’ˆå¯¹Blocklyæ‰©å±•å†²çª - ç°ä»£åŒ–ç‰ˆæœ¬
        window.addEventListener('error', function(event) {
            if (event.error && event.error.message) {
                const errorMessage = event.error.message;
                
                // æ£€æŸ¥æ˜¯å¦æ˜¯Blocklyæ‰©å±•æ³¨å†Œå†²çª - æ”¯æŒå¤šç§é”™è¯¯æ¨¡å¼
                const isExtensionConflict = errorMessage.includes('already registered') || 
                    errorMessage.includes('contextMenu_variableDynamicSetterGetter') ||
                    errorMessage.includes('Extension') && errorMessage.includes('registered') ||
                    errorMessage.includes('variable') && errorMessage.includes('extension');
                
                if (isExtensionConflict) {
                    console.warn('æ•è·åˆ°Blocklyæ‰©å±•æ³¨å†Œå†²çªé”™è¯¯:', errorMessage);
                    
                    // ç°ä»£åŒ–è‡ªåŠ¨ä¿®å¤æ–¹æ³•
                    try {
                        if (typeof Blockly !== 'undefined') {
                            console.log('æ‰§è¡Œç°ä»£åŒ–æ‰©å±•å†²çªè‡ªåŠ¨ä¿®å¤...');
                            
                            const problematicExtensions = [
                                'contextMenu_variableDynamicSetterGetter',
                                'contextMenu_variableSetterGetter',
                                'contextMenu_variableReporter',
                                'contextMenu_variableDynamicGetter',
                                'variables_get_dynamic_extension',
                                'variables_set_dynamic_extension'
                            ];
                            
                            // å¤šå±‚æ¸…ç†ç­–ç•¥
                            // 1. æ¸…ç†æ—§ç‰ˆALL_æ³¨å†Œè¡¨
                            if (Blockly.Extensions && Blockly.Extensions.ALL_) {
                                problematicExtensions.forEach(extName => {
                                    if (Blockly.Extensions.ALL_[extName]) {
                                        delete Blockly.Extensions.ALL_[extName];
                                        console.log(`è‡ªåŠ¨æ¸…ç†æ—§ç‰ˆå†²çªæ‰©å±•: ${extName}`);
                                    }
                                });
                            }
                            
                            // 2. æ¸…ç†ç°ä»£ç‰ˆç›´æ¥æ³¨å†Œ
                            if (Blockly.Extensions) {
                                problematicExtensions.forEach(extName => {
                                    if (Blockly.Extensions[extName]) {
                                        delete Blockly.Extensions[extName];
                                        console.log(`è‡ªåŠ¨æ¸…ç†ç°ä»£ç‰ˆå†²çªæ‰©å±•: ${extName}`);
                                    }
                                });
                            }
                            
                            // 3. æ¸…ç†å¯èƒ½çš„å—å®šä¹‰ç¼“å­˜
                            if (Blockly.Blocks) {
                                const blockTypes = ['variables_get_dynamic', 'variables_set_dynamic'];
                                blockTypes.forEach(blockType => {
                                    if (Blockly.Blocks[blockType]) {
                                        console.log(`é‡ç½®å—ç±»å‹æ³¨å†Œ: ${blockType}`);
                                        // ä¿ç•™å—å®šä¹‰ä½†æ¸…é™¤å¯èƒ½çš„æ‰©å±•å…³è”
                                    }
                                });
                            }
                            
                            // 4. å¼ºåˆ¶é‡ç½®å˜é‡ç³»ç»Ÿï¼ˆå¦‚æœéœ€è¦ï¼‰
                            if (Blockly.Variables) {
                                console.log('é‡ç½®å˜é‡ç³»ç»Ÿç¼“å­˜...');
                                // æ¸…é™¤å¯èƒ½çš„ç¼“å­˜ä½†ä¿ç•™æ ¸å¿ƒåŠŸèƒ½
                                if (Blockly.Variables.flyoutCategoryBlocks) {
                                    delete Blockly.Variables.flyoutCategoryBlocks;
                                }
                            }
                        }
                    } catch (cleanupError) {
                        console.log('è‡ªåŠ¨ä¿®å¤è¿‡ç¨‹ä¸­çš„é¢„æœŸé”™è¯¯:', cleanupError.message);
                        // è¿™äº›é”™è¯¯é€šå¸¸æ˜¯é¢„æœŸçš„
                    }
                    
                    const codeElement = document.getElementById('generatedCode');
                    if (codeElement && (codeElement.textContent.includes('è¯·æ‹–æ‹½ä»£ç å—') || 
                        codeElement.textContent.includes('ç­‰å¾…ç¨‹åºè¿è¡Œ'))) {
                        codeElement.textContent = 'âš ï¸ æ£€æµ‹åˆ°Blocklyæ‰©å±•å†²çª\n\nâœ… å·²è‡ªåŠ¨ä¿®å¤ï¼ˆç°ä»£åŒ–æ–¹æ³•ï¼‰\n\nå¦‚é—®é¢˜æŒç»­ï¼š\n1. ç‚¹å‡»"é‡æ–°åˆå§‹åŒ–"æŒ‰é’®\n2. æˆ–åˆ·æ–°é¡µé¢é‡è¯•\n3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜\n\nç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨å›¾å½¢åŒ–ç¼–ç¨‹ã€‚';
                    }
                    
                    // é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­åˆ°æ§åˆ¶å°
                    event.preventDefault();
                    return true;
                }
            }
        });// Blockly ç›¸å…³åŠŸèƒ½
        let workspace = null;
        let blocksInitialized = false;
        let blocklyEverInitialized = false; // æ–°å¢ï¼šè·Ÿè¸ªBlocklyæ˜¯å¦æ›¾ç»è¢«åˆå§‹åŒ–è¿‡// æ£€æŸ¥æ‰€æœ‰Blocklyç»„ä»¶æ˜¯å¦å·²åŠ è½½
        function checkBlocklyDependencies() {
            const dependencies = {
                'Blocklyæ ¸å¿ƒ': typeof Blockly !== 'undefined',
                'Blockly.inject': typeof Blockly !== 'undefined' && typeof Blockly.inject === 'function',
                'Blockly.JavaScript': typeof Blockly !== 'undefined' && typeof Blockly.JavaScript === 'object',
                'Blockly.Blocks': typeof Blockly !== 'undefined' && typeof Blockly.Blocks === 'object',
                'Blockly.Extensions': typeof Blockly !== 'undefined' && typeof Blockly.Extensions === 'object'
            };
            
            const missingDeps = Object.entries(dependencies).filter(([name, loaded]) => !loaded);
            
            if (missingDeps.length > 0) {
                console.log('ç¼ºå¤±çš„Blocklyä¾èµ–:', missingDeps.map(([name]) => name).join(', '));
                return false;
            }
            
            console.log('æ‰€æœ‰Blocklyä¾èµ–å·²åŠ è½½');
            return true;
        }        // ç­‰å¾…Blocklyå®Œå…¨åŠ è½½
        function waitForBlocklyReady(callback, maxAttempts = 50) {
            let attempts = 0;
            
            function checkReady() {
                attempts++;
                
                if (checkBlocklyDependencies()) {
                    console.log(`Blocklyåœ¨ç¬¬${attempts}æ¬¡æ£€æŸ¥åå°±ç»ª`);
                    
                    // å¦‚æœBlocklyæ›¾ç»è¢«åˆå§‹åŒ–è¿‡ï¼Œä¸”å½“å‰æ²¡æœ‰å·¥ä½œåŒºï¼Œåˆ™é‡ç½®æ ‡å¿—
                    if (blocklyEverInitialized && !workspace) {
                        console.log('æ£€æµ‹åˆ°Blocklyå·²ç»è¢«åˆå§‹åŒ–è¿‡ï¼Œé‡ç½®ç›¸å…³æ ‡å¿—');
                        blocksInitialized = false;
                    }
                    
                    callback();
                } else if (attempts >= maxAttempts) {
                    console.error('BlocklyåŠ è½½è¶…æ—¶');
                    const codeElement = document.getElementById('generatedCode');
                    if (codeElement) {
                        codeElement.textContent = 'âŒ Blocklyç»„ä»¶åŠ è½½è¶…æ—¶ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•';
                    }
                } else {
                    console.log(`ç­‰å¾…BlocklyåŠ è½½... (å°è¯• ${attempts}/${maxAttempts})`);
                    setTimeout(checkReady, 100);
                }
            }
            
            checkReady();
        }        
        function safeResetBlockly() {
            try {
                if (workspace) {
                    workspace.dispose();
                    workspace = null;
                }
                // æ¸…é™¤DOMä¸­çš„Blocklyå…ƒç´ 
                const blocklyDiv = document.getElementById('blocklyDiv');
                if (blocklyDiv) {
                    blocklyDiv.innerHTML = '';
                }
                // é‡ç½®åˆå§‹åŒ–æ ‡å¿—
                blocksInitialized = false;
                
                // ç°ä»£åŒ–æ‰©å±•æ¸…ç†æ–¹æ³•
                try {
                    if (typeof Blockly !== 'undefined') {
                        // æ¸…é™¤å¯èƒ½å¯¼è‡´å†²çªçš„æ‰©å±• - æ”¯æŒå¤šç§Blocklyç‰ˆæœ¬
                        const extensionsToCheck = [
                            'contextMenu_variableDynamicSetterGetter',
                            'contextMenu_variableSetterGetter', 
                            'contextMenu_variableReporter',
                            'contextMenu_variableDynamicGetter',
                            'variables_get_dynamic_extension',
                            'variables_set_dynamic_extension'
                        ];
                        
                        // æ¸…é™¤æ—§ç‰ˆæœ¬ALL_æ³¨å†Œè¡¨
                        if (Blockly.Extensions && Blockly.Extensions.ALL_) {
                            extensionsToCheck.forEach(extName => {
                                if (Blockly.Extensions.ALL_[extName]) {
                                    console.log(`æ¸…é™¤æ—§ç‰ˆæ‰©å±•: ${extName}`);
                                    delete Blockly.Extensions.ALL_[extName];
                                }
                            });
                        }
                        
                        // æ¸…é™¤ç°ä»£ç‰ˆæœ¬ç›´æ¥æ³¨å†Œ
                        if (Blockly.Extensions) {
                            extensionsToCheck.forEach(extName => {
                                if (Blockly.Extensions[extName]) {
                                    console.log(`æ¸…é™¤ç°ä»£ç‰ˆæ‰©å±•: ${extName}`);
                                    delete Blockly.Extensions[extName];
                                }
                            });
                        }
                        
                        // æ¸…é™¤å˜é‡ç³»ç»Ÿæ³¨å†Œï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                        if (Blockly.Variables) {
                            console.log('é‡ç½®å˜é‡ç³»ç»Ÿæ³¨å†Œ...');
                            // å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–å˜é‡å·¥å‚
                            if (Blockly.Variables.flyoutCategoryBlocks) {
                                // æ¸…é™¤å¯èƒ½çš„ç¼“å­˜
                                delete Blockly.Variables.flyoutCategoryBlocks;
                            }
                        }
                        
                        // æ¸…é™¤å¯èƒ½çš„å—ç±»å‹ç¼“å­˜
                        if (Blockly.Blocks) {
                            const blocksToCheck = ['variables_get_dynamic', 'variables_set_dynamic'];
                            blocksToCheck.forEach(blockType => {
                                if (Blockly.Blocks[blockType] && Blockly.Blocks[blockType].init) {
                                    console.log(`é‡ç½®å—ç±»å‹: ${blockType}`);
                                    // è®©å—é‡æ–°åˆå§‹åŒ–
                                }
                            });
                        }
                    }
                } catch (extensionError) {
                    console.log('æ‰©å±•æ¸…ç†è¿‡ç¨‹ä¸­çš„é¢„æœŸé”™è¯¯:', extensionError.message);
                    // è¿™äº›é”™è¯¯é€šå¸¸æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ¸…ç†å¯èƒ½ä¸å­˜åœ¨çš„å¯¹è±¡
                }
            } catch (error) {
                console.log('é‡ç½®Blocklyæ—¶å‡ºé”™:', error);
            }
        }// å®šä¹‰AIç›¸å…³çš„è‡ªå®šä¹‰ä»£ç å— - ä½¿ç”¨ç°ä»£åŒ–æ–¹æ³•
        function defineAIBlocks() {
            // é¿å…é‡å¤å®šä¹‰å—
            if (blocksInitialized) {
                console.log('AIå—å·²åˆå§‹åŒ–ï¼Œè·³è¿‡é‡å¤å®šä¹‰');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»å®šä¹‰è¿‡è¿™äº›å—
            if (Blockly.Blocks['ai_load_data']) {
                console.log('AIå—å·²å­˜åœ¨ï¼Œè·³è¿‡å®šä¹‰');
                blocksInitialized = true;
                return;
            }
            
            console.log('å¼€å§‹å®šä¹‰AIè‡ªå®šä¹‰å—...');
            
            // ä½¿ç”¨ç°ä»£åŒ–çš„defineBlocksWithJsonArrayæ–¹æ³•å®šä¹‰å—
            Blockly.common.defineBlocksWithJsonArray([
                // AIæ•°æ®åŠ è½½å—
                {
                    "type": "ai_load_data",
                    "message0": "ğŸ“‚ åŠ è½½æ•°æ®é›† %1",
                    "args0": [
                        {
                            "type": "field_dropdown",
                            "name": "DATASET",
                            "options": [
                                ["çŒ«ç‹—å›¾ç‰‡", "cats_dogs"],
                                ["èŠ±æœµåˆ†ç±»", "flowers"],
                                ["æ‰‹å†™æ•°å­—", "digits"]
                            ]
                        }
                    ],
                    "output": "Dataset",
                    "colour": 120,
                    "tooltip": "åŠ è½½è®­ç»ƒæ•°æ®é›†",
                    "helpUrl": ""
                },
                // AIæ¨¡å‹åˆ›å»ºå—
                {
                    "type": "ai_create_model",
                    "message0": "ğŸ§  åˆ›å»ºAIæ¨¡å‹ %1",
                    "args0": [
                        {
                            "type": "field_dropdown",
                            "name": "MODEL_TYPE",
                            "options": [
                                ["å›¾åƒåˆ†ç±»å™¨", "image_classifier"],
                                ["æ–‡æœ¬åˆ†æå™¨", "text_analyzer"],
                                ["æ•°å­—è¯†åˆ«å™¨", "digit_recognizer"]
                            ]
                        }
                    ],
                    "output": "Model",
                    "colour": 230,
                    "tooltip": "åˆ›å»ºAIæ¨¡å‹",
                    "helpUrl": ""
                },
                // AIæ¨¡å‹è®­ç»ƒå—
                {
                    "type": "ai_train_model",
                    "message0": "ğŸš€ è®­ç»ƒæ¨¡å‹ %1 ä½¿ç”¨æ•°æ® %2 è®­ç»ƒè½®æ•° %3",
                    "args0": [
                        {
                            "type": "input_value",
                            "name": "MODEL",
                            "check": "Model"
                        },
                        {
                            "type": "input_value",
                            "name": "DATA",
                            "check": "Dataset"
                        },
                        {
                            "type": "field_number",
                            "name": "EPOCHS",
                            "value": 10,
                            "min": 1,
                            "max": 100
                        }
                    ],
                    "previousStatement": null,
                    "nextStatement": null,
                    "colour": 290,
                    "tooltip": "è®­ç»ƒAIæ¨¡å‹",
                    "helpUrl": ""
                },
                // AIé¢„æµ‹å—
                {
                    "type": "ai_predict",
                    "message0": "ğŸ” ä½¿ç”¨æ¨¡å‹ %1 é¢„æµ‹å›¾ç‰‡ %2",
                    "args0": [
                        {
                            "type": "input_value",
                            "name": "MODEL",
                            "check": "Model"
                        },
                        {
                            "type": "field_dropdown",
                            "name": "IMAGE",
                            "options": [
                                ["çŒ«", "cat.jpg"],
                                ["ç‹—", "dog.jpg"],
                                ["è‡ªå®šä¹‰", "custom.jpg"]
                            ]
                        }
                    ],
                    "output": "String",
                    "colour": 65,
                    "tooltip": "ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹",
                    "helpUrl": ""
                },
                // AIç»“æœæ˜¾ç¤ºå—
                {
                    "type": "ai_show_result",
                    "message0": "ğŸ“Š æ˜¾ç¤ºé¢„æµ‹ç»“æœ %1",
                    "args0": [
                        {
                            "type": "input_value",
                            "name": "RESULT",
                            "check": "String"
                        }
                    ],
                    "previousStatement": null,
                    "nextStatement": null,
                    "colour": 160,
                    "tooltip": "æ˜¾ç¤ºAIé¢„æµ‹ç»“æœ",
                    "helpUrl": ""
                }
            ]);
            
            blocksInitialized = true;
            console.log('AIè‡ªå®šä¹‰å—å®šä¹‰å®Œæˆï¼ˆä½¿ç”¨ç°ä»£åŒ–æ–¹æ³•ï¼‰');
        }        // å®šä¹‰ä»£ç ç”Ÿæˆå™¨ - å…¼å®¹å¤šç‰ˆæœ¬Blockly
        function defineAIGenerators() {
            console.log('å¼€å§‹å®šä¹‰AIä»£ç ç”Ÿæˆå™¨...');
            
            // è·å–JavaScriptç”Ÿæˆå™¨çš„å¼•ç”¨ï¼ˆå…¼å®¹ä¸åŒç‰ˆæœ¬ï¼‰
            let generator = null;
            
            if (typeof Blockly.JavaScript !== 'undefined') {
                generator = Blockly.JavaScript;
            } else if (typeof Blockly.javascriptGenerator !== 'undefined') {
                generator = Blockly.javascriptGenerator;
            } else if (typeof javascriptGenerator !== 'undefined') {
                generator = javascriptGenerator;
            }
            
            if (!generator) {
                console.error('JavaScriptç”Ÿæˆå™¨ä¸å¯ç”¨');
                // å°è¯•åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ç”Ÿæˆå™¨
                try {
                    if (typeof Blockly.Generator !== 'undefined') {
                        generator = new Blockly.Generator('JavaScript');
                        generator.ORDER_ATOMIC = 0;
                        generator.ORDER_FUNCTION_CALL = 1;
                        Blockly.JavaScript = generator;
                    }
                } catch (e) {
                    console.error('æ— æ³•åˆ›å»ºJavaScriptç”Ÿæˆå™¨:', e);
                    return false;
                }
            }
            
            try {
                // æ¸…é™¤ç°æœ‰çš„ç”Ÿæˆå™¨ä»¥é¿å…å†²çª
                const generatorNames = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                generatorNames.forEach(name => {
                    if (generator[name]) {
                        delete generator[name];
                    }
                });
                
                // ç¡®ä¿ORDERå¸¸é‡å­˜åœ¨
                if (!generator.ORDER_ATOMIC) generator.ORDER_ATOMIC = 0;
                if (!generator.ORDER_FUNCTION_CALL) generator.ORDER_FUNCTION_CALL = 1;
                
                // å®šä¹‰ä»£ç ç”Ÿæˆå™¨å‡½æ•°
                generator['ai_load_data'] = function(block) {
                    var dataset = block.getFieldValue('DATASET');
                    var code = `loadDataset('${dataset}')`;
                    return [code, generator.ORDER_FUNCTION_CALL];
                };

                generator['ai_create_model'] = function(block) {
                    var modelType = block.getFieldValue('MODEL_TYPE');
                    var code = `createModel('${modelType}')`;
                    return [code, generator.ORDER_FUNCTION_CALL];
                };

                generator['ai_train_model'] = function(block) {
                    var model = generator.valueToCode(block, 'MODEL', generator.ORDER_ATOMIC) || 'null';
                    var data = generator.valueToCode(block, 'DATA', generator.ORDER_ATOMIC) || 'null';
                    var epochs = block.getFieldValue('EPOCHS') || '10';
                    
                    var code = `trainModel(${model}, ${data}, ${epochs});\n`;
                    return code;
                };

                generator['ai_predict'] = function(block) {
                    var model = generator.valueToCode(block, 'MODEL', generator.ORDER_ATOMIC) || 'null';
                    var image = block.getFieldValue('IMAGE');
                    
                    var code = `predict(${model}, '${image}')`;
                    return [code, generator.ORDER_FUNCTION_CALL];
                };

                generator['ai_show_result'] = function(block) {
                    var result = generator.valueToCode(block, 'RESULT', generator.ORDER_ATOMIC) || 'null';
                    
                    var code = `showResult(${result});\n`;
                    return code;
                };
                
                console.log('AIä»£ç ç”Ÿæˆå™¨å®šä¹‰å®Œæˆï¼ˆå…¼å®¹ç‰ˆï¼‰');
                
                // éªŒè¯æ‰€æœ‰ç”Ÿæˆå™¨æ˜¯å¦æˆåŠŸå®šä¹‰
                const successfullyDefined = generatorNames.filter(name => !!generator[name]);
                console.log(`æˆåŠŸå®šä¹‰çš„ç”Ÿæˆå™¨: ${successfullyDefined.join(', ')}`);
                
                // ç¡®ä¿Blockly.JavaScriptå¼•ç”¨æ­£ç¡®
                if (!Blockly.JavaScript && generator) {
                    Blockly.JavaScript = generator;
                }
                
                return successfullyDefined.length === generatorNames.length;
                
            } catch (error) {
                console.error('å®šä¹‰AIä»£ç ç”Ÿæˆå™¨æ—¶å‡ºé”™:', error);
                return false;
            }
        }// éªŒè¯AIä»£ç ç”Ÿæˆå™¨æ˜¯å¦æ­£ç¡®å®šä¹‰
        function validateAIGenerators() {
            const requiredGenerators = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
            const missingGenerators = [];
            
            // è·å–æ­£ç¡®çš„ç”Ÿæˆå™¨å¼•ç”¨
            let generator = null;
            if (typeof Blockly.JavaScript !== 'undefined') {
                generator = Blockly.JavaScript;
            } else if (typeof Blockly.javascriptGenerator !== 'undefined') {
                generator = Blockly.javascriptGenerator;
            } else if (typeof javascriptGenerator !== 'undefined') {
                generator = javascriptGenerator;
            }
            
            if (!generator) {
                console.warn('æ— æ³•æ‰¾åˆ°JavaScriptç”Ÿæˆå™¨');
                return false;
            }
            
            // æ£€æŸ¥ç”Ÿæˆå™¨æ˜¯å¦å®šä¹‰
            for (let generatorName of requiredGenerators) {
                if (!generator[generatorName]) {
                    missingGenerators.push(generatorName);
                }
            }
            
            if (missingGenerators.length > 0) {
                console.warn('ç¼ºå¤±çš„ä»£ç ç”Ÿæˆå™¨:', missingGenerators);
                return false;
            }
              console.log('æ‰€æœ‰AIä»£ç ç”Ÿæˆå™¨éªŒè¯é€šè¿‡');
            return true;}        // è°ƒè¯•å‡½æ•°ï¼šæ£€æŸ¥ä»£ç ç”Ÿæˆå™¨çŠ¶æ€ - å¢å¼ºç‰ˆ
        function debugGeneratorStatus() {
            console.log('=== ä»£ç ç”Ÿæˆå™¨çŠ¶æ€è°ƒè¯• ===');
            console.log('Blockly.JavaScript æ˜¯å¦å­˜åœ¨:', !!Blockly.JavaScript);
            
            // æ£€æŸ¥ä¸åŒç‰ˆæœ¬çš„ç”Ÿæˆå™¨
            console.log('Blockly.javascriptGenerator æ˜¯å¦å­˜åœ¨:', !!Blockly.javascriptGenerator);
            console.log('å…¨å±€ javascriptGenerator æ˜¯å¦å­˜åœ¨:', typeof javascriptGenerator !== 'undefined');
            
            // é€‰æ‹©å¯ç”¨çš„ç”Ÿæˆå™¨
            let generator = null;
            if (typeof Blockly.JavaScript !== 'undefined') {
                generator = Blockly.JavaScript;
                console.log('ä½¿ç”¨ Blockly.JavaScript');
            } else if (typeof Blockly.javascriptGenerator !== 'undefined') {
                generator = Blockly.javascriptGenerator;
                console.log('ä½¿ç”¨ Blockly.javascriptGenerator');
            } else if (typeof javascriptGenerator !== 'undefined') {
                generator = javascriptGenerator;
                console.log('ä½¿ç”¨å…¨å±€ javascriptGenerator');
            }
            
            if (generator) {
                const requiredGenerators = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                requiredGenerators.forEach(name => {
                    const exists = !!generator[name];
                    const type = typeof generator[name];
                    console.log(`${name}: å­˜åœ¨=${exists}, ç±»å‹=${type}`);
                });
                
                // æ£€æŸ¥å…¶ä»–å¯èƒ½å­˜åœ¨çš„ç”Ÿæˆå™¨
                const allGenerators = Object.keys(generator).filter(key => 
                    typeof generator[key] === 'function' && key.startsWith('ai_')
                );
                console.log('æ‰€æœ‰AIç›¸å…³ç”Ÿæˆå™¨:', allGenerators);
                
                // æ£€æŸ¥ç”Ÿæˆå™¨çš„workspaceToCodeæ–¹æ³•
                console.log('workspaceToCodeæ–¹æ³•å­˜åœ¨:', !!generator.workspaceToCode);
            } else {
                console.error('æœªæ‰¾åˆ°å¯ç”¨çš„JavaScriptç”Ÿæˆå™¨');
            }
            
            console.log('å·¥ä½œåŒºçŠ¶æ€:', !!workspace);
            console.log('å—åˆå§‹åŒ–çŠ¶æ€:', blocksInitialized);
            console.log('=========================');
            
            // æ›´æ–°æ˜¾ç¤ºåŒºåŸŸ
            const codeElement = document.getElementById('generatedCode');
            if (codeElement) {
                let debugInfo = '=== è°ƒè¯•ä¿¡æ¯ ===\n';
                debugInfo += `Blocklyç‰ˆæœ¬æ£€æµ‹:\n`;
                debugInfo += `- Blockly.JavaScript: ${!!Blockly.JavaScript}\n`;
                debugInfo += `- Blockly.javascriptGenerator: ${!!Blockly.javascriptGenerator}\n`;
                debugInfo += `- å…¨å±€ javascriptGenerator: ${typeof javascriptGenerator !== 'undefined'}\n\n`;
                
                if (generator) {
                    debugInfo += `å½“å‰ä½¿ç”¨çš„ç”Ÿæˆå™¨: ${generator === Blockly.JavaScript ? 'Blockly.JavaScript' : generator === Blockly.javascriptGenerator ? 'Blockly.javascriptGenerator' : 'å…¨å±€ç”Ÿæˆå™¨'}\n\n`;
                    
                    const requiredGenerators = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                    debugInfo += 'AIç”Ÿæˆå™¨çŠ¶æ€:\n';
                    requiredGenerators.forEach(name => {
                        const exists = !!generator[name];
                        debugInfo += `- ${name}: ${exists ? 'âœ…' : 'âŒ'}\n`;
                    });
                } else {
                    debugInfo += 'âŒ æœªæ‰¾åˆ°å¯ç”¨çš„JavaScriptç”Ÿæˆå™¨\n';
                }
                
                debugInfo += `\nå·¥ä½œåŒº: ${workspace ? 'âœ… å·²åˆå§‹åŒ–' : 'âŒ æœªåˆå§‹åŒ–'}`;
                debugInfo += `\nå—å®šä¹‰: ${blocksInitialized ? 'âœ… å·²å®Œæˆ' : 'âŒ æœªå®Œæˆ'}`;
                
                codeElement.textContent = debugInfo;
            }
        }// å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–AIä»£ç ç”Ÿæˆå™¨
        function forceReinitAIGenerators() {
            console.log('å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–AIä»£ç ç”Ÿæˆå™¨...');
            
            try {
                // è·å–æ­£ç¡®çš„ç”Ÿæˆå™¨å¼•ç”¨
                let generator = null;
                if (typeof Blockly.JavaScript !== 'undefined') {
                    generator = Blockly.JavaScript;
                } else if (typeof Blockly.javascriptGenerator !== 'undefined') {
                    generator = Blockly.javascriptGenerator;
                } else if (typeof javascriptGenerator !== 'undefined') {
                    generator = javascriptGenerator;
                }
                
                if (!generator) {
                    console.error('æœªæ‰¾åˆ°å¯ç”¨çš„JavaScriptç”Ÿæˆå™¨');
                    return false;
                }
                
                // æ¸…é™¤ç°æœ‰çš„ç”Ÿæˆå™¨
                const generatorNames = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                generatorNames.forEach(name => {
                    if (generator[name]) {
                        delete generator[name];
                    }
                });
                
                // é‡æ–°å®šä¹‰
                defineAIGenerators();
                
                // éªŒè¯
                if (validateAIGenerators()) {
                    console.log('å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–æˆåŠŸ');
                    updateGeneratedCode();
                    return true;
                } else {
                    console.error('å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–å¤±è´¥');
                    return false;
                }
            } catch (error) {
                console.error('å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–è¿‡ç¨‹ä¸­å‡ºé”™:', error);
                return false;
            }
        }

        // å®Œæ•´çš„Blocklyç¯å¢ƒé‡æ–°åˆå§‹åŒ–
        function fullBlocklyReinit() {
            console.log('å¼€å§‹å®Œæ•´çš„Blocklyç¯å¢ƒé‡æ–°åˆå§‹åŒ–...');
            
            try {
                // 1. æ¸…ç†ç°æœ‰ç¯å¢ƒ
                if (workspace) {
                    workspace.dispose();
                    workspace = null;
                }
                
                // 2. æ¸…é™¤DOM
                const blocklyDiv = document.getElementById('blocklyDiv');
                if (blocklyDiv) {
                    blocklyDiv.innerHTML = '';
                }
                
                // 3. é‡ç½®æ ‡å¿—
                blocksInitialized = false;
                
                // 4. ç­‰å¾…ä¸€ä¸‹è®©DOMæ¸…ç†å®Œæˆ
                setTimeout(() => {
                    // 5. é‡æ–°åˆå§‹åŒ–
                    initBlocklyWorkspace();
                }, 100);
                
            } catch (error) {
                console.error('å®Œæ•´é‡æ–°åˆå§‹åŒ–å¤±è´¥:', error);
                document.getElementById('generatedCode').textContent = 'âŒ é‡æ–°åˆå§‹åŒ–å¤±è´¥: ' + error.message;
            }
        }        // åˆå§‹åŒ–Blocklyå·¥ä½œåŒº
        function initBlocklyWorkspace() {
            try {
                console.log('å¼€å§‹åˆå§‹åŒ–Blocklyå·¥ä½œåŒº...');

                // å¦‚æœå·¥ä½œåŒºå·²å­˜åœ¨ï¼Œå…ˆæ¸…ç†
                if (workspace) {
                    console.log('æ¸…ç†ç°æœ‰å·¥ä½œåŒº...');
                    safeResetBlockly();
                }// å®šä¹‰è‡ªå®šä¹‰å—å’Œä»£ç ç”Ÿæˆå™¨
                console.log('å®šä¹‰è‡ªå®šä¹‰å—...');
                defineAIBlocks();
                
                console.log('å®šä¹‰ä»£ç ç”Ÿæˆå™¨...');
                const generatorSuccess = defineAIGenerators();
                 
                // å·¥å…·ç®±é…ç½®
                var toolbox = {
                    "kind": "categoryToolbox",
                    "contents": [
                        {
                            "kind": "category",
                            "name": "ğŸ¤– AIæ¨¡å—",
                            "colour": 230,
                            "contents": [
                                {"kind": "block", "type": "ai_load_data"},
                                {"kind": "block", "type": "ai_create_model"},
                                {"kind": "block", "type": "ai_train_model"},
                                {"kind": "block", "type": "ai_predict"},
                                {"kind": "block", "type": "ai_show_result"}
                            ]
                        },
                        {
                            "kind": "category",
                            "name": "ğŸ”§ é€»è¾‘",
                            "colour": 210,
                            "contents": [
                                {"kind": "block", "type": "controls_if"},
                                {"kind": "block", "type": "logic_compare"},
                                {"kind": "block", "type": "logic_operation"},
                                {"kind": "block", "type": "logic_boolean"}
                            ]
                        },
                        {
                            "kind": "category",
                            "name": "ğŸ“ æ–‡æœ¬",
                            "colour": 160,
                            "contents": [
                                {"kind": "block", "type": "text"},
                                {"kind": "block", "type": "text_join"},
                                {"kind": "block", "type": "text_print"}
                            ]
                        },
                        {
                            "kind": "category",
                            "name": "ğŸ”¢ æ•°å­¦",
                            "colour": 230,
                            "contents": [
                                {"kind": "block", "type": "math_number"},
                                {"kind": "block", "type": "math_arithmetic"},
                                {"kind": "block", "type": "math_round"}
                            ]
                        }
                    ]
                };

                // åˆ›å»ºæ–°çš„Blocklyå·¥ä½œåŒº
                console.log('åˆ›å»ºBlocklyå·¥ä½œåŒº...');
                workspace = Blockly.inject('blocklyDiv', {
                    toolbox: toolbox,
                    scrollbars: true,
                    trashcan: true,
                    zoom: {
                        controls: true,
                        wheel: true,
                        startScale: 0.8,
                        maxScale: 3,
                        minScale: 0.3,
                        scaleSpeed: 1.2
                    },
                    grid: {
                        spacing: 25,
                        length: 3,
                        colour: '#ccc',
                        snap: true
                    }
                });                console.log('Blocklyå·¥ä½œåŒºåˆ›å»ºæˆåŠŸ');
                
                // æ·»åŠ å·¥ä½œåŒºå˜åŒ–ç›‘å¬å™¨æ¥è‡ªåŠ¨æ›´æ–°ä»£ç æ˜¾ç¤º
                workspace.addChangeListener(function(event) {
                    updateGeneratedCode();
                    
                    // å¤„ç†æ‹–æ‹½äº‹ä»¶ä»¥éšè—å·¥å…·ç®±
                    if (event.type === Blockly.Events.BLOCK_DRAG) {
                        const toolbox = document.querySelector('.blocklyToolboxDiv');
                        if (toolbox) {
                            if (event.isStart) {
                                // å¼€å§‹æ‹–æ‹½æ—¶éšè—å·¥å…·ç®±
                                toolbox.style.opacity = '0.3';
                                toolbox.style.pointerEvents = 'none';
                                document.body.classList.add('blocklyDragging');
                            } else {
                                // ç»“æŸæ‹–æ‹½æ—¶æ˜¾ç¤ºå·¥å…·ç®±
                                toolbox.style.opacity = '1';
                                toolbox.style.pointerEvents = 'auto';
                                document.body.classList.remove('blocklyDragging');
                            }
                        }
                    }
                });
                
                // åˆå§‹åŒ–ä»£ç æ˜¾ç¤ºå¹¶éªŒè¯ç”Ÿæˆå™¨
                setTimeout(() => {
                    // æœ€ç»ˆéªŒè¯æ‰€æœ‰ç”Ÿæˆå™¨æ˜¯å¦æ­£ç¡®å®šä¹‰
                    if (!validateAIGenerators()) {
                        console.warn('åˆå§‹åŒ–åç”Ÿæˆå™¨éªŒè¯å¤±è´¥ï¼Œå¼ºåˆ¶é‡æ–°å®šä¹‰...');
                        // æ¸…é™¤æ‰€æœ‰ç”Ÿæˆå™¨å¹¶é‡æ–°å®šä¹‰
                        const generatorNames = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                        generatorNames.forEach(name => {
                            if (Blockly.JavaScript[name]) {
                                delete Blockly.JavaScript[name];
                            }
                        });
                        defineAIGenerators();
                    }
                    updateGeneratedCode();
                }, 100);
                // æ ‡è®°Blocklyå·²ç»æˆåŠŸåˆå§‹åŒ–è¿‡
                blocklyEverInitialized = true;
                
                console.log('Blocklyå·¥ä½œåŒºåˆå§‹åŒ–å®Œæˆ');
                
            } catch (error) {
                console.error('Blocklyåˆå§‹åŒ–é”™è¯¯:', error);
                const errorMessage = 'âŒ Blocklyåˆå§‹åŒ–å¤±è´¥: ' + error.message + '\n\nğŸ’¡ è¯·å°è¯•:\n1. åˆ·æ–°é¡µé¢é‡è¯•\n2. ç‚¹å‡»"å®Œå…¨é‡ç½®"æŒ‰é’®\n3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯';
                document.getElementById('generatedCode').textContent = errorMessage;
            }
        }// æ›´æ–°ç”Ÿæˆçš„ä»£ç 
        function updateGeneratedCode() {
            const codeElement = document.getElementById('generatedCode');
            if (!codeElement) {
                console.warn('generatedCodeå…ƒç´ ä¸å­˜åœ¨');
                return;
            }
            
            if (!workspace) {
                codeElement.textContent = '// å·¥ä½œåŒºæœªåˆå§‹åŒ–';
                return;
            }
            
            try {
                // è·å–æ­£ç¡®çš„ç”Ÿæˆå™¨å¼•ç”¨ï¼ˆå…¼å®¹ä¸åŒç‰ˆæœ¬ï¼‰
                let generator = null;
                
                if (typeof Blockly.JavaScript !== 'undefined' && Blockly.JavaScript.workspaceToCode) {
                    generator = Blockly.JavaScript;
                } else if (typeof Blockly.javascriptGenerator !== 'undefined' && Blockly.javascriptGenerator.workspaceToCode) {
                    generator = Blockly.javascriptGenerator;
                } else if (typeof javascriptGenerator !== 'undefined' && javascriptGenerator.workspaceToCode) {
                    generator = javascriptGenerator;
                }
                
                if (!generator) {
                    codeElement.textContent = '// JavaScriptä»£ç ç”Ÿæˆå™¨æœªæ‰¾åˆ°\n// è¯·æ£€æŸ¥Blocklyç‰ˆæœ¬å…¼å®¹æ€§';
                    return;
                }
                
                var code = generator.workspaceToCode(workspace);
                codeElement.textContent = code || '// è¯·æ‹–æ‹½ä»£ç å—æ¥æ„å»ºAIç¨‹åº';
                
            } catch (error) {
                console.error('ä»£ç ç”Ÿæˆé”™è¯¯:', error);
                codeElement.textContent = '// ä»£ç ç”Ÿæˆå¤±è´¥: ' + error.message + '\n// è¯·å°è¯•é‡æ–°åˆå§‹åŒ–æˆ–æ£€æŸ¥å—è¿æ¥';
            }
        }// è¿è¡ŒBlocklyä»£ç 
        function runBlocklyCode() {
            const resultElement = document.getElementById('executionResult');
            if (!resultElement) {
                console.warn('executionResultå…ƒç´ ä¸å­˜åœ¨');
                return;
            }
            
            if (!workspace) {
                resultElement.textContent = 'âŒ å·¥ä½œåŒºæœªåˆå§‹åŒ–';
                return;
            }

            try {
                // è·å–æ­£ç¡®çš„ç”Ÿæˆå™¨å¼•ç”¨ï¼ˆå…¼å®¹ä¸åŒç‰ˆæœ¬ï¼‰
                let generator = null;
                
                if (typeof Blockly.JavaScript !== 'undefined' && Blockly.JavaScript.workspaceToCode) {
                    generator = Blockly.JavaScript;
                } else if (typeof Blockly.javascriptGenerator !== 'undefined' && Blockly.javascriptGenerator.workspaceToCode) {
                    generator = Blockly.javascriptGenerator;
                } else if (typeof javascriptGenerator !== 'undefined' && javascriptGenerator.workspaceToCode) {
                    generator = javascriptGenerator;
                }
                
                if (!generator) {
                    resultElement.textContent = 'âŒ JavaScriptä»£ç ç”Ÿæˆå™¨æœªæ‰¾åˆ°';
                    return;
                }
                
                var code = generator.workspaceToCode(workspace);
                if (!code.trim()) {
                    resultElement.textContent = 'âŒ è¯·å…ˆæ„å»ºç¨‹åºå†è¿è¡Œ';
                    return;
                }

                resultElement.textContent = 'ğŸš€ ç¨‹åºå¼€å§‹è¿è¡Œ...\n';
                
                // æ¨¡æ‹ŸAIè®­ç»ƒè¿‡ç¨‹
                simulateAITraining(code);
            } catch (error) {
                console.error('ä»£ç è¿è¡Œé”™è¯¯:', error);
                resultElement.textContent = 'âŒ ä»£ç è¿è¡Œé”™è¯¯: ' + error.message;
            }
        }

        // æ¨¡æ‹ŸAIè®­ç»ƒè¿‡ç¨‹
        function simulateAITraining(code) {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const trainingLog = document.getElementById('training-log');
            const resultDiv = document.getElementById('executionResult');

            let progress = 0;
            const totalSteps = 100;
              // è§£æä»£ç ä¸­çš„å‚æ•°
            const epochsMatch = code.match(/trainModel\\([^,]+,[^,]+,(\\d+))/);
            const epochs = epochsMatch ? parseInt(epochsMatch[1]) : 10;
            const datasetMatch = code.match(/loadDataset\\('([^']+)'\\)/);
            const dataset = datasetMatch ? datasetMatch[1] : 'unknown';
            const modelMatch = code.match(/createModel\\('([^']+)'\\)/);
            const modelType = modelMatch ? modelMatch[1] : 'unknown';

            // æ·»åŠ åˆå§‹æ—¥å¿—
            trainingLog.innerHTML = `ğŸ“Š æ•°æ®é›†: ${dataset}<br>ğŸ§  æ¨¡å‹ç±»å‹: ${modelType}<br>ğŸ”„ è®­ç»ƒè½®æ•°: ${epochs}<br><br>`;
            
            const interval = setInterval(() => {
                progress += Math.random() * 3 + 1;
                
                if (progress >= totalSteps) {
                    progress = totalSteps;
                    clearInterval(interval);
                    
                    // è®­ç»ƒå®Œæˆ
                    progressBar.style.width = '100%';
                    progressText.textContent = '100%';
                    trainingLog.innerHTML += 'âœ… è®­ç»ƒå®Œæˆï¼<br>ğŸ“ˆ å‡†ç¡®ç‡: 94.5%<br>â±ï¸ è®­ç»ƒæ—¶é—´: 2.3ç§’<br>';
                    
                    // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
                    setTimeout(() => {                        if (code.includes('predict(')) {
                            const imageMatch = code.match(/predict\\([^,]+,\\s*'([^']+)'\\)/);
                            const imageName = imageMatch ? imageMatch[1] : 'test.jpg';
                            resultDiv.textContent = `âœ… ç¨‹åºè¿è¡ŒæˆåŠŸï¼

ğŸ” é¢„æµ‹ç»“æœ:
- è¾“å…¥å›¾ç‰‡: ${imageName}
- é¢„æµ‹ç±»åˆ«: ${imageName.includes('cat') ? 'çŒ«' : imageName.includes('dog') ? 'ç‹—' : 'æœªçŸ¥'}
- ç½®ä¿¡åº¦: ${(Math.random() * 20 + 80).toFixed(1)}%

ğŸ“Š æ¨¡å‹æ€§èƒ½:
- è®­ç»ƒå‡†ç¡®ç‡: 94.5%
- éªŒè¯å‡†ç¡®ç‡: 92.1%
- æ¨¡å‹å¤§å°: 2.3MB`;
                        } else {
                            resultDiv.textContent = `âœ… ç¨‹åºè¿è¡ŒæˆåŠŸï¼

ğŸ‰ AIæ¨¡å‹è®­ç»ƒå®Œæˆ
- æ•°æ®é›†: ${dataset}
- æ¨¡å‹ç±»å‹: ${modelType}
- è®­ç»ƒè½®æ•°: ${epochs}
- æœ€ç»ˆå‡†ç¡®ç‡: 94.5%`;
                        }
                    }, 500);
                } else {
                    progressBar.style.width = progress + '%';
                    progressText.textContent = Math.floor(progress) + '%';
                    
                    // æ·»åŠ è®­ç»ƒæ—¥å¿—
                    if (progress % 20 < 3) {
                        const epoch = Math.floor(progress / (100 / epochs)) + 1;
                        const loss = (Math.random() * 0.5 + 0.1).toFixed(3);
                        const acc = (Math.random() * 0.1 + 0.85).toFixed(3);
                        trainingLog.innerHTML += `Epoch ${epoch}: loss=${loss}, accuracy=${acc}<br>`;
                        trainingLog.scrollTop = trainingLog.scrollHeight;
                    }
                }
            }, 100);
        }        // æ¸…ç©ºå·¥ä½œåŒº
        function clearWorkspace() {
            if (workspace) {
                try {
                    workspace.clear();
                    document.getElementById('generatedCode').textContent = '// è¯·æ‹–æ‹½ä»£ç å—æ¥æ„å»ºAIç¨‹åº';
                    document.getElementById('executionResult').textContent = 'ç­‰å¾…ç¨‹åºè¿è¡Œ...';
                    document.getElementById('progress-bar').style.width = '0%';
                    document.getElementById('progress-text').textContent = '0%';
                    document.getElementById('training-log').textContent = 'å‡†å¤‡å¼€å§‹è®­ç»ƒ...';
                } catch (error) {
                    console.error('æ¸…ç©ºå·¥ä½œåŒºé”™è¯¯:', error);
                }
            }
        }        // åŠ è½½ç¤ºä¾‹ç¨‹åº
        function loadSample() {
            if (!workspace) {
                console.error('å·¥ä½œåŒºæœªåˆå§‹åŒ–');
                return;
            }

            try {
                const sampleXml = `<xml xmlns="https://developers.google.com/blockly/xml">
                    <block type="ai_train_model" x="200" y="50">
                        <value name="MODEL">
                            <block type="ai_create_model">
                                <field name="MODEL_TYPE">image_classifier</field>
                            </block>
                        </value>
                        <value name="DATA">
                            <block type="ai_load_data">
                                <field name="DATASET">cats_dogs</field>
                            </block>
                        </value>
                        <field name="EPOCHS">15</field>
                        <next>
                            <block type="ai_show_result">
                                <value name="RESULT">
                                    <block type="ai_predict">
                                        <value name="MODEL">
                                            <block type="ai_create_model">
                                                <field name="MODEL_TYPE">image_classifier</field>
                                            </block>
                                        </value>
                                        <field name="IMAGE">cat.jpg</field>
                                    </block>
                                </value>
                            </block>
                        </next>
                    </block>
                </xml>`;

                // å…¼å®¹ä¸åŒç‰ˆæœ¬çš„Blockly XMLè§£æ
                let xmlDom;
                let loadSuccess = false;

                // æ–¹æ³•1: å°è¯•æ–°ç‰ˆæœ¬Blockly (v6+)
                if (!loadSuccess && typeof Blockly.utils !== 'undefined' && Blockly.utils.xml && Blockly.utils.xml.textToDom) {
                    try {
                        xmlDom = Blockly.utils.xml.textToDom(sampleXml);
                        if (typeof Blockly.serialization !== 'undefined' && Blockly.serialization.workspaces) {
                            Blockly.serialization.workspaces.load(xmlDom, workspace);
                        } else if (Blockly.Xml && Blockly.Xml.domToWorkspace) {
                            Blockly.Xml.domToWorkspace(xmlDom, workspace);
                        }
                        loadSuccess = true;
                        console.log('ä½¿ç”¨æ–°ç‰ˆBlockly APIåŠ è½½æˆåŠŸ');
                    } catch (e) {
                        console.log('æ–°ç‰ˆAPIåŠ è½½å¤±è´¥:', e.message);
                    }
                }

                // æ–¹æ³•2: å°è¯•æ—§ç‰ˆæœ¬Blockly (v5åŠä»¥ä¸‹)  
                if (!loadSuccess && Blockly.Xml && Blockly.Xml.textToDom) {
                    try {
                        xmlDom = Blockly.Xml.textToDom(sampleXml);
                        Blockly.Xml.domToWorkspace(xmlDom, workspace);
                        loadSuccess = true;
                        console.log('ä½¿ç”¨æ—§ç‰ˆBlockly APIåŠ è½½æˆåŠŸ');
                    } catch (e) {
                        console.log('æ—§ç‰ˆAPIåŠ è½½å¤±è´¥:', e.message);
                    }
                }

                // æ–¹æ³•3: ä½¿ç”¨æµè§ˆå™¨åŸç”ŸXMLè§£æä½œä¸ºåå¤‡æ–¹æ¡ˆ
                if (!loadSuccess) {
                    try {
                        const parser = new DOMParser();
                        xmlDom = parser.parseFromString(sampleXml, 'text/xml');
                        
                        if (xmlDom.documentElement.nodeName === 'parsererror') {
                            throw new Error('XMLè§£æå¤±è´¥');
                        }
                        
                        if (Blockly.Xml && Blockly.Xml.domToWorkspace) {
                            Blockly.Xml.domToWorkspace(xmlDom, workspace);
                            loadSuccess = true;
                            console.log('ä½¿ç”¨æµè§ˆå™¨åŸç”ŸXMLè§£æåŠ è½½æˆåŠŸ');
                        }
                    } catch (e) {
                        console.log('åŸç”ŸXMLè§£æå¤±è´¥:', e.message);
                    }
                }

                // æ–¹æ³•4: å¦‚æœæ‰€æœ‰XMLæ–¹æ³•éƒ½å¤±è´¥ï¼Œä½¿ç”¨ç¼–ç¨‹æ–¹å¼åˆ›å»ºç¤ºä¾‹
                if (!loadSuccess) {
                    console.log('æ‰€æœ‰XMLåŠ è½½æ–¹æ³•å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨ç¼–ç¨‹æ–¹å¼åˆ›å»ºç¤ºä¾‹');
                    try {
                        createSampleProgrammatically();
                        loadSuccess = true;
                    } catch (e) {
                        console.log('ç¼–ç¨‹æ–¹å¼åˆ›å»ºå¤±è´¥:', e.message);
                    }
                }

                if (loadSuccess) {
                    updateGeneratedCode();
                    console.log('ç¤ºä¾‹åŠ è½½æˆåŠŸ');
                } else {
                    throw new Error('æ‰€æœ‰åŠ è½½æ–¹æ³•éƒ½å¤±è´¥äº†');
                }

            } catch (error) {
                console.error('åŠ è½½ç¤ºä¾‹é”™è¯¯:', error);
                
                // æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³æ–¹æ¡ˆ
                let errorMessage = 'åŠ è½½ç¤ºä¾‹å¤±è´¥ã€‚\n\n';
                
                if (error.message.includes('textToDom') || error.message.includes('æ‰€æœ‰åŠ è½½æ–¹æ³•éƒ½å¤±è´¥äº†')) {
                    errorMessage += 'ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼š\n';
                    errorMessage += 'â€¢ æ‰‹åŠ¨æ‹–æ‹½å·¦ä¾§å·¥å…·ç®±ä¸­çš„ä»£ç å—æ¥åˆ›å»ºç¨‹åº\n';
                    errorMessage += 'â€¢ æˆ–è€…åˆ·æ–°é¡µé¢é‡è¯•\n\n';
                    errorMessage += 'åŸºæœ¬æ­¥éª¤ï¼š\n';
                    errorMessage += '1. ä»"ğŸ¤– AIæ¨¡å—"æ‹–æ‹½"ğŸ“‚ åŠ è½½æ•°æ®é›†"\n';
                    errorMessage += '2. æ‹–æ‹½"ğŸ§  åˆ›å»ºAIæ¨¡å‹"\n';
                    errorMessage += '3. æ‹–æ‹½"ğŸš€ è®­ç»ƒæ¨¡å‹"å¹¶è¿æ¥ä¸Šè¿°å—\n';
                    errorMessage += '4. æ‹–æ‹½"ğŸ” ä½¿ç”¨æ¨¡å‹"è¿›è¡Œé¢„æµ‹\n';
                    errorMessage += '5. æ‹–æ‹½"ğŸ“Š æ˜¾ç¤ºé¢„æµ‹ç»“æœ"';
                } else {
                    errorMessage += 'é”™è¯¯è¯¦æƒ…: ' + error.message;
                }
                
                alert(errorMessage);
            }
        }

        // ç¼–ç¨‹æ–¹å¼åˆ›å»ºç¤ºä¾‹ï¼ˆå½“XMLæ–¹æ³•å¤±è´¥æ—¶çš„å¤‡ç”¨æ–¹æ¡ˆï¼‰
        function createSampleProgrammatically() {
            if (!workspace || !Blockly.Blocks) {
                throw new Error('å·¥ä½œåŒºæˆ–Blocklyå—æœªå‡†å¤‡å°±ç»ª');
            }
            
            // è¿™æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼Œåªåˆ›å»ºåŸºæœ¬çš„å—ç»“æ„
            // åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ‹–æ‹½æ¥æ„å»ºç¨‹åº
            console.log('ç¼–ç¨‹æ–¹å¼åˆ›å»ºç¤ºä¾‹æš‚æœªå®ç°ï¼Œè¯·æ‰‹åŠ¨æ‹–æ‹½ä»£ç å—');
            
            // æ›´æ–°æ˜¾ç¤ºæ¶ˆæ¯
            document.getElementById('generatedCode').textContent = `// XMLåŠ è½½å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æ„å»ºç¨‹åºï¼š
// 1. ä»å·¦ä¾§"ğŸ¤– AIæ¨¡å—"æ‹–æ‹½"ğŸ“‚ åŠ è½½æ•°æ®é›†"
// 2. æ‹–æ‹½"ğŸ§  åˆ›å»ºAIæ¨¡å‹" 
// 3. æ‹–æ‹½"ğŸš€ è®­ç»ƒæ¨¡å‹"å¹¶è¿æ¥
// 4. æ‹–æ‹½"ğŸ” ä½¿ç”¨æ¨¡å‹"å’Œ"ğŸ“Š æ˜¾ç¤ºé¢„æµ‹ç»“æœ"
// ç„¶åç‚¹å‡»"â–¶ï¸ è¿è¡Œ"æŒ‰é’®`;
        }// å…¨å±€å˜é‡æ¥è·Ÿè¸ªåˆå§‹åŒ–çŠ¶æ€
        let pageInitialized = false;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            if (pageInitialized) return;
            pageInitialized = true;
            
            showSection('cover');
            updateVoteDisplay();
            
            // æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
            window.addEventListener('error', function(e) {
                if (e.error && e.error.message) {
                    if (e.error.message.includes('Extension') && e.error.message.includes('already registered')) {
                        console.log('å¿½ç•¥Blocklyæ‰©å±•é‡å¤æ³¨å†Œé”™è¯¯');
                        e.preventDefault();
                        return false;
                    }
                    if (e.error.message.includes('contextMenu_variableDynamicSetterGetter')) {
                        console.log('å¿½ç•¥Blocklyå˜é‡èœå•æ‰©å±•é‡å¤æ³¨å†Œé”™è¯¯');
                        e.preventDefault();
                        return false;
                    }
                }
                console.error('é¡µé¢é”™è¯¯:', e.error);
            });

            // æ·»åŠ æœªå¤„ç†çš„Promiseé”™è¯¯å¤„ç†
            window.addEventListener('unhandledrejection', function(e) {
                if (e.reason && e.reason.message && e.reason.message.includes('Extension')) {
                    console.log('å¿½ç•¥Promiseä¸­çš„Blocklyæ‰©å±•é”™è¯¯');
                    e.preventDefault();
                    return;
                }
                console.error('æœªå¤„ç†çš„Promiseé”™è¯¯:', e.reason);            });
        });
        
        // é¡µé¢å¸è½½æ—¶æ¸…ç†Blocklyå·¥ä½œåŒº
        window.addEventListener('beforeunload', function() {
            if (workspace) {
                try {
                    workspace.dispose();
                } catch (error) {
                    console.log('å·¥ä½œåŒºæ¸…ç†å®Œæˆ');
                }
            }
        });

        // ==================== ä»£ç ç¼–è¾‘å™¨å’ŒPythonæ‰§è¡ŒåŠŸèƒ½ ====================
        
        let codeEditor = null;
        let pyodide = null;
        let pyodideReady = false;

        // åˆå§‹åŒ–ä»£ç ç¼–è¾‘å™¨
        function initCodeEditor() {
            if (codeEditor) return; // é˜²æ­¢é‡å¤åˆå§‹åŒ–
            
            try {
                if (typeof CodeMirror === 'undefined') {
                    console.error('CodeMirroræœªåŠ è½½');
                    document.getElementById('codeOutput').textContent = 'âŒ ä»£ç ç¼–è¾‘å™¨åº“æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•';
                    return;
                }

                const textarea = document.getElementById('codeEditor');
                codeEditor = CodeMirror.fromTextArea(textarea, {
                    mode: 'python',
                    theme: 'material',
                    lineNumbers: true,
                    indentUnit: 4,
                    indentWithTabs: false,
                    lineWrapping: true,
                    autoCloseBrackets: true,
                    matchBrackets: true,
                    extraKeys: {
                        'Ctrl-Space': 'autocomplete',
                        'F11': function(cm) {
                            cm.setOption('fullScreen', !cm.getOption('fullScreen'));
                        },
                        'Esc': function(cm) {
                            if (cm.getOption('fullScreen')) cm.setOption('fullScreen', false);
                        }
                    }
                });

                codeEditor.setSize('100%', '400px');
                console.log('ä»£ç ç¼–è¾‘å™¨åˆå§‹åŒ–æˆåŠŸ');
                
            } catch (error) {
                console.error('ä»£ç ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:', error);
                document.getElementById('codeOutput').textContent = 'âŒ ä»£ç ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥: ' + error.message;
            }
        }

        // åˆå§‹åŒ–Pyodideï¼ˆPythonæ‰§è¡Œç¯å¢ƒï¼‰
        async function initPyodide() {
            if (pyodideReady) return;
            
            try {
                updateExecutionStatus('åˆå§‹åŒ–Pythonç¯å¢ƒ...', 'running');
                updateStepLog('æ­£åœ¨åŠ è½½Pyodide Pythonæ‰§è¡Œç¯å¢ƒ...');
                
                if (typeof loadPyodide === 'undefined') {
                    throw new Error('Pyodideåº“æœªåŠ è½½');
                }

                pyodide = await loadPyodide({
                    indexURL: 'https://cdn.jsdelivr.net/pyodide/v0.24.1/full/'
                });

                // å®‰è£…å¸¸ç”¨çš„æ•°æ®ç§‘å­¦åŒ…
                updateStepLog('å®‰è£…PythonåŒ…: numpy, matplotlib, scikit-learn...');
                await pyodide.loadPackage(['numpy', 'matplotlib', 'scikit-learn']);
                
                // è®¾ç½®Pythonç‰ˆæœ¬ä¿¡æ¯
                document.getElementById('python-version').textContent = 'Pyodide ' + pyodide.version;
                
                pyodideReady = true;
                updateExecutionStatus('Pythonç¯å¢ƒå°±ç»ª', 'success');
                updateStepLog('âœ… Pythonç¯å¢ƒåˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥è¿è¡Œä»£ç äº†ï¼');
                
                console.log('Pyodideåˆå§‹åŒ–æˆåŠŸ');
                
            } catch (error) {
                console.error('Pyodideåˆå§‹åŒ–å¤±è´¥:', error);
                updateExecutionStatus('åˆå§‹åŒ–å¤±è´¥', 'error');
                document.getElementById('codeOutput').textContent = 'âŒ Pythonç¯å¢ƒåˆå§‹åŒ–å¤±è´¥: ' + error.message + '\n\nğŸ’¡ æç¤ºï¼šè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å¹¶åˆ·æ–°é¡µé¢é‡è¯•';
                updateStepLog('âŒ Pythonç¯å¢ƒåˆå§‹åŒ–å¤±è´¥: ' + error.message);
            }
        }

        // è¿è¡ŒPythonä»£ç 
        async function runPythonCode() {
            if (!codeEditor) {
                alert('ä»£ç ç¼–è¾‘å™¨æœªåˆå§‹åŒ–');
                return;
            }

            if (!pyodideReady) {
                alert('Pythonç¯å¢ƒæœªå‡†å¤‡å°±ç»ªï¼Œè¯·ç­‰å¾…åˆå§‹åŒ–å®Œæˆ');
                return;
            }

            const code = codeEditor.getValue().trim();
            if (!code) {
                alert('è¯·è¾“å…¥Pythonä»£ç ');
                return;
            }

            try {
                updateExecutionStatus('ä»£ç æ‰§è¡Œä¸­...', 'running');
                updateCodeProgress(0, 'å¼€å§‹æ‰§è¡Œä»£ç ...');
                
                const startTime = performance.now();
                
                // æ¸…é™¤ä¹‹å‰çš„è¾“å‡º
                document.getElementById('codeOutput').textContent = '';
                document.getElementById('error-info').classList.add('hidden');
                
                // æ¨¡æ‹Ÿæ‰§è¡Œæ­¥éª¤
                const steps = [
                    'å¯¼å…¥åº“å’Œæ¨¡å—...',
                    'å¤„ç†æ•°æ®...',
                    'åˆ›å»ºAIæ¨¡å‹...',
                    'è®­ç»ƒæ¨¡å‹...',
                    'è¿›è¡Œé¢„æµ‹...',
                    'ç”Ÿæˆç»“æœ...'
                ];
                
                for (let i = 0; i < steps.length; i++) {
                    updateCodeProgress((i + 1) / steps.length * 50, steps[i]);
                    await new Promise(resolve => setTimeout(resolve, 200));
                }

                // é‡å®šå‘Pythonçš„printè¾“å‡º
                pyodide.runPython(`
import sys
from io import StringIO
import contextlib

class OutputCapture:
    def __init__(self):
        self.output = StringIO()
    
    def write(self, text):
        self.output.write(text)
        
    def flush(self):
        pass
        
    def getvalue(self):
        return self.output.getvalue()

output_capture = OutputCapture()
`);

                // æ‰§è¡Œç”¨æˆ·ä»£ç 
                updateCodeProgress(75, 'æ‰§è¡Œä¸»ç¨‹åº...');
                
                pyodide.runPython(`
old_stdout = sys.stdout
sys.stdout = output_capture
try:
    exec("""` + code.replace(/"/g, '\\"') + `""")
except Exception as e:
    print(f"æ‰§è¡Œé”™è¯¯: {e}")
finally:
    sys.stdout = old_stdout
`);

                // è·å–è¾“å‡ºç»“æœ
                const output = pyodide.runPython('output_capture.getvalue()');
                
                const endTime = performance.now();
                const executionTime = ((endTime - startTime) / 1000).toFixed(2);
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('codeOutput').textContent = output || 'ä»£ç æ‰§è¡Œå®Œæˆï¼Œæ— è¾“å‡ºå†…å®¹';
                document.getElementById('execution-time').textContent = executionTime + ' ç§’';
                document.getElementById('memory-usage').textContent = '~' + Math.round(Math.random() * 50 + 10) + ' MB';
                
                updateExecutionStatus('æ‰§è¡ŒæˆåŠŸ', 'success');
                updateCodeProgress(100, 'âœ… ä»£ç æ‰§è¡Œå®Œæˆï¼');
                updateStepLog('ä»£ç æ‰§è¡ŒæˆåŠŸï¼Œç”¨æ—¶ ' + executionTime + ' ç§’');
                
            } catch (error) {
                console.error('ä»£ç æ‰§è¡Œé”™è¯¯:', error);
                updateExecutionStatus('æ‰§è¡Œå¤±è´¥', 'error');
                
                const errorDiv = document.getElementById('error-info');
                errorDiv.textContent = 'æ‰§è¡Œé”™è¯¯: ' + error.message;
                errorDiv.classList.remove('hidden');
                
                document.getElementById('codeOutput').textContent = 'âŒ ä»£ç æ‰§è¡Œå¤±è´¥:\n' + error.message;
                updateCodeProgress(0, 'âŒ æ‰§è¡Œå¤±è´¥');
                updateStepLog('âŒ ä»£ç æ‰§è¡Œå¤±è´¥: ' + error.message);
            }
        }

        // æ¸…ç©ºä»£ç ç¼–è¾‘å™¨
        function clearCodeEditor() {
            if (codeEditor) {
                codeEditor.setValue('# åœ¨è¿™é‡Œç¼–å†™ä½ çš„Pythonä»£ç \nprint("Hello, AI!")\n');
                document.getElementById('codeOutput').textContent = 'ç­‰å¾…ä»£ç è¿è¡Œ...\nä½¿ç”¨ä¸Šæ–¹çš„"è¿è¡Œä»£ç "æŒ‰é’®æ‰§è¡ŒPythonç¨‹åº';
                document.getElementById('error-info').classList.add('hidden');
                updateExecutionStatus('å‡†å¤‡å°±ç»ª', 'ready');
                updateCodeProgress(0, 'å‡†å¤‡è¿è¡ŒAIä»£ç ...');
            }
        }

        // åŠ è½½ä»£ç ç¤ºä¾‹
        function loadCodeExample() {
            // é»˜è®¤åŠ è½½åŸºç¡€ç¤ºä¾‹
            loadExample('basic');
        }

        // åŠ è½½ç‰¹å®šç¤ºä¾‹
        function loadExample(type) {
            if (!codeEditor) return;
            
            let exampleCode = '';
            
            switch (type) {
                case 'basic':
                    exampleCode = `# AIå›¾åƒåˆ†ç±»å®è·µ - çŒ«ç‹—è¯†åˆ«
# å¯¼å…¥å¿…è¦çš„åº“
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, classification_report

# æ¨¡æ‹Ÿç”ŸæˆçŒ«ç‹—å›¾åƒç‰¹å¾æ•°æ®
print("ğŸ±ğŸ¶ ç”Ÿæˆæ¨¡æ‹Ÿçš„çŒ«ç‹—å›¾åƒç‰¹å¾æ•°æ®...")
X, y = make_classification(
    n_samples=1000,  # 1000ä¸ªæ ·æœ¬
    n_features=20,   # 20ä¸ªç‰¹å¾ï¼ˆæ¨¡æ‹Ÿå›¾åƒç‰¹å¾ï¼‰
    n_classes=2,     # 2ä¸ªç±»åˆ«ï¼ˆçŒ«å’Œç‹—ï¼‰
    n_redundant=0,
    n_informative=20,
    random_state=42
)

# å°†æ ‡ç­¾æ˜ å°„ä¸ºçŒ«å’Œç‹—
class_names = ['çŒ«', 'ç‹—']
print(f"æ•°æ®é›†å¤§å°: {X.shape[0]} ä¸ªæ ·æœ¬, {X.shape[1]} ä¸ªç‰¹å¾")

# åˆ†å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

print(f"è®­ç»ƒé›†: {X_train.shape[0]} ä¸ªæ ·æœ¬")
print(f"æµ‹è¯•é›†: {X_test.shape[0]} ä¸ªæ ·æœ¬")

# åˆ›å»ºAIæ¨¡å‹ï¼ˆéšæœºæ£®æ—åˆ†ç±»å™¨ï¼‰
print("ğŸ§  åˆ›å»ºAIæ¨¡å‹...")
model = RandomForestClassifier(
    n_estimators=100,  # 100æ£µå†³ç­–æ ‘
    random_state=42
)

# è®­ç»ƒæ¨¡å‹
print("ğŸš€ å¼€å§‹è®­ç»ƒæ¨¡å‹...")
model.fit(X_train, y_train)
print("âœ… æ¨¡å‹è®­ç»ƒå®Œæˆï¼")

# è¿›è¡Œé¢„æµ‹
print("ğŸ” è¿›è¡Œé¢„æµ‹...")
y_pred = model.predict(X_test)

# è®¡ç®—å‡†ç¡®ç‡
accuracy = accuracy_score(y_test, y_pred)
print(f"ğŸ¯ æ¨¡å‹å‡†ç¡®ç‡: {accuracy:.2%}")

# æ˜¾ç¤ºè¯¦ç»†çš„åˆ†ç±»æŠ¥å‘Š
print("ğŸ“Š è¯¦ç»†åˆ†ç±»æŠ¥å‘Š:")
print(classification_report(y_test, y_pred, target_names=class_names))

# é¢„æµ‹å‡ ä¸ªå…·ä½“æ ·æœ¬
print("ğŸ§ª é¢„æµ‹ç¤ºä¾‹:")
for i in range(5):
    pred = model.predict([X_test[i]])
    actual = y_test[i]
    pred_name = class_names[pred[0]]
    actual_name = class_names[actual]
    confidence = model.predict_proba([X_test[i]])[0][pred[0]]
    
    status = "âœ…" if pred[0] == actual else "âŒ"
    print(f"{status} æ ·æœ¬ {i+1}: é¢„æµ‹={pred_name} (ç½®ä¿¡åº¦:{confidence:.1%}), å®é™…={actual_name}")

print("ğŸ‰ AIå›¾åƒåˆ†ç±»å®è·µå®Œæˆï¼")`;
                    break;
                    
                case 'advanced':
                    exampleCode = `# é«˜çº§AIæ¨¡å‹ - æ”¯æŒå‘é‡æœºåˆ†ç±»å™¨
import numpy as np
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.svm import SVC
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, confusion_matrix
from sklearn.pipeline import Pipeline

print("ğŸš€ é«˜çº§AIæ¨¡å‹å®è·µ - SVMåˆ†ç±»å™¨")

# ç”Ÿæˆæ›´å¤æ‚çš„æ•°æ®é›†
X, y = make_classification(
    n_samples=2000,
    n_features=50,
    n_classes=3,  # ä¸‰åˆ†ç±»é—®é¢˜
    n_informative=30,
    n_redundant=10,
    random_state=42
)

class_names = ['ç±»åˆ«A', 'ç±»åˆ«B', 'ç±»åˆ«C']
print(f"æ•°æ®é›†: {X.shape[0]} æ ·æœ¬, {X.shape[1]} ç‰¹å¾, {len(class_names)} ç±»åˆ«")

# æ•°æ®åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

# åˆ›å»ºç®¡é“ï¼šæ ‡å‡†åŒ– + SVM
pipeline = Pipeline([
    ('scaler', StandardScaler()),
    ('svm', SVC(probability=True, random_state=42))
])

# è¶…å‚æ•°ç½‘æ ¼æœç´¢
param_grid = {
    'svm__C': [0.1, 1, 10],
    'svm__kernel': ['rbf', 'poly'],
    'svm__gamma': ['scale', 'auto']
}

print("ğŸ” å¼€å§‹ç½‘æ ¼æœç´¢æœ€ä¼˜å‚æ•°...")
grid_search = GridSearchCV(
    pipeline, param_grid, cv=5, 
    scoring='accuracy', n_jobs=-1
)

grid_search.fit(X_train, y_train)

print(f"âœ… æœ€ä¼˜å‚æ•°: {grid_search.best_params_}")
print(f"âœ… äº¤å‰éªŒè¯æœ€ä½³å¾—åˆ†: {grid_search.best_score_:.3f}")

# ä½¿ç”¨æœ€ä¼˜æ¨¡å‹é¢„æµ‹
best_model = grid_search.best_estimator_
y_pred = best_model.predict(X_test)

# è¯„ä¼°æ¨¡å‹
accuracy = accuracy_score(y_test, y_pred)
print(f"ğŸ¯ æµ‹è¯•é›†å‡†ç¡®ç‡: {accuracy:.3f}")

# æ··æ·†çŸ©é˜µ
cm = confusion_matrix(y_test, y_pred)
print(f"ğŸ“Š æ··æ·†çŸ©é˜µ:")
print(cm)

# æ¯ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡
print("ğŸ§ª å‰5ä¸ªæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡:")
for i in range(5):
    probs = best_model.predict_proba([X_test[i]])[0]
    pred_class = probs.argmax()
    confidence = probs.max()
    print(f"æ ·æœ¬ {i+1}: {class_names[pred_class]} (ç½®ä¿¡åº¦: {confidence*100:.2f}%)")

# ç½‘ç»œå‚æ•°ç»Ÿè®¡
total_params = sum([layer.size for layer in best_model.coefs_]) + sum([layer.size for layer in best_model.intercepts_])
print(f"ğŸ“Š ç½‘ç»œç»Ÿè®¡:")
print(f"  æ€»å‚æ•°æ•°é‡: {total_params:,}")
print(f"  ç½‘ç»œå±‚æ•°: {len(best_model.coefs_)}")
print(f"  æ¿€æ´»å‡½æ•°: {best_model.activation}")
print(f"  ä¼˜åŒ–ç®—æ³•: {best_model.solver}")

print("ğŸ‰ é«˜çº§AIæ¨¡å‹å®è·µå®Œæˆï¼")`;
                    break;
                    
                case 'visualization':
                    exampleCode = `# æ•°æ®å¯è§†åŒ– + AIåˆ†æ
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs, make_circles
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA

print("ğŸ“Š AIæ•°æ®å¯è§†åŒ–å®è·µ")

# ç”Ÿæˆèšç±»æ•°æ®
print("ğŸ¯ ç”Ÿæˆèšç±»æ•°æ®...")
X_blobs, y_blobs = make_blobs(
    n_samples=300, centers=4, 
    cluster_std=0.60, random_state=42
)

# K-meansèšç±»
print("ğŸ§  æ‰§è¡ŒK-meansèšç±»...")
kmeans = KMeans(n_clusters=4, random_state=42)
clusters = kmeans.fit_predict(X_blobs)

# è®¡ç®—èšç±»è´¨é‡
from sklearn.metrics import silhouette_score
silhouette_avg = silhouette_score(X_blobs, clusters)
print(f"âœ… è½®å»“ç³»æ•° (èšç±»è´¨é‡): {silhouette_avg:.3f}")

# æ˜¾ç¤ºèšç±»ä¸­å¿ƒ
centers = kmeans.cluster_centers_
print(f"ğŸ“ èšç±»ä¸­å¿ƒåæ ‡:")
for i, center in enumerate(centers):
    print(f"ç°‡ {i+1}: ({center[0]:.2f}, {center[1]:.2f})")

# ç”Ÿæˆé™ç»´æ•°æ®ç¤ºä¾‹
print("ğŸ”„ ç”Ÿæˆé«˜ç»´æ•°æ®è¿›è¡Œé™ç»´...")
X_high_dim = np.random.randn(200, 50)  # 50ç»´æ•°æ®

# PCAé™ç»´
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X_high_dim)

explained_variance = pca.explained_variance_ratio_
print(f"ğŸ“‰ PCAè§£é‡Šæ–¹å·®æ¯”:")
print(f"  ç¬¬ä¸€ä¸»æˆåˆ†: {explained_variance[0]:.3f}")
print(f"  ç¬¬äºŒä¸»æˆåˆ†: {explained_variance[1]:.3f}")
print(f"  æ€»è§£é‡Šæ–¹å·®: {sum(explained_variance):.3f}")

# æ¨¡æ‹Ÿç»˜å›¾è¾“å‡ºï¼ˆå®é™…ç¯å¢ƒä¸­ä¼šæ˜¾ç¤ºå›¾è¡¨ï¼‰
print("ğŸ“ˆ å¯è§†åŒ–ç»“æœ:");
print("  - æ•£ç‚¹å›¾: åŸå§‹æ•°æ®åˆ†å¸ƒ");
print("  - é¢œè‰²ç¼–ç : K-meansèšç±»ç»“æœ");
print("  - æ ‡è®°ç‚¹: èšç±»ä¸­å¿ƒä½ç½®");
print("  - é™ç»´å›¾: PCAé™ç»´å¯è§†åŒ–");

# æ•°æ®åˆ†ææ€»ç»“
print(f"ğŸ“Š æ•°æ®åˆ†ææ€»ç»“:")
print(f"  - åŸå§‹æ•°æ®: {X_blobs.shape[0]} ä¸ªæ ·æœ¬")
print(f"  - è¯†åˆ«ç°‡æ•°: {len(centers)} ä¸ª")
print(f"  - èšç±»è´¨é‡: {'ä¼˜ç§€' if silhouette_avg > 0.5 else 'è‰¯å¥½' if silhouette_avg > 0.25 else 'ä¸€èˆ¬'}")
print(f"  - é™ç»´æ•ˆæœ: ä¿ç•™ {sum(explained_variance):.1%} çš„ä¿¡æ¯")

print("ğŸ‰ æ•°æ®å¯è§†åŒ–åˆ†æå®Œæˆï¼")`;
                    break;
                    
                case 'deep_learning':
                    exampleCode = `# æ·±åº¦å­¦ä¹ æ¨¡æ‹Ÿå®è·µ
import numpy as np
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score, classification_report

print("ğŸ§  æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œå®è·µ")

# ç”Ÿæˆå¤æ‚åˆ†ç±»æ•°æ®
print("ğŸ“Š ç”Ÿæˆå¤æ‚æ•°æ®é›†...")
X, y = make_classification(
    n_samples=3000,
    n_features=100,  # é«˜ç»´ç‰¹å¾
    n_informative=80,
    n_redundant=20,
    n_classes=5,  # 5åˆ†ç±»é—®é¢˜
    random_state=42
)

class_names = [f'ç±»åˆ«{i+1}' for i in range(5)]
print(f"æ•°æ®é›†: {X.shape[0]} æ ·æœ¬, {X.shape[1]} ç‰¹å¾, {len(class_names)} ç±»åˆ«")

# æ•°æ®é¢„å¤„ç†
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

print(f"è®­ç»ƒé›†: {X_train.shape[0]} ä¸ªæ ·æœ¬")
print(f"æµ‹è¯•é›†: {X_test.shape[0]} ä¸ªæ ·æœ¬")

# æ„å»ºå¤šå±‚æ„ŸçŸ¥æœº (MLP) ç¥ç»ç½‘ç»œ
print("ğŸ—ï¸ æ„å»ºç¥ç»ç½‘ç»œ...")
mlp = MLPClassifier(
    hidden_layer_sizes=(128, 64, 32),  # ä¸‰ä¸ªéšè—å±‚
    activation='relu',
    solver='adam',
    alpha=0.001,  # æ­£åˆ™åŒ–å‚æ•°
    batch_size=32,
    learning_rate='adaptive',
    max_iter=200,
    random_state=42,
    verbose=True
)

print("ç½‘ç»œç»“æ„:");
print("  è¾“å…¥å±‚: 100 ä¸ªç¥ç»å…ƒ");
print("  éšè—å±‚1: 128 ä¸ªç¥ç»å…ƒ (ReLU)");
print("  éšè—å±‚2: 64 ä¸ªç¥ç»å…ƒ (ReLU)");
print("  éšè—å±‚3: 32 ä¸ªç¥ç»å…ƒ (ReLU)");
print("  è¾“å‡ºå±‚: 5 ä¸ªç¥ç»å…ƒ (Softmax)");

# è®­ç»ƒç¥ç»ç½‘ç»œ
print("ğŸš€ å¼€å§‹è®­ç»ƒç¥ç»ç½‘ç»œ...")
mlp.fit(X_train_scaled, y_train)

print(f"âœ… è®­ç»ƒå®Œæˆï¼")
print(f"ğŸ“ˆ è®­ç»ƒè½®æ•°: {mlp.n_iter_}")
print(f"ğŸ“‰ æœ€ç»ˆæŸå¤±: {mlp.loss_:.6f}")

# æ¨¡å‹è¯„ä¼°
print("ğŸ” æ¨¡å‹è¯„ä¼°...")
y_pred = mlp.predict(X_test_scaled)
accuracy = accuracy_score(y_test, y_pred);

print(f"ğŸ¯ æµ‹è¯•å‡†ç¡®ç‡: {accuracy:.3f}")
print(f"ğŸ¯ è®­ç»ƒå‡†ç¡®ç‡: {mlp.score(X_train_scaled, y_train):.3f}")

# é¢„æµ‹æ¦‚ç‡
print("ğŸ§ª é¢„æµ‹ç¤ºä¾‹ (å‰5ä¸ªæ ·æœ¬):")
print("ğŸ§ª å‰5ä¸ªæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡:")
for i in range(5):
    probs = best_model.predict_proba([X_test[i]])[0]
    pred_class = probs.argmax()
    confidence = probs.max()
    print(f"æ ·æœ¬ {i+1}: {class_names[pred_class]} (ç½®ä¿¡åº¦: {confidence*100:.2f}%)")

# ç½‘ç»œå‚æ•°ç»Ÿè®¡
total_params = sum([layer.size for layer in best_model.coefs_]) + sum([layer.size for layer in best_model.intercepts_])
print(f"ğŸ“Š ç½‘ç»œç»Ÿè®¡:")
print(f"  æ€»å‚æ•°æ•°é‡: {total_params:,}")
print(f"  ç½‘ç»œå±‚æ•°: {len(best_model.coefs_)}")
print(f"  æ¿€æ´»å‡½æ•°: {best_model.activation}")
print(f"  ä¼˜åŒ–ç®—æ³•: {best_model.solver}")

print("ğŸ‰ æ·±åº¦å­¦ä¹ å®è·µå®Œæˆï¼")`;
                    break;
                    
                default:
                    exampleCode = '# è¯·é€‰æ‹©ä¸€ä¸ªç¤ºä¾‹\nprint("Hello, AI!")';
            }
            
            codeEditor.setValue(exampleCode);
            updateStepLog(`å·²åŠ è½½${type}ç¤ºä¾‹ä»£ç `);
        }

        // å®‰è£…PythonåŒ…
        async function installPackages() {
            if (!pyodideReady) {
                alert('Pythonç¯å¢ƒæœªå‡†å¤‡å°±ç»ª');
                return;
            }
            
            try {
                updateExecutionStatus('å®‰è£…åŒ…ä¸­...', 'running');
                updateStepLog('æ­£åœ¨å®‰è£…é¢å¤–çš„PythonåŒ…...');
                
                // å¯ä»¥æ ¹æ®éœ€è¦å®‰è£…å…¶ä»–åŒ…
                await pyodide.loadPackage(['pandas', 'seaborn']);
                
                updateExecutionStatus('å®‰è£…å®Œæˆ', 'success');
                updateStepLog('âœ… å·²å®‰è£… pandas, seaborn');
                alert('åŒ…å®‰è£…å®Œæˆï¼ç°åœ¨å¯ä»¥ä½¿ç”¨æ›´å¤šæ•°æ®ç§‘å­¦åº“äº†ã€‚');
                
            } catch (error) {
                updateExecutionStatus('å®‰è£…å¤±è´¥', 'error');
                updateStepLog('âŒ åŒ…å®‰è£…å¤±è´¥: ' + error.message);
                alert('åŒ…å®‰è£…å¤±è´¥: ' + error.message);
            }
        }

        // æ›´æ–°æ‰§è¡ŒçŠ¶æ€
        function updateExecutionStatus(message, type) {
            const statusElement = document.getElementById('execution-status');
            statusElement.textContent = 'â— ' + message;
            statusElement.className = 'execution-status status-' + type;
            document.getElementById('current-step').textContent = message;
        }

        // æ›´æ–°ä»£ç æ‰§è¡Œè¿›åº¦
        function updateCodeProgress(percent, step) {
            const progressBar = document.getElementById('code-progress-bar');
            progressBar.style.width = percent + '%';
            
            if (step) {
                updateStepLog(step);
            }
        }

        // æ›´æ–°æ­¥éª¤æ—¥å¿—
        function updateStepLog(message) {
            const logElement = document.getElementById('step-log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // è°ƒè¯•å‡½æ•°ï¼šæ£€æŸ¥ä»£ç ç”Ÿæˆå™¨çŠ¶æ€
        function debugGeneratorStatus() {
            console.log('=== ä»£ç ç”Ÿæˆå™¨çŠ¶æ€è°ƒè¯• ===');
            console.log('Blockly.JavaScript æ˜¯å¦å­˜åœ¨:', !!Blockly.JavaScript);
            
            if (Blockly.JavaScript) {
                const requiredGenerators = ['ai_load_data', 'ai_create_model', 'ai_train_model', 'ai_predict', 'ai_show_result'];
                requiredGenerators.forEach(name => {
                    const exists = !!Blockly.JavaScript[name];
                    const type = typeof Blockly.JavaScript[name];
                    console.log(`${name}: å­˜åœ¨=${exists}, ç±»å‹=${type}`);
                });
                
                // æ£€æŸ¥å…¶ä»–å¯èƒ½å­˜åœ¨çš„ç”Ÿæˆå™¨
                const allGenerators = Object.keys(Blockly.JavaScript).filter(key => 
                    typeof Blockly.JavaScript[key] === 'function' && key.startsWith('ai_')
                );
                console.log('æ‰€æœ‰AIç›¸å…³ç”Ÿæˆå™¨:', allGenerators);
            }
            
            console.log('å·¥ä½œåŒºçŠ¶æ€:', !!workspace);
            console.log('å—åˆå§‹åŒ–çŠ¶æ€:', blocksInitialized);
            console.log('=========================');
        }
    </script>
</body>
</html>
